@page
@model ForgotPasswordModel
@using TAN.DomainModels.Helpers;
@inject Microsoft.Extensions.Options.IOptions<TANWeb.Models.ReCaptcha> _reCaptcha;
@{
    ViewData["Title"] = "Forgot your password?";
}
@{
    var buildVersion = BuildVersion.version;
    var description = EnumHelper.GetEnumDescription(buildVersion);
}
<div class="row auth-wrapper gx-0">
    <div class="col-lg-6 col-xl-6 bg-info auth-box-2 on-sidebar leftbar-info">
        <div class="h-100 d-flex align-items-center justify-content-center">
            <div class="row justify-content-center text-center">

                <div class="col-md-5 col-lg-10 col-xl-9 px-lg-0 mt-3">
                    <div class="left-image m-auto img-left-screens">
                        <img src="../../assets/images/forgot-the-pass.png" class="p-2" alt="logo" />
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-6 col-xl-6 d-flex align-items-center justify-content-center">
        <div class="row justify-content-center w-100 mt-4 mt-lg-0">
            <div class="col-lg-8 col-xl-8 col-md-8">
                <div class="card" id="loginform">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="d-flex justify-content-center align-items-end logo-wrapper m-auto mb-5">
                                    <img src="../../assets/images/logo1.png" alt="logo" />
                                </div>
                            </div>
                        </div>
                        <div class="logo text-center">
                            <h4>Forgot Password</h4>
                            <p class="text-muted">
                                Enter your email and we’ll send you a recovery email.
                            </p>
                        </div>
                        <div class="pt-2">
                            <!-- Form -->
                            <form method="post">
                                <div asp-validation-summary="ModelOnly" class="text-danger" role="alert"></div>
                                <input type="hidden" id="GoogleCaptcha" asp-for="Input.Token" value="" />
                                <span asp-validation-for="Input.Email" class="text-danger"></span>
                                <div class="form-floating mb-3">
                                    <input asp-for="Input.Email" class="form-control form-input-bg inputFocus rounded-0" autocomplete="username" aria-required="true" placeholder="name@example.com" />
                                    <label asp-for="Input.Email"></label>
                                    <span class="focus-border"><i></i> </span>
                                </div>
                                <div class="form-group mb-3">
                                    <div id="reCapthaDivId" class="g-recaptcha"></div>
                                </div>
                                <div class="d-flex align-items-stretch button-group">
                                    <button type="submit" class="w-100 btn waves-effect waves-light btn-info">Send Recovery Email</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

            </div>
            <div class="text-center mb-3">@description</div>
        </div>
    </div>
</div>
@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    @*<script src="https://www.google.com/recaptcha/api.js?render=@_reCaptcha.Value.SiteKey"></script>*@
    <script type="text/javascript" src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit"
            async defer></script>
    <script>
        //grecaptcha.ready(function () {
        //    grecaptcha.execute('@_reCaptcha.Value.SiteKey', { action: 'submit' }).then(function (token) {
        //        $('#GoogleCaptcha').val(token);
        //    });
        //});

        var onloadCallback = function () {
            grecaptcha.render('reCapthaDivId', {
                'sitekey': '@_reCaptcha.Value.SiteKey',
                'callback': function (response) {
                    $('#GoogleCaptcha').val(response);
                }
            });
        };
    </script>
}
