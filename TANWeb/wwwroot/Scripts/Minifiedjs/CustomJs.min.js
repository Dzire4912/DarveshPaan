function clearAgencyData(){$("#agencyId").val("");$("#agencyName").val("");$("#agencyAddress1").val("");$("#agencyAddress2").val("");$("#agencyCity").val("");$("#agencyState").val(null).trigger("change");$("#agencyZipCode").val("");$("#agencyFacilityName").val(null).trigger("change");$(".errormsg").text("");$("#AgencyModalLabel").text("Add Agency");$("#btnSaveAgency").show();$("#btnUpdateAgency").hide();$("#agencyId").prop("disabled",!1);$("#agencyFacilityName").prop("disabled",!1)}function saveAgency(){let n=$('input[name="__RequestVerificationToken"]').val(),t={AgencyId:$("#agencyId").val(),AgencyName:$("#agencyName").val(),Address1:$("#agencyAddress1").val(),Address2:$("#agencyAddress2").val(),City:$("#agencyCity").val(),State:$("#agencyState").val(),ZipCode:$("#agencyZipCode").val(),FacilityId:$("#agencyFacilityName").val()};showLoader();$.ajax({url:urls.AgencyManagement.AddAgency,type:"POST",headers:{RequestVerificationToken:n},data:t,"async":!1,success:function(n){hideLoader();n=="success"?(SuccessMsg("Success","Record Added successfully","success"),$("#AgencyModal").modal("hide")):n=="failed"&&($("#AgencyModal").modal("hide"),ErrorMsg("Error","Failed to Add New Agency",""));let t=$("#agencyTable").DataTable();t.destroy();loadAgenciesData();clearAgencyData()},failure:function(n){hideLoader();ErrorMsg("Error",n,"")},error:function(n,t,i){if(hideLoader(),t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)ErrorMsg("Failed","Unauthorized Access");else if(n.status==HTTP_STATUS_TOOMANYREQUESTS||t==HTTP_STATUS_TOOMANYREQUESTS){ErrorMsg("Failed","Too Many Requests, Please try after some time");$("#AgencyModal").modal("hide");let n=$("#agencyTable").DataTable();n.destroy();loadAgenciesData();clearAgencyData()}else ErrorMsg("Failed",i,"error")}})}function validateAgencyForm(){return!($("#agencyId").val()==""||$("#agencyName").val()==""||$("#agencyAddress1").val()==""||$("#agencyCity").val()==""||$("#agencyState").val()==""||$("#agencyZipCode").val()==""||$("#agencyFacilityName").val()==""||$(".errormsg").text()!="")}function loadAgenciesData(){let n=$("#agencyfacilityNameFilter").val();n=="Select Facility Name"&&(n=null);let t=$("#agencyIdFilter").val();t=="Select Agency Id"&&(t=null);let u=getLoggedInUserInfo(),r="";u||(r=getOrganizationUserDetails());let i={facilityName:n,agencyId:t,organizationId:r};$("#agencyTable").DataTable({ajax:{url:urls.AgencyManagement.GetAllAgenciesList,type:"POST",data:function(n){n.searchValue=$("#agencyTable_filter input").val();n.start=n.start||0;n.length=n.length||10;n.draw=n.draw||1;n.sortColumn=n.columns[n.order[0].column].data;n.sortDirection=n.order[0].dir;n.facilityName=i.facilityName;n.agencyId=i.agencyId;n.organizationId=i.organizationId},error:function(n,t){(t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)&&ErrorMsg("Failed","Unauthorized Access")}},processing:!0,serverSide:!0,filter:!0,pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}},columns:[{data:"agencyId",name:"Agency Id"},{data:"agencyName",name:"Agency Name"},{data:"facilityName",name:"Facility Name"},{data:"state",name:"State"},{data:null,orderable:!1,render:function(n,t,i){return"<a href='#' onclick=editAgency('"+i.agencyId+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Edit'><i class='ri-edit-2-line fs-6 pe-2 text-info'><\/i><\/a> <a href='#' onclick=deleteAgency('"+i.id+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Delete'><i class='ri-delete-bin-line fs-6 text-danger'><\/i><\/a>"}}]})}function clearFilter(){$("#agencyfacilityNameFilter").val(null).trigger("change");$("#agencyIdFilter").val(null).trigger("change")}function editAgency(n){clearAgencyData();showLoader();$.ajax({url:urls.AgencyManagement.EditAgency,type:"GET",data:{agencyId:n},success:function(n){hideLoader();$("#AgencyModal").modal("show");draggableModel("#AgencyModal");$("#Id").val(n.id);$("#agencyId").val(n.agencyId);$("#agencyName").val(n.agencyName);$("#agencyAddress1").val(n.address1);$("#agencyAddress2").val(n.address2);$("#agencyCity").val(n.city);$("#agencyState").val(n.state).trigger("change");$("#agencyZipCode").val(n.zipCode);$("#agencyFacilityName").val(n.facilityId).trigger("change");$("#AgencyModalLabel").text("Update Agency");$("#btnSaveAgency").hide();$("#btnUpdateAgency").show();$("#agencyId").prop("disabled",!0)},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}})}function updateAgency(){let n=$('input[name="__RequestVerificationToken"]').val(),t={Id:$("#Id").val(),AgencyId:$("#agencyId").val(),AgencyName:$("#agencyName").val(),Address1:$("#agencyAddress1").val(),Address2:$("#agencyAddress2").val(),City:$("#agencyCity").val(),State:$("#agencyState").val(),ZipCode:$("#agencyZipCode").val(),OrganizationId:$("#agencyOrganizationName").val(),FacilityId:$("#agencyFacilityName").val()};showLoader();$.ajax({url:urls.AgencyManagement.UpdateAgency,type:"POST",headers:{RequestVerificationToken:n},data:t,"async":!1,success:function(n){hideLoader();n=="success"?(SuccessMsg("Success","Record Updated successfully","success"),$("#AgencyModal").modal("hide")):($("#AgencyModal").modal("hide"),ErrorMsg("Failed",error,"error"));let t=$("#agencyTable").DataTable();t.destroy();loadAgenciesData();clearAgencyData()},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}})}function deleteAgency(n){let t=$('input[name="__RequestVerificationToken"]').val();ConfirmMsg("Agency Management","Are you sure want to delete this agency?","Continue",event,function(){$.ajax({url:urls.AgencyManagement.DeleteAgency,type:"POST",headers:{RequestVerificationToken:t},data:{agencyId:n},success:function(n){n=="success"?SuccessMsg("Success","Record Deleted successfully","success"):ErrorMsg("Failed",error,"error");let t=$("#agencyTable").DataTable();t.destroy();loadAgenciesData()},error:function(n,t,i){t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}})})}function initSelect2ForAgency(){$("#agencyState").select2({placeholder:"Select State Name",dropdownParent:$("#selectDivState"),width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#agencyFacilityName").select2({placeholder:"Select Facility Name",dropdownParent:$("#facilityIdSelectDiv"),multiple:!0,width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#agencyfacilityNameFilter").select2({placeholder:"Select Facility Name",width:"100%"}).on("select2:close",function(){$(this).val()==null&&($(this).val("").trigger("change"),$(this).next(".select2-container").find(".select2-search__field").attr("placeholder","Select options"))});$("#agencyIdFilter").select2({placeholder:"Select Agency Id",width:"100%"}).on("select2:close",function(){$(this).val()==null&&($(this).val("").trigger("change"),$(this).next(".select2-container").find(".select2-search__field").attr("placeholder","Select options"))})}function allowOnlyDigits(n){let t=n.key;/^\d$/.test(t)||t==="Backspace"||t==="Tab"||n.preventDefault()}function isAlphaNumericOnly(n){let t=n.which?n.which:n.keyCode;return!!(t>47&&t<58||t>64&&t<91||t>96&&t<123)}function isAlphaNumeric(n){let t=n.which?n.which:n.keyCode;return!!(t>47&&t<58||t>64&&t<91||t>96&&t<123||t===32)}function validateInputOnBlur(n){let u=n.value,t=$("#btnSaveAgency"),i=$("#btnUpdateAgency"),r=document.getElementById("agencyName"),f=/[a-zA-Z]/.test(u);f?$("#AgencyName_Error").text()!=""?(r.focus(),t.prop("disabled",!0),i.prop("disabled",!0)):($("#AgencyName_Error").text(""),t.prop("disabled",!1),i.prop("disabled",!1)):($("#AgencyName_Error").text("Input is invalid. It should contain at least one character"),r.focus(),t.prop("disabled",!0),i.prop("disabled",!0));checkForUniqueAgencyName()}function restrictInput(n){let t=n.key;/^[A-Za-z\-,''\s]+$/.test(t)||t==="Backspace"||n.preventDefault()}function restrictSpecialChars(n){let t=n.key;/^[a-zA-Z0-9\s\-,'.']+$/.test(t)||t==="Backspace"||n.preventDefault()}function handleClick(n){let t=document.getElementById("accordionFlushExample"),i=document.getElementById("flush-collapseOne"),r=n.target;t.contains(r)||i.classList.remove("show")}function checkForUniqueAgencyName(){let r=$("#agencyName").val(),u=$("#agencyId").val(),n=$("#btnSaveAgency"),t=$("#btnUpdateAgency"),i=document.getElementById("agencyName");$.ajax({url:urls.AgencyManagement.CheckForAgencyName,type:"GET",data:{agencyName:r,agencyId:u},success:function(r){r?($("#AgencyName_Error").text("Agency Name already exists, please use another Name"),i.focus(),n.prop("disabled",!0),t.prop("disabled",!0)):$("#AgencyName_Error").text()!=""?(i.focus(),n.prop("disabled",!0),t.prop("disabled",!0)):($("#AgencyName_Error").text(""),n.prop("disabled",!1),t.prop("disabled",!1))},error:function(n,t,i){console.log("Error: "+i)}})}function checkForUniqueAgencyId(){let i=$("#agencyId").val(),n=$("#btnSaveAgency"),t=$("#btnUpdateAgency"),r=document.getElementById("agencyId");$.ajax({url:urls.AgencyManagement.CheckForAgencyId,type:"GET",data:{agencyId:i},success:function(u){u?($("#agencyId_Error").text("Agency Id "+i+" already exists, please use another Id"),r.focus(),n.prop("disabled",!0),t.prop("disabled",!0)):$("#agencyId_Error").text()!=""?(r.focus(),n.prop("disabled",!0),t.prop("disabled",!0)):($("#agencyId_Error").text(""),n.prop("disabled",!1),t.prop("disabled",!1))},error:function(n,t,i){console.log("Error: "+i)}})}function getAgencies(){let n=$("#agencyfacilityNameFilter").val();n=="Select Facility Name"&&(n=null);showLoader();$("#agencyfacilityNameFilter").val()!=""&&$.ajax({type:"Get",data:{facilityName:n},"async":!1,cache:!1,url:urls.AgencyManagement.GetAgencyIdListByFacilityName,success:function(n){hideLoader();let t=$("#agencyIdFilter");t.empty();t.append('<option value="">- Select Agency Id -<\/option>');$.each(n,function(n,i){t.append('<option value="'+i.text+'">'+i.text+"<\/option>")});t.trigger("change")},failure:function(){hideLoader();ErrorMsg("Error","Something went wrong!Try again Later","")},error:function(){hideLoader();ErrorMsg("Error","Something went wrong!Try again Later","")}})}function getLoggedInUserInfo(){let n=!1;return showLoader(),$.ajax({url:urls.AgencyManagement.GetLoggedInUserInfo,type:"GET","async":!1,success:function(t){hideLoader();t!=null&&(n=t)},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}}),n}function getOrganizationUserDetails(){let n=null;return showLoader(),$.ajax({url:urls.AgencyManagement.GetOrganizationUserInfo,type:"GET","async":!1,success:function(t){hideLoader();t!=null&&(n=t)},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}}),n}function getYear(){let n=2020,r=new Date,i=r.getFullYear();$("#YearList").html();let t="";for(t+="<option value='0'>Select<\/option>";n<=i;)t+=i==n?"<option value='"+n+"' selected>"+n+"<\/option>":"<option value='"+n+"'>"+n+"<\/option>",n=n+1;$("#YearList").html(t)}function getQuaterList(){$("#QuarterList").html();let t=new Date,i=t.getMonth(),r=findQuarter(i+1),n="<option value='-1'>Select<\/option>";ListQuarters.forEach(function(t){n+=t.key==r?"<option value='"+t.key+"' selected>"+t.value+"<\/option>":"<option value='"+t.key+"'>"+t.value+"<\/option>"});$("#QuarterList").html(n)}function findQuarter(n){let t=0;switch(n){case 1:case 2:case 3:t=2;break;case 4:case 5:case 6:t=3;break;case 7:case 8:case 9:t=4;break;case 10:case 11:case 12:t=1}return t}function loadBackoutData(){let n=$("#FacilityId").val(),t={FacilityID:n,Year:$("#YearList").val(),ReportQuarter:$("#QuarterList").val(),Status:$("#StatusListId").val()},i=$("#BackoutListTable").DataTable();i.destroy();$("#BackoutListTable").DataTable({ajax:{url:urls.Backout.GetUploadFileDetails,type:"POST",data:t,error:function(n,t){(t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)&&ErrorMsg("Failed","Unauthorized Access")}},processing:!0,serverSide:!0,filter:!0,scrollY:"300px",scrollCollapse:!0,pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}},columns:[{data:"fileName",name:"File Name"},{data:"validRecord",name:"File Name"},{data:null,orderable:!1,render:function(n,t,i){return i.invalidRecord!=0?"<a href='#' onclick=deleteInvalidRecord('"+i.fileDetailsId+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Delete'>"+i.invalidRecord+"<\/a>":i.invalidRecord}},{data:"rowCount",name:"Total Count"},{data:"createDate",name:"Create Date"},{data:null,orderable:!1,render:function(n,t,i){return"<a href='#' onclick=deleteFile('"+i.fileDetailsId+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Delete'><i class='ri-delete-bin-line fs-6 text-danger'><\/i><\/a><a href='#' onclick=openErrorDetailListModal('"+i.fileDetailsId+"','"+i.facilityID+"','"+i.year+"','"+i.reportQuarter+"')  data-bs-toggle='tooltip'  data-bs-placement='top' title='View Valid / Invalid Records'><i class='ri-eye-line fs-6 text-success ms-2'><\/i><\/a>"}}]})}function deleteFile(n){ConfirmMsg("Backout","Are you sure want to Delete all the data?","Delete",event,function(){let t={FacilityId:$("#FacilityId").val(),FileDetailsId:n};showLoader();$.ajax({url:urls.Backout.BackOutAllData,type:"POST",data:t,success:function(n){n.status==!0?(SuccessMsg("Success",n.message,"success"),loadBackoutData(),hideLoader()):(hideLoader(),ErrorMsg("Failed",n.message))},error:function(n,t){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed","Failed to Delete")}})})}function getUploadFileDetails(){loadBackoutData()}function openErrorDetailListModal(n,t,i,r){let u={FacilityId:t,FileDetailsId:n};sessionStorage.setItem("FacilityId",u.FacilityId);sessionStorage.setItem("FileDetailsId",u.FileDetailsId);sessionStorage.setItem("Year",i);sessionStorage.setItem("ReportQuarter",r);let e=getFacilityName(t);$("#facilityLbl").text(e);$("#yearLbl").text(i);$("#quarterLbl").text(ListQuarters[r-1].value);let o=getFileName(u.FacilityId,i,r,n);$("#quarterLbl").text(ListQuarters[r-1].value);$("#fileNameLbl").text(o);let s=$("#BackoutErrorDetailListTable").DataTable(),f=!0;s.destroy();$("#BackoutErrorDetailListTable").DataTable({ajax:{url:urls.Backout.GetFileErrorData,type:"POST",data:u,error:function(n,t){(t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)&&(f=!1,ErrorMsg("Failed","Unauthorized Access"))}},processing:!0,serverSide:!0,filter:!1,pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}},columns:[{data:"errorMessage",name:"ErrorMessage"},{data:null,name:"Employee Id",width:"10px",render:function(n,t,i){return"<span onclick='getErrorData(this,"+i.id+")'; style='cursor: pointer;' data-bs-toggle='offcanvas' data-bs-target='#offcanvasRight'>"+i.finalFileRowData.employeeId+"<\/span>"}},{data:null,name:"Pay Type Code",render:function(n,t,i){return"<span  onclick='getErrorData(this,"+i.id+")'; style='cursor: pointer;' data-bs-toggle='offcanvas' data-bs-target='#offcanvasRight'>"+i.finalFileRowData.payTypeCode+"<\/span>"}},{data:null,name:"Work Day",render:function(n,t,i){return"<span  onclick='getErrorData(this,"+i.id+")'; style='cursor: pointer;' data-bs-toggle='offcanvas' data-bs-target='#offcanvasRight'>"+i.finalFileRowData.workDay+"<\/span>"}},{data:null,name:"Hours",render:function(n,t,i){return"<span  onclick='getErrorData(this,"+i.id+")'; style='cursor: pointer;' data-bs-toggle='offcanvas' data-bs-target='#offcanvasRight'>"+i.finalFileRowData.hours+"<\/span>"}},{data:null,name:"Job Title Code",render:function(n,t,i){return"<span  onclick='getErrorData(this,"+i.id+")'; style='cursor: pointer;' data-bs-toggle='offcanvas' data-bs-target='#offcanvasRight'>"+i.finalFileRowData.jobTitleCode+"<\/span>"}},{data:null,name:"Employee First Name",render:function(n,t,i){return"<span onclick='getErrorData(this, "+i.id+")' style='cursor: pointer;' data-bs-toggle='offcanvas' data-bs-target='#offcanvasRight'>"+i.finalFileRowData.employeeFirstName+"<\/span>"}}]});$("#ButtonDivHide").css("display","none");$("#RightErrorTab").html("");f&&$("#ErrorListModalId").modal("show");loadInValidDynamicData()}function getErrorData(n,t){$("#BackoutErrorDetailListTable tbody tr").removeClass("highlighted-row");let i=n.closest("tr");i&&i.classList.add("highlighted-row");let r={Id:t};showLoader();$.ajax({url:urls.Backout.GetErrorRowData,type:"POST",data:r,success:function(n){if(hideLoader(),n.keyValueList.length>0){let t="";t+="<input type='hidden' id='_errorId' value='"+n.id+"' />";t+="<input type='hidden' id='_facilityId' value='"+n.facilityId+"' />";t+="<input type='hidden' id='_fileDetailId' value='"+n.fileDetailId+"' />";t+="<input type='hidden' id='_reportQuarter' value='"+n.reportQuarter+"' />";t+="<input type='hidden' id='_year' value='"+n.year+"' />";t+="<input type='hidden' id='_month' value='"+n.month+"' />";t+="<input type='hidden' id='_uploadType' value='"+n.uploadType+"' />";n.keyValueList.forEach(function(n){if(t+='<div class="col-sm-12 keyValue">',t+='<span id="_key">'+n.key+"<\/span>",n.key.toLowerCase().includes("workday")){const i=n.value.split("/");if(console.log(i),i.length===3){const n=i[2],r=i[0].padStart(2,"0"),u=i[1].padStart(2,"0"),f=n+"-"+r+"-"+u;t+="<span><input id='_value' class='form-control' type='date' value='"+f+"' /><\/span>"}}else t+="<span><input id='_value' class='form-control' type='text' value='"+n.value+"' /><\/span>";t+="<\/div>"});$("#RightErrorTab").html("");$("#RightErrorTab").html(t);$("#CanvasData").html("");$("#CanvasData").html(t);$("#ButtonDivHide").css("display","block")}else $("#RightErrorTab").html(""),$("#RightErrorTab").html("<span>No record found<\/span>"),$("#CanvasData").html(""),$("#CanvasData").html("<span>No record found<\/span>")},error:function(){$("#ButtonDivHide").css("display","none");ErrorMsg("Failed","Failed to Delete")}})}function updateErrorRowData(){let n=[];$(".keyValue").each(function(){let t={Key:$(this).find("#_key").text(),Value:$(this).find("#_value").val()};n.push(t)});let t={Id:$("#_errorId").val(),FileDetailId:$("#_fileDetailId").val(),FacilityId:$("#_facilityId").val(),ReportQuarter:$("#_reportQuarter").val(),Year:$("#_year").val(),Month:$("#_month").val(),UploadType:$("#_uploadType").val(),keyValueList:n};showLoader();$.ajax({url:urls.Backout.UpdateErrorRowData,type:"POST",data:t,success:function(n){if(n.success){hideLoader();SuccessMsg("Success",n.errorMessage,"success");let t=document.querySelector("[data-bs-dismiss='offcanvas']");t.click();loadInValidDynamicData(1)}else hideLoader(),ErrorMsg("Failed",n.errorMessage)},error:function(){hideLoader();ErrorMsg("Failed","Failed to Delete")}})}function DeleteErrorRowData(){let n=sessionStorage.getItem("FacilityId");ConfirmMsg("Delete","Are you sure want to Delete the record?","Delete",event,function(){if($("#_errorId").val()==undefined||$("#_errorId").val()=="")return ErrorMsg(" Alert","Please choose the record from the table and try again!"),!1;let t={Id:$("#_errorId").val()};showLoader();$.ajax({url:urls.Backout.DeleteErrorRowData,type:"POST",data:t,success:function(t){hideLoader();$("#ButtonDivHide").css("display","none");t.statusCode==200?(openErrorDetailListModal($("#_fileDetailId").val(),n,$("#yearLbl").text(),$("#QuarterList").val()),SuccessMsg("Success",t.message,"success")):ErrorMsg("Failed",t.message)},error:function(){hideLoader();$("#ButtonDivHide").css("display","none");ErrorMsg("Failed","Failed to Delete")}})})}function deleteInvalidRecord(n){ConfirmMsg("Delete","Are you sure want to delete all invalid record?","Delete",event,function(){let t={FileDetailId:n};showLoader();$.ajax({url:urls.Backout.DeleteInvalidRecord,type:"POST",data:t,success:function(n){n.statusCode==200?(SuccessMsg("Success",n.message,"success"),loadBackoutData(),hideLoader()):(hideLoader(),ErrorMsg("Failed",n.message))},error:function(n,t){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed","Failed to Delete")}})})}function loadValidData(){$("#tab1-tab").addClass("active");$("#tab3-tab").removeClass("active");$("#tab1").addClass("show active");$("#tab3").removeClass("show active");let n=sessionStorage.getItem("FacilityId"),t=sessionStorage.getItem("FileDetailsId"),i={FacilityId:n,FileDetailsId:t},r=$("#BackoutErrorDetailListValidRecordTable").DataTable(),u=!0;r.destroy();$("#BackoutErrorDetailListValidRecordTable").DataTable({ajax:{url:urls.Backout.GetFileValidData,type:"POST",data:i,error:function(n,t){(t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)&&(u=!1,ErrorMsg("Failed","Unauthorized Access"))}},processing:!0,serverSide:!0,filter:!1,pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}},columns:[{data:"employeeId",name:"EmployeeId"},{data:"firstName",name:"FirstName"},{data:"lastName",name:"LastName"},{data:"payTypeCode",name:"Pay Type Code"},{data:"workday",name:"Work Day"},{data:"tHours",name:"Hours"},{data:"jobTitleCode",name:"Job Title Code"},]})}function loadInValidData(){$("#tab1-tab").removeClass("active");$("#tab2-tab").addClass("active");$("#tab1").removeClass("show active");$("#tab2").addClass("show active")}function downloadInvalidFileData(){let n=sessionStorage.getItem("FacilityId"),i=sessionStorage.getItem("FileDetailsId"),r=sessionStorage.getItem("Year"),u=sessionStorage.getItem("ReportQuarter"),f=new Date,t="InvalidErrorFileDetails_"+n+"_"+moment(f).format("YYYYMMDDHHMMSS"),e={facilityId:n,year:r,reportQuarter:u,fileName:t,fileDetailsId:i};showLoader();$.ajax({url:urls.Backout.ExportInvalidFileErrorDataToCsv,type:"GET",data:e,xhrFields:{responseType:"blob"},success:function(n){hideLoader();let r=window.URL.createObjectURL(n),i=document.createElement("a");i.href=r;i.download=t+".csv";i.click();window.URL.revokeObjectURL(r)},error:function(){hideLoader();ErrorMsg("Error","Failed to export","")}})}function downloadValidFileData(){let n=sessionStorage.getItem("FacilityId"),i=sessionStorage.getItem("FileDetailsId"),r=new Date,t="ValidFileDetails_"+n+"_"+moment(r).format("YYYYMMDDHHMMSS"),u={facilityId:n,fileName:t,fileDetailsId:i};showLoader();$.ajax({url:urls.Backout.ExportValidFileDataToCsv,type:"GET",data:u,xhrFields:{responseType:"blob"},success:function(n){hideLoader();let r=window.URL.createObjectURL(n),i=document.createElement("a");i.href=r;i.download=t+".csv";i.click();window.URL.revokeObjectURL(r)},error:function(){hideLoader();ErrorMsg("Error","Failed to export","")}})}function getFileName(n,t,i,r){let u="",f={FacilityId:n,ReportQuarter:i,Year:t,FileDetailsId:r};return showLoader(),$.ajax({url:urls.Backout.GetFileNameByFacility,type:"GET",data:f,"async":!1,success:function(n){hideLoader();u=n.fileName!=""?n.fileName:""},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}}),u}function clearSessionVariables(){sessionStorage.removeItem("FacilityId");sessionStorage.removeItem("FileDetailsId");sessionStorage.removeItem("Year");sessionStorage.removeItem("ReportQuarter")}function loadInValidDynamicData(n=1){$("#tab1-tab").removeClass("active");$("#tab1").removeClass("show active");$("#tab3-tab").addClass("active");$("#tab3").addClass("show active");let t=sessionStorage.getItem("FileDetailsId");if(t=="0")return!1;let i={FileDetailId:t,PageNo:n,PageSize:$("#PageSizeddl").val()};showLoader();$.ajax({url:urls.Backout.ListValidationErrorByFileId,type:"POST",data:i,dataType:"json",success:function(t){if(t.dynamicDataTableModel.length>0){let u=Object.keys(t.dynamicDataTableModel[0].dynamicDataTable),i='<table id="errorDynamicTable" class="table display table-bordered no-wrap">';i+="<thead><tr>";for(let n=0;n<u.length;n++)u[n]!="ErrorId"&&(i+=u[n]==="Error Message"?'<th style="width: 20px;">'+u[n]+"<\/th>":"<th>"+u[n]+"<\/th>");i+="<th>Action<\/th><\/tr><\/thead><tbody>";for(let n=0;n<t.dynamicDataTableModel.length;n++){i+="<tr>";for(let r=0;r<u.length;r++){let f=u[r];f!="ErrorId"&&(i+=f==="Error Message"?'<td style="width: 20px;">'+t.dynamicDataTableModel[n].dynamicDataTable[f]+"<\/td>":"<td>"+t.dynamicDataTableModel[n].dynamicDataTable[f]+"<\/td>")}i+="<td><a href='#' onclick=deleteValidationErrorRecord('"+t.dynamicDataTableModel[n].dynamicDataTable.ErrorId+"'); title='Delete'><i class='ri-delete-bin-line fs-6 text-danger'><\/i><\/a>";i+=" <a href='#' onclick=openErrorDetailListModalForDynamic(this,'"+t.dynamicDataTableModel[n].dynamicDataTable.ErrorId+"')  title='View' data-bs-toggle='offcanvas' data-bs-target='#offcanvasRight'><i class='ri-eye-line fs-6 text-success ms-2'><\/i><\/a>";i+="<\/td><\/tr>"}i+="<\/tbody><\/table>";let c=t.totalCount,s=$("#PageSizeddl").val(),r=n;i+='<nav aria-label="Page navigation example">';i+='<ul class="pagination">';(r>1||r-1>1)&&(i+='<li class="page-item">',i+='<a class="page-link link" href="#" aria-label="Previous" onclick=validationErrorsList("'+(r-1)+'"); >',i+='<span aria-hidden="true">',i+='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevrons-left feather-sm"><polyline points="11 17 6 12 11 7"><\/polyline><polyline points="18 17 13 12 18 7"><\/polyline><\/svg>',i+="<\/span>",i+="<\/a>",i+="<\/li>");let o=r,f=1,e=3;for(let n=o;n>0&&f<=3;n++)r-e>0&&(i+='<li class="page-item"><a class="page-link" href="#" onclick=validationErrorsList("'+(r-e)+'");>'+(r-e)+"<\/a><\/li>"),f++,e--;o=r;f=1;let h=0;for(let n=o;n>0&&f<=3;n++){let n=parseInt(r)+parseInt(h);r==n?i+='<li class="page-item" ><a class="page-link link" href="#">'+n+"<\/a><\/li>":(parseInt(n)-1)*parseInt(s)<parseInt(t.totalCount)&&(i+='<li class="page-item"><a class="page-link" href="#" onclick=validationErrorsList("'+n+'");>'+n+"<\/a><\/li>");f++;h++}parseInt(s)*parseInt(r)<=parseInt(c)&&(i+='<li class="page-item">',i+='<a class="page-link" href="#" aria-label="Next" onclick=validationErrorsList("'+(r+1)+'");>',i+='<span aria-hidden="true">',i+='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevrons-right feather-sm"><polyline points="13 17 18 12 13 7"><\/polyline><polyline points="6 17 11 12 6 7"><\/polyline><\/svg>',i+="<\/span>",i+="<\/a>",i+="<\/li>");i+="<\/ul>";i+="<\/nav>";$("#dataTableContainer").html("");$("#dataTableContainer").html(i);$("#rowCountId").html("Showing "+t.rowStart+" to "+t.rowCount+" of "+t.totalCount+" entries");$("#pageCountId").html("Page No. :"+r+" of "+calculateTotalPages(t.totalCount,$("#PageSizeddl").val()));$(".disabled-li").css({color:"gray",cursor:"not-allowed"})}else $("#rowCountId").html(""),$("#pageCountId").html(""),$("#dataTableContainer").html("No data available.");hideLoader()},error:function(){hideLoader();$("#rowCountId").html("");$("#pageCountId").html("");$("#dataTableContainer").html("Error fetching data.")}})}function openErrorDetailListModalForDynamic(n,t){$("#errorDynamicTable tbody tr").removeClass("highlighted-row");let i=n.closest("tr");i&&i.classList.add("highlighted-row");let r={Id:t};showLoader();$.ajax({url:urls.Backout.GetErrorRowData,type:"POST",data:r,success:function(n){if(hideLoader(),n.keyValueList.length>0){let t="";t+="<input type='hidden' id='_errorId' value='"+n.id+"' />";t+="<input type='hidden' id='_facilityId' value='"+n.facilityId+"' />";t+="<input type='hidden' id='_fileDetailId' value='"+n.fileDetailId+"' />";t+="<input type='hidden' id='_reportQuarter' value='"+n.reportQuarter+"' />";t+="<input type='hidden' id='_year' value='"+n.year+"' />";t+="<input type='hidden' id='_month' value='"+n.month+"' />";t+="<input type='hidden' id='_uploadType' value='"+n.uploadType+"' />";n.keyValueList.forEach(function(n){if(t+='<div class="col-sm-12 keyValue mt-2">',t+='<span id="_key">'+n.key+"<\/span>",n.key.toLowerCase().includes("workday")||n.key.toLowerCase().includes("work day")||n.key.toLowerCase().includes("clockpunch_in1")||n.key.toLowerCase().includes("clockpunch_out1")){const i=n.value.split("/");if(i.length===3){const n=i[2],r=new Date(n),u=r.getFullYear(),f=i[0].padStart(2,"0"),e=i[1].padStart(2,"0"),o=u+"-"+f+"-"+e;t+="<span><input id='_value' class='form-control' type='date' value='"+o+"' /><\/span>"}}else t+="<span><input id='_value' class='form-control' type='text' value='"+n.value+"' /><\/span>";t+="<\/div>"});$("#CanvasData").html("");$("#CanvasData").html(t);$("#ButtonDivHide").css("display","block")}else SuccessMsg("Success","No record found","success")},error:function(){hideLoader();ErrorMsg("Failed","Failed to fetch the data")}})}function calculateTotalPages(n,t){return Math.ceil(n/t)}function deleteValidationErrorRecord(n){ConfirmMsg("Delete","Are you sure want to Delete the record?","Delete",event,function(){let t={Id:n};showLoader();$.ajax({url:urls.Backout.DeleteErrorRowData,type:"POST",data:t,success:function(n){hideLoader();n.statusCode==200?(SuccessMsg("Success",n.message,"success"),loadInValidDynamicData(1)):ErrorMsg("Failed",n.message)},error:function(){hideLoader();ErrorMsg("Failed","Failed to Delete")}})})}function downloadValidFileDynamicData(){let n=sessionStorage.getItem("FacilityId"),i=sessionStorage.getItem("FileDetailsId"),r=sessionStorage.getItem("Year"),u=sessionStorage.getItem("ReportQuarter"),f=new Date,t="InvalidErrorFileDetails_"+n+"_"+moment(f).format("YYYYMMDDHHMMSS"),e={facilityId:n,year:r,reportQuarter:u,fileName:t,fileDetailsId:i};showLoader();$.ajax({url:urls.Backout.ExportInvalidFileErrorDynamicDataToCsv,type:"GET",data:e,xhrFields:{responseType:"blob"},success:function(n){hideLoader();let r=window.URL.createObjectURL(n),i=document.createElement("a");i.href=r;i.download=t+".csv";i.click();window.URL.revokeObjectURL(r)},error:function(){hideLoader();ErrorMsg("Error","Failed to export","")}})}function validationErrorsList(n=1){let t=sessionStorage.getItem("FileDetailsId"),i={FileDetailId:t,PageNo:n,PageSize:$("#PageSizeddl").val()};showLoader();$.ajax({url:urls.Backout.ListValidationErrorByFileId,type:"POST",data:i,dataType:"json",success:function(t){if(t.dynamicDataTableModel.length>0){let u=Object.keys(t.dynamicDataTableModel[0].dynamicDataTable),i='<table id="errorDynamicTable" class="table display table-bordered no-wrap">';i+="<thead><tr>";for(let n=0;n<u.length;n++)u[n]!="ErrorId"&&(i+="<th>"+u[n]+"<\/th>");i+="<th>Action<\/th><\/tr><\/thead><tbody>";for(let n=0;n<t.dynamicDataTableModel.length;n++){i+="<tr>";for(let r=0;r<u.length;r++){let f=u[r];f!="ErrorId"&&(i+="<td>"+t.dynamicDataTableModel[n].dynamicDataTable[f]+"<\/td>")}i+="<td><a href='#' onclick=deleteValidationErrorRecord('"+t.dynamicDataTableModel[n].dynamicDataTable.ErrorId+"'); title='Delete'><i class='ri-delete-bin-line fs-6 text-danger'><\/i><\/a>";i+=" <a href='#' onclick=openErrorDetailListModalForDynamic(this,'"+t.dynamicDataTableModel[n].dynamicDataTable.ErrorId+"')  title='View' data-bs-toggle='offcanvas' data-bs-target='#offcanvasRight'><i class='ri-eye-line fs-6 text-success ms-2'><\/i><\/a>";i+="<\/td><\/tr>"}i+="<\/tbody><\/table>";let c=t.totalCount,s=$("#PageSizeddl").val(),r=n;i+='<nav aria-label="Page navigation example">';i+='<ul class="pagination">';(r>1||r-1>1)&&(i+='<li class="page-item">',i+='<a class="page-link link" href="#" aria-label="Previous" onclick=validationErrorsList("'+(r-1)+'"); >',i+='<span aria-hidden="true">',i+='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevrons-left feather-sm"><polyline points="11 17 6 12 11 7"><\/polyline><polyline points="18 17 13 12 18 7"><\/polyline><\/svg>',i+="<\/span>",i+="<\/a>",i+="<\/li>");let o=r,f=1,e=3;for(let n=o;n>0&&f<=3;n++)r-e>0&&(i+='<li class="page-item"><a class="page-link" href="#" onclick=validationErrorsList("'+(r-e)+'");>'+(r-e)+"<\/a><\/li>"),f++,e--;o=r;f=1;let h=0;for(let n=o;n>0&&f<=3;n++){let n=parseInt(r)+parseInt(h);r==n?i+='<li class="page-item" ><a class="page-link link" href="#">'+n+"<\/a><\/li>":(parseInt(n)-1)*parseInt(s)<parseInt(t.totalCount)&&(i+='<li class="page-item"><a class="page-link" href="#" onclick=validationErrorsList("'+n+'");>'+n+"<\/a><\/li>");f++;h++}parseInt(s)*parseInt(r)<=parseInt(c)&&(i+='<li class="page-item">',i+='<a class="page-link" href="#" aria-label="Next" onclick=validationErrorsList("'+(r+1)+'");>',i+='<span aria-hidden="true">',i+='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevrons-right feather-sm"><polyline points="13 17 18 12 13 7"><\/polyline><polyline points="6 17 11 12 6 7"><\/polyline><\/svg>',i+="<\/span>",i+="<\/a>",i+="<\/li>");i+="<\/ul>";i+="<\/nav>";$("#dataTableContainer").html("");$("#dataTableContainer").html(i);$("#rowCountId").html("Showing "+t.rowStart+" to "+t.rowCount+" of "+t.totalCount+" entries");$("#pageCountId").html("Page No. :"+r+" of "+calculateTotalPages(t.totalCount,$("#PageSizeddl").val()));$(".disabled-li").css({color:"gray",cursor:"not-allowed"})}else $("#rowCountId").html(""),$("#pageCountId").html(""),$("#dataTableContainer").html("No data available.");hideLoader()},error:function(){hideLoader();$("#rowCountId").html("");$("#pageCountId").html("");$("#dataTableContainer").html("Error fetching data.")}})}function getFacilityName(n){let t="";return $.ajax({url:urls.Backout.GetFacilityName,type:"GET",data:{facilityId:n},"async":!1,success:function(n){n!=null&&(t=n)},error:function(n,t,i){ErrorMsg("Failed",i,"error")}}),t}function createChart(n,t){let i=document.getElementById("myChart").getContext("2d"),r=new Chart(i,{type:"pie",data:{labels:n,datasets:[{label:"Test Chart",data:t,backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{plugins:{labels:{render:function(n){return n.label+": "+n.value},fontColor:"#fff",precision:0}}}})}function createBarChart(n,t){let i=document.getElementById("myBarChart").getContext("2d"),r=new Chart(i,{type:"bar",data:{labels:n,datasets:[{label:"Test Chart",data:t,backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{}})}function createLabourBarChart(n,t){let i=document.getElementById("myLabourChart").getContext("2d"),r=new Chart(i,{type:"bar",data:{labels:n,datasets:[{label:"Test Chart",data:t,backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{plugins:{labels:{render:function(n){return n.label+": "+n.value},fontColor:"#fff",precision:0}}}})}function createnewLabourBarChart(){}function generatePieChart(n,t,i){let r={chart:{type:"pie"},legend:{position:"bottom",show:!0},series:n,labels:t,responsive:[{breakpoint:480,options:{chart:{width:250},legend:{position:"bottom"}}}]},u=new ApexCharts(document.getElementById(i),r);u.render()}function generateBarChart(n,t,i){let r={chart:{height:350,type:"bar"},plotOptions:{bar:{barHeight:"100%",distributed:!0,width:"2%"}},colors:["#fd7f6f","#7eb0d5","#b2e061","#bd7ebe","#ffb55a","#ffee65","#beb9db","#fdcce5","#8bd3c7"],stroke:{width:5,colors:["#fff"]},legend:{position:"top",show:!0},series:[{name:"Employee",data:n}],xaxis:{categories:t},responsive:[{breakpoint:480,options:{chart:{width:"10%"},legend:{position:"bottom"}}}]},u=new ApexCharts(document.getElementById(i),r);u.render()}function generateSubmissionBarChart(n,t,i){let r={chart:{height:350,type:"bar"},plotOptions:{bar:{barHeight:"50%",distributed:!0,horizontal:!0,width:"5%"}},colors:["#fd7f6f","#7eb0d5","#b2e061","#bd7ebe","#ffb55a","#ffee65","#beb9db","#fdcce5","#8bd3c7"],stroke:{width:5,colors:["#fff"]},legend:{position:"top",show:!0},series:[{name:"Facilities",data:n}],xaxis:{categories:t},responsive:[{breakpoint:480,options:{chart:{width:"10%"},legend:{position:"bottom"}}}]},u=new ApexCharts(document.getElementById(i),r);u.render()}function generateEChartBar(n,t,i){const r={xAxis:{type:"category",data:t},yAxis:{type:"value"},series:[{type:"bar",data:n}]},u=echarts.init(document.getElementById(i));u.setOption(r)}function GenerateSingleradialChart(n,t){let i=n,r={chart:{type:"radialBar",height:250},plotOptions:{radialBar:{hollow:{margin:0,size:"70%"},track:{dropShadow:{enabled:!0,top:0,left:0,blur:4,opacity:.15},strokeWidth:"50%"},dataLabels:{value:{color:undefined,fontSize:"30px",show:!0,formatter:function(n){return n+"%"}},total:{show:!0,fontSize:"13px",label:"Total Percentage",color:"#888",formatter:function(){return i+"%"}}}}},fill:{type:"solid",solid:{shade:"dark",type:"horizontal",shadeIntensity:.5,color:["#2962ff"],inverseColors:!1,opacityFrom:1,opacityTo:1,stops:[0,100]}},stroke:{lineCap:"round"},series:[i],labels:["Series 1"]},u=new ApexCharts(document.getElementById(t),r);u.render()}function GenerateMultiradialChart(n,t,i){let r=n,u={chart:{type:"radialBar",height:280},colors:["#2D6BFF","#56D6FF","#FF3159"],plotOptions:{radialBar:{startAngle:-90,endAngle:90,hollow:{margin:0,size:"60%"},track:{startAngle:-90,endAngle:90,strokeWidth:"100%"},dataLabels:{value:{color:undefined,fontSize:"30px",show:!0,formatter:function(n){return n+"%"}},total:{show:!0,fontSize:"13px",label:"All Percentage",color:"#888",formatter:function(){let n=r.reduce(function(n,t){return n+t},0);return n+"%"}}}}},fill:{type:"solid",solid:{shade:"dark",type:"horizontal",shadeIntensity:.5,color:["#2962ff"],inverseColors:!1,opacityFrom:1,opacityTo:1,stops:[0,100]}},stroke:{lineCap:"round"},series:r,labels:t},f=new ApexCharts(document.getElementById(i),u);f.render()}function generateEchartBarChart(n,t,i){let r={xAxis:{type:"category",data:t},yAxis:{type:"value"},series:[{type:"bar",data:n,itemStyle:{color:"blur"},barWidth:"50%"}]},u=echarts.init(document.getElementById(i));u.setOption(r)}function generateMorisBarChart(n,t,i){let r=[];for(let i=0;i<n.length;i++)r.push({y:t[i],a:n[i]});new Morris.Bar({element:i,data:r,xkey:"y",ykeys:["a"],labels:["Value"],barColors:["#36b9cc"],resize:!0,hideHover:"auto",xLabelAngle:0})}function GeneratedonutApex(n,t,i){let r={chart:{type:"donut"},colors:["#20E647","#7BD2F9","#DBDFE4"],legend:{position:"bottom",show:!0},labels:t,series:n,responsive:[{breakpoint:480,options:{chart:{width:280},legend:{position:"bottom",show:!0}}}]},u=new ApexCharts(document.getElementById(i),r);u.render()}function GeneratesemidonutApex(n,t,i){console.log(i);let r={chart:{type:"donut"},legend:{position:"bottom",show:!0},track:{background:"#333",startAngle:-135,endAngle:135},labels:t,series:n,responsive:[{breakpoint:480,options:{chart:{width:250},legend:{position:"bottom",show:!0}}}]},u=new ApexCharts(document.getElementById(i),r);u.render()}function generateLineApex(n,t,i){let r={series:[{name:"Exempt",data:[120,130,125,140,155,150,160]},{name:"Non-Exempt",data:[80,85,90,100,95,105,110]},{name:"Contract",data:[60,65,70,75,80,85,90]}],xaxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul"]}},u={chart:{type:"line"},series:r.series,xaxis:r.xaxis},f=new ApexCharts(document.getElementById(i),u);f.render()}function generateLineApex(n,t,i){let r={series:[{name:"series1",data:n},],xaxis:{categories:t}},u={chart:{type:"line"},stroke:{curve:"curve"},series:r.series,xaxis:r.xaxis},f=new ApexCharts(document.getElementById(i),u);f.render()}function GenerateAreaApex(n,t,i){let r={chart:{type:"area",height:300,animations:{enabled:!0,easing:"easeinout",speed:800,animateGradually:{enabled:!0,delay:150},dynamicAnimation:{enabled:!0,speed:350}}},series:[{name:"Employee",data:n}],xaxis:{categories:t},yaxis:{labels:{formatter:function(n){return"#"+n}}},dataLabels:{enabled:!1},stroke:{curve:"smooth"},fill:{opacity:.3},tooltip:{theme:"dark"}},u=new ApexCharts(document.getElementById(i),r);u.render()}function generateRateChart(){let n={series:[{name:"Rates : ",labels:["2012","2013","2014","2015","2016","2017"],data:[12,19,3,5,2,3]},],chart:{width:150,height:60,type:"line",toolbar:{show:!1},sparkline:{enabled:!0}},fill:{type:"solid",opacity:1,colors:["#2962ff"]},grid:{show:!1},stroke:{curve:"smooth",lineCap:"square",colors:["#2962ff"],width:3},markers:{size:3,colors:["#2962ff"],strokeColors:"transparent",shape:"square",hover:{size:7}},xaxis:{axisBorder:{show:!1},axisTicks:{show:!1},labels:{show:!1}},fill:{type:"solid",colors:["#FDD835"]},yaxis:{labels:{show:!1}},tooltip:{theme:"dark",style:{fontFamily:'"Nunito Sans", sans- serif'},x:{show:!1},y:{formatter:undefined},marker:{show:!1},followCursor:!0}},t=new ApexCharts(document.querySelector("#rate-chart"),n);t.render()}function GenerateSinglefilledradialChart(n,t){let u=n,i={chart:{height:200,type:"radialBar"},series:[n],colors:["#20E647"],plotOptions:{radialBar:{startAngle:-90,endAngle:90,hollow:{margin:0,size:"70%"},track:{dropShadow:{enabled:!0,top:0,left:0,blur:4,opacity:.15},startAngle:-90,endAngle:90,strokeWidth:"50%"},dataLabels:{name:{offsetY:-10,color:"#888",fontSize:"13px"},value:{color:undefined,fontSize:"30px",show:!0}}}},fill:{type:"solid",solid:{shade:"dark",type:"horizontal",shadeIntensity:.5,color:["#3699ff"],inverseColors:!1,opacityFrom:1,opacityTo:1,stops:[0,100]}},stroke:{lineCap:"round"},labels:["Progress"]},r=new ApexCharts(document.getElementById(t),i);r.render()}function LoadThinkAnewTiles(){$.ajax({url:urls.Dashboard.GetThinkaNewTiles,type:"GET","async":!1,success:function(n){$("#ThinkAnewTiles").html(n)}})}function LoadSecondaryTiles(){$.ajax({url:urls.Dashboard.GetSecondaryTiles,type:"GET","async":!1,success:function(n){$("#SecondaryTiles").html(n)}})}function LoadFacilityTiles(){$.ajax({url:urls.Dashboard.GetFacilityListTiles,type:"GET","async":!1,success:function(n){$("#GetFacilityTiles").html(n)}})}function LoadLabourTable(){$.ajax({url:urls.Dashboard.GetLabourcodeTables,type:"GET","async":!1,success:function(n){$("#GetLabourCodeTable").html(n)}})}function LoadJobTable(){$.ajax({url:urls.Dashboard.GetjobTables,type:"GET","async":!1,success:function(n){$("#GetTopJobTable").html(n)}})}function LoadStaffingData(){$.ajax({url:urls.Dashboard.GetstfData,type:"GET","async":!1,success:function(n){$("#Staffingdata").html(n)}})}function resetstaff(){$.ajax({url:urls.Dashboard.GetstfData,type:"GET","async":!1,success:function(n){$("#Staffingdata").html(n)}})}function loadFacilitydropdown(){$.ajax({type:"Get",cache:!1,"async":!1,url:urls.Dashboard.GetFacilityItemList,success:function(n){let t=$("#facilities");t.empty();t.append('<option value="">- Select Facility Name -<\/option>');$.each(n,function(n,i){t.append('<option value="'+i.value+'">'+i.text+"<\/option>")});t.trigger("change")}})}function loadfilteredLabour(){let n=$("#facilities").val(),t=$("#fiscal").val(),i=$("#year").val(),r=$("#month").val(),u={facilityId:$("#facilities").val(),fiscal:$("#fiscal").val(),year:$("#year").val(),month:$("#month").val()};$.ajax({url:urls.Dashboard.GetLabourcodeTables,type:"GET",data:u,"async":!1,success:function(u){$("#GetLabourCodeTable").html(u);$("#facilities").val(n);$("#fiscal").val(t);$("#year").val(i);$("#month").val(r)}})}function loadfilteredJob(){let n=$("#jcfacilities").val(),t=$("#jcfiscal").val(),i=$("#jcyear").val(),r=$("#jcmonth").val(),u={facilityId:$("#jcfacilities").val(),fiscal:$("#jcfiscal").val(),year:$("#jcyear").val(),month:$("#jcmonth").val()};$.ajax({url:urls.Dashboard.GetjobTables,type:"GET",data:u,"async":!1,success:function(u){$("#GetTopJobTable").html(u);$("#jcfacilities").val(n);$("#jcfiscal").val(t);$("#jcyear").val(i);$("#jcmonth").val(r)}})}function LoadfilteredStaffingData(){let n=$("#SOrg").val(),t=$("#SFacilities").val(),i=$("#Syear").val(),r={orgId:$("#SOrg").val(),facilityId:$("#SFacilities").val(),year:$("#Syear").val()};$.ajax({url:urls.Dashboard.GetstfData,type:"GET",data:r,"async":!1,success:function(r){$("#Staffingdata").html(r);$("#SOrg").val(n);$("#SFacilities").val(t);$("#Syear").val(i)}})}function Loadblogs(){$.ajax({url:urls.Dashboard.GetBlogs,type:"GET","async":!1,success:function(n){$("#blogs").html(n)}})}function LoadPendingStaffingData(){$.ajax({url:urls.Dashboard.GetPendingdata,type:"GET","async":!1,success:function(n){$("#Pendingdata").html(n)}})}function LoadfilteredSubmissionSatus(){let n=$("#SubOrg").val(),t={OrgId:$("#SubOrg").val()};$.ajax({url:urls.Dashboard.GetSubmissionStatus,type:"GET","async":!1,data:t,success:function(t){$("#SubmissionStatus").html(t);$("#SubOrg").val(n)}})}function LoadSubmissionSatus(){$.ajax({url:urls.Dashboard.GetSubmissionStatus,type:"GET","async":!1,success:function(n){$("#SubmissionStatus").html(n)}})}function LoadPreviousSubmission(){$.ajax({url:urls.Dashboard.GetPreviousSubmission,type:"GET","async":!1,success:function(n){$("#SubmissionSData").html(n)}})}function LoadpendingSubmission(){$.ajax({url:urls.Dashboard.GetpendingSubmissions,type:"GET","async":!1,success:function(n){$("#PendingSubmission").html(n)}})}function resetsubStatus(){$.ajax({url:urls.Dashboard.GetSubmissionStatus,type:"GET","async":!1,success:function(n){$("#SubmissionStatus").html(n)}})}function ResetJobCodes(){$("#jcfacilities").val("");$("#jcfiscal").val("");$("#jcyear").val("");$("#jcmonth").val("");$.ajax({url:urls.Dashboard.GetjobTables,type:"GET","async":!1,success:function(n){$("#GetTopJobTable").html(n)}})}function ResetLabourcodeTable(){$("#facilities").val("");$("#fiscal").val("");$("#year").val("");$("#month").val("");$.ajax({url:urls.Dashboard.GetLabourcodeTables,type:"GET","async":!1,success:function(n){$("#GetLabourCodeTable").html(n)}})}function FilterChange(){loadEmployeeList()}function getPayTypeList(){$.ajax({type:"GET",url:urls.PayTypeJobTitle.GetPayCode,success:function(n){$("#PayType").html();GetPayCodeList=n;let t="";$.each(n,function(n,i){t+="<option value='"+i.payTypeCode+"'>"+i.payTypeDescription+"<\/option>"});$("#PayType").html(t)},error:function(){ErrorMsg("Alert!","Failed to load")}})}function getJobTitleList(){$.ajax({type:"GET",url:urls.PayTypeJobTitle.GetJobTitle,success:function(n){$("#JobTitle").html();GetJobTitleList=n;let t="";$.each(n,function(n,i){t+="<option value='"+i.id+"'>"+i.title+"<\/option>"});$("#JobTitle").html(t)},error:function(){ErrorMsg("Alert!","Failed to load")}})}function loadEmployeeList(){let n=$("#FacilityId").val();(n==undefined||n==""||n=="Select Facility Name")&&(n=null);let t={facilityId:n},i=$("#EmployeeListDataTable").DataTable();i.destroy();$("#EmployeeListDataTable").DataTable({ajax:{url:urls.Employee.EmployeeList,type:"POST",data:function(n){n.searchValue=$("#EmployeeListDataTable_filter input").val();n.start=n.start||0;n.length=n.length||10;n.draw=n.draw||1;n.sortColumn=n.columns[n.order[0].column].data;n.sortDirection=n.order[0].dir;n.facilityId=t.facilityId},error:function(n,t){(t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)&&ErrorMsg("Failed","Unauthorized Access")}},processing:!0,serverSide:!0,filter:!0,pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}},columns:[{data:"employeeId",name:"Id"},{data:"employeeFullName",name:"Employee Name"},{data:"hireDate",name:"Hire Date"},{data:"terminationDate",name:"Termination Date"},{data:"facilityName",name:"Facility Name"},{data:"payType",name:"Pay Type"},{data:"jobTitle",name:"Job Title"},{data:"createDate",name:"Create Date"},{data:null,orderable:!1,render:function(n,t,i){let r=i.isActive?"<a href='#' onclick=UpdateEmployeeStatus('"+i.id+"','false'); data-bs-toggle='tooltip' data-bs-placement='top' title='Deactivate'><i class='fas fa-toggle-on me-2 text-success fs-6'><\/i><\/a>":"<a href='#' onclick=UpdateEmployeeStatus('"+i.id+"','true'); data-bs-toggle='tooltip' data-bs-placement='top' title='Activate'><i class='fas fa-toggle-off me-2 text-muted fs-6'><\/i><\/a>";return" <a href='#' onclick=editEmployee('"+i.id+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Edit'><i class='ri-edit-2-line fs-6 pe-2 text-info'><\/i><\/a>"+r}}]})}function editEmployee(n){clearEmployeeData();let t={Id:n};showLoader();$.ajax({url:urls.Review.EditEmployeeData,type:"POST",data:t,success:function(n){hideLoader();$("#EmployeeModalLabel").html("");$("#EmployeeModalLabel").html("Edit Staff");let t=n.hireDate=="0001-01-01T00:00:00"?n.hireDate:moment(n.hireDate).format("YYYY-MM-DD"),i=n.terminationDate=="0001-01-01T00:00:00"?n.terminationDate:moment(n.terminationDate).format("YYYY-MM-DD");$("#EmployeeId").val(n.id);$("#Employee_Id").val(n.employeeId);$("#Employee_Id").prop("disabled",!0);$("#FirstName").val(n.firstName);$("#LastName").val(n.lastName);$("#HireDate").val(t);$("#TerminationDate").val(i);$("#PayType").val(n.payTypeCode).trigger("change");$("#JobTitle").val(n.jobTitleCode).trigger("change");$("#FacilityNameId").val(n.facilityId).trigger("change");$("#SaveEmployee").css("display","none");$("#UpdateEmployee").css("display","block");$("#AddEmployeeModel").modal("show");draggableModel("#AddEmployeeModel")},error:function(n,t){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Alert!","Failed to load")}})}function deleteEmployee(n){ConfirmMsg("Employee","Are you sure want to delete the employee data?","Continue",event,function(){showLoader();$.ajax({url:urls.Review.DeleteEmployee,type:"POST",data:{EmployeeId:n},success:function(n){hideLoader();n.statusCode==200?(SuccessMsg("Success",n.message,"success"),loadEmployeeList()):ErrorMsg("Failed",n.message)},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Error",i,"")}})})}function clearEmployeeData(){$("#EmployeeId").val("");$("#Employee_Id").val("");$("#FirstName").val("");$("#LastName").val("");$("#HireDate").val("");$("#TerminationDate").val("");$("#Employee_IdError").html("");$("#FirstNameError").html("");$("#LastNameError").html("");$("#HireDateError").html("");$("#TerminationDateError").html("");$("#PayTypeError").html("");$("#JobTitleError").html("");$("#FacilityNameId").val(null).trigger("change");$("#FacilityNameIdError").html("")}function openEmployeeMoal(){$("#EmployeeId").val("");$("#EmployeeModalLabel").html("");$("#EmployeeModalLabel").html("Add Staff");$("#Employee_Id").prop("disabled",!1);$("#SaveEmployee").css("display","block");$("#UpdateEmployee").css("display","none");clearEmployeeData()}function saveEmployeeFunction(){let i=$('input[name="__RequestVerificationToken"]').val();var n=/^[a-zA-Z'. ]+$/,t=0;if(clearErrorMessage(),$(".fieldRequired").each(function(){let n=$(this).attr("id"),i=$("#"+n).val();if(i==""||i==null)return $("#"+n+"Error").html("The "+$("#"+n+"Error").attr("title")+" field is required."),t=1,!1;$("#"+n+"Error").html("")}),t==1)return!1;if($("#Employee_Id").val().length>30)return $("#Employee_IdError").html("Employee Id must be smaller then 30 characters."),!1;if(!/^[a-zA-Z0-9]+$/.test($("#Employee_Id").val()))return $("#Employee_IdError").html("No spacial characters are allowed"),!1;if(!n.test($("#FirstName").val()))return $("#FirstNameError").html("First Name allows only alphabatic characters"),!1;if(!n.test($("#LastName").val()))return $("#LastNameError").html("Last Name allows only alphabatic characters"),!1;if($("#HireDate").val()!=""&&$("#TerminationDate").val()!=""&&$("#HireDate").val()>$("#TerminationDate").val())return $("#TerminationDateError").html("The Termination date should be greater than Hire date."),!1;if($("#TerminationDate").val()!=""&&$("#HireDate").val()=="")return $("#HireDateError").html("Select Hire date."),!1;if(clearErrorMessage(),$("#FacilityId").val()==undefined||$("#FacilityId").val()=="")return WarningMsg("Alert!","Please select Facility","Okay"),!1;let r={Id:$("#EmployeeId").val(),EmployeeId:$("#Employee_Id").val().trim(),FirstName:$("#FirstName").val().trim(),LastName:$("#LastName").val().trim(),PayType:$("#PayType").val(),JobTitle:$("#JobTitle").val(),HireDate:$("#HireDate").val(),TerminationDate:$("#TerminationDate").val(),FacilityId:$("#FacilityNameId").val()};showLoader();$.ajax({url:urls.Review.SaveEmployeeeData,type:"POST",headers:{RequestVerificationToken:i},data:r,"async":!1,cache:!1,success:function(n){if(hideLoader(),n=="Success"){SuccessMsg("Success","Record saved successfully","success");$("#AddEmployeeModel").modal("hide");clearEmployeeData();let n=$("#EmployeeListTable").DataTable();n.destroy();loadEmployeeList()}else if(n=="IdError")$("#Employee_IdError").html("No spacial characters are allowed");else if(n=="FirstNameError")$("#FirstNameError").html("First Name allows only alphabatic characters");else if(n=="LastNameError")$("#LastNameError").html("Last Name allows only alphabatic characters");else return WarningMsg("Alert!",n,"Failed"),!1},error:function(){hideLoader();ErrorMsg("Alert!","Failed")}})}function clearErrorMessage(){$("#Employee_IdError").html("");$("#FirstNameError").html("");$("#LastNameError").html("");$("#HireDateError").html("");$("#TerminationDateError").html("")}function importEmpoyeeFile(){let t=$("#FacilityId").val();if(t==undefined||t==""||t=="Select Facility Name")return ErrorMsg("Warning","Please select the facility name"),!1;let i=$("input[type='file']")[0],n=i.files[0];if(n==undefined||n=="")return ErrorMsg("Warning","Please select a file!"),!1;if(n!=undefined){let t=new FormData;t.append("FacilityId",$("#FacilityId").val());t.append("file",n);showLoader();$.ajax({url:urls.Employee.SaveEmployeeDetail,type:"POST",data:t,contentType:!1,processData:!1,success:function(n){if(n.statusCode==200)hideLoader(),SuccessMsg("Success",n.message,"success"),$("#file").val(""),$("#ImportEmployee").modal("hide"),loadEmployeeList();else if(n.statusCode==202){if(n.keyValuePairs.length>0){$("#tableBodyEmpErrorList").html("");$("#file").val("");let t="";n.keyValuePairs.forEach(function(n){t+="<tr>";t+="<td>"+n.key+"<\/td>";t+="<td>"+n.value+"<\/td>";t+="<\/tr>"});loadEmployeeList();hideLoader();WarningMsg("Alert!",n.message,"Okay");$("#tableBodyEmpErrorList").html(t);$("#ImportEmployee").modal("hide");$("#ImportEmployeeErrorList").modal("show");draggableModel("#ImportEmployeeErrorList")}}else hideLoader(),$("#file").val(""),ErrorMsg("Warning",n.message)},error:function(){hideLoader();ErrorMsg("Warning","Failed to import")}})}}function getLoggedInUser(){let n;return $.ajax({url:"/Facility/CheckUserRole",type:"GET","async":!1,dataType:"json",success:function(t){n=t?!0:!1},error:function(n,t,i){t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}}),hideLoader(),ErrorMsg("Warning","Failed to import"),n}function initSelect2EmployeeMaster(){$("#PayType").select2({dropdownParent:$("#PayTypeDiv"),placeholder:"Select Pay Type",width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#JobTitle").select2({dropdownParent:$("#JobTitleDiv"),placeholder:"Select Job Title",width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#FacilityNameId").select2({dropdownParent:$("#FacilityNameIdDiv"),placeholder:"Select Facility Name",width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")})}function clearFilter(){$("#FacilityId").val("Select Facility Name").trigger("change")}function UpdateEmployeeStatus(n,t){let i=t==="true"?"Are you sure you want to activate this employee?":"Are you sure you want to deactivate this employee?";ConfirmMsg("Employee Management",i,"Continue",event,function(){showLoader();$.ajax({url:urls.Review.UpdateEmployeeStatus,type:"POST",data:{employeeId:n,status:t},success:function(n){hideLoader();n.statusCode==200?(SuccessMsg("Success",n.message,"success"),loadEmployeeList()):ErrorMsg("Failed",n.message)},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Error",i,"")}})})}function restrictInput(n){let t=n.key;/^[A-Za-z\s\-'.]+$/.test(t)||t==="Backspace"||n.preventDefault()}function saveFacility(){let i=$('input[name="__RequestVerificationToken"]').val(),n=$("#facilityLocationId").val(),t=$("#facilityDescription").val(),r={OrganizationId:$("#facilityOrganizationName").val(),FacilityID:$("#facilityID").val(),FacilityName:$("#facilityName").val(),Address1:$("#facilityAddress1").val(),Address2:$("#facilityAddress2").val(),City:$("#facilityCity").val(),State:$("#facilityState").val(),ZipCode:$("#facilityZipCode").val(),ApplicationId:$("#facilityApplicationName").val(),HasDeduction:$("#hasDeduction").is(":checked"),OverTimeDeduction:$("#overTimeValue").val(),RegularDeduction:$("#regularTimeValue").val(),LocationId:n===""||n===null?"":n,locationDescription:t===""||t===null?"":t};showLoader();$.ajax({url:urls.FacilityManagement.SaveFacility,type:"POST",headers:{RequestVerificationToken:i},data:r,"async":!1,cache:!1,success:function(n){hideLoader();n=="success"?(SuccessMsg("Success","Record Added successfully","success"),$("#FacilityModal").modal("hide")):n=="failed"&&(ErrorMsg("Failed",error,"error"),$("#FacilityModal").modal("hide"));let t=$("#facilityTable").DataTable();t.destroy();loadFacilityData();clearFacilityData()},failure:function(){hideLoader();ErrorMsg("Error","Something went wrong !Try again later","")},error:function(n,t,i){if(hideLoader(),t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)ErrorMsg("Failed","Unauthorized Access");else if(n.status==HTTP_STATUS_TOOMANYREQUESTS||t==HTTP_STATUS_TOOMANYREQUESTS){ErrorMsg("Failed","Too Many Requests, Please try after some time");$("#FacilityModal").modal("hide");let n=$("#facilityTable").DataTable();n.destroy();loadFacilityData();clearFacilityData()}else ErrorMsg("Failed",i,"error")}})}function kronossaveFacility(){let t=$('input[name="__RequestVerificationToken"]').val(),n={OrganizationId:$("#facilityOrganizationName").val(),FacilityID:$("#facilityID").val(),FacilityName:$("#facilityName").val(),Address1:$("#facilityAddress1").val(),Address2:$("#facilityAddress2").val(),City:$("#facilityCity").val(),State:$("#facilityState").val(),ZipCode:$("#facilityZipCode").val(),ApplicationId:$("#facilityApplicationName").val(),HasDeduction:$("#hasDeduction").is(":checked"),OverTimeDeduction:$("#overTimeValue").val(),RegularDeduction:$("#regularTimeValue").val()};showLoader();$.ajax({url:urls.FacilityManagement.SaveFacility,headers:{RequestVerificationToken:t},type:"POST",data:n,"async":!1,cache:!1,success:function(t){hideLoader();t=="success"?($("#KronosFacilityModal").modal("hide"),$.ajax({url:urls.FacilityManagement.DeleteByFacilityID,type:"POST",data:{id:n.FacilityID},"async":!1,cache:!1,success:function(n){n?SuccessMsgWithReload("Success","Record Added successfully","success"):ErrorMsg("Failed","Failed to delete","error")},error:function(n,t,i){ErrorMsg("Failed",i,"error");$("#KronosFacilityModal").modal("hide");clearFacilityData()}})):t=="failed"&&ErrorMsg("Failed","error","error")},failure:function(){hideLoader();ErrorMsg("Error","Something went wrong !Try again later","");clearFacilityData()},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):n.status==HTTP_STATUS_TOOMANYREQUESTS||t==HTTP_STATUS_TOOMANYREQUESTS?(ErrorMsg("Failed","Too Many Requests, Please try after some time"),$("#KronosFacilityModal").modal("hide"),clearFacilityData()):ErrorMsg("Failed",i,"error");clearFacilityData()}})}function deleteFacility(n){let t=$('input[name="__RequestVerificationToken"]').val();ConfirmMsg("Facility Management","Are you sure want to delete this facility?","Continue",event,function(){$.ajax({url:urls.FacilityManagement.DeleteFacility,type:"POST",headers:{RequestVerificationToken:t},data:{facilityId:n},success:function(n){n=="success"?SuccessMsg("Success","Record Deleted successfully","success"):ErrorMsg("Failed",error,"error");let t=$("#facilityTable").DataTable();t.destroy();loadFacilityData()},error:function(n,t,i){t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}})})}function editFacility(n){clearFacilityData();showLoader();$.ajax({url:urls.FacilityManagement.EditFacility,type:"GET",data:{facilityId:n},success:function(n){hideLoader();$("#FacilityModal").modal("show");draggableModel("#FacilityModal");$("#id").val(n.id);$("#facilityID").val(n.facilityID);$("#facilityOrganizationName").val(n.organizationId).trigger("change");$("#facilityName").val(n.facilityName);$("#facilityAddress1").val(n.address1);$("#facilityAddress2").val(n.address2);$("#facilityCity").val(n.city);$("#facilityState").val(n.state).trigger("change");$("#facilityZipCode").val(n.zipCode);$("#facilityApplicationName").val(n.applicationId).trigger("change");$("#hasDeduction").val(n.hasDeduction);n.hasDeduction===!0?($("#hasDeduction").prop("checked",!0),$("#regularTime").show(),$("#overTime").show(),$("#Duduction").show(),$("#DefaultTime").show(),$("#regularTimeValue").val(n.regularDeduction),$("#overTimeValue").val(n.overTimeDeduction)):($("#regularTime").hide(),$("#overTime").hide(),$("#Duduction").hide(),$("#regularTimeValue").val(""),$("#overTimeValue").val(""));$("#facilityLocationId").val(n.locationId);$("#facilityDescription").val(n.locationDescription);$("#FacilityModalLabel").text("Update Facility");$("#btnSaveFacility").hide();$("#btnUpdateFacility").show();$("#facilityID").prop("disabled",!0);$("#facilityOrganizationName").prop("disabled",!0)},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}})}function clearFacilityData(){$("#facilityOrganizationName").val(null).trigger("change");$("#facilityID").val("");$("#facilityName").val("");$("#facilityAddress1").val("");$("#facilityAddress2").val("");$("#facilityCity").val("");$("#facilityState").val("").trigger("change");$("#facilityZipCode").val("");$("#facilityApplicationName").val("").trigger("change");$("#facilityLocationId").val("");$("#facilityDescription").val("");$(".errormsg").text("");$("#FacilityModalLabel").text("Add Facility");$("#btnSaveFacility").show();$("#btnUpdateFacility").hide();$("#facilityID").prop("disabled",!1);$("#facilityOrganizationName").prop("disabled",!1);$("#regularTimeValue").val("");$("#overTimeValue").val("");$("#regularTime").hide();$("#overTime").hide();$("#Duduction").hide();$("#DefaultTime").prop("checked",!1);$("#hasDeduction").prop("checked",!1)}function updateFacility(){let i=$('input[name="__RequestVerificationToken"]').val(),n=$("#facilityLocationId").val(),t=$("#facilityDescription").val(),r={Id:$("#id").val(),OrganizationId:$("#facilityOrganizationName").val(),FacilityID:$("#facilityID").val(),FacilityName:$("#facilityName").val(),Address1:$("#facilityAddress1").val(),Address2:$("#facilityAddress2").val(),City:$("#facilityCity").val(),State:$("#facilityState").val(),ZipCode:$("#facilityZipCode").val(),ApplicationId:$("#facilityApplicationName").val(),LocationId:n===""||n===null?"":n,locationDescription:t===""||t===null?"":t};showLoader();$.ajax({url:urls.FacilityManagement.UpdateFacility,type:"POST",headers:{RequestVerificationToken:i},data:r,"async":!1,success:function(n){hideLoader();n=="success"?(SuccessMsg("Success","Record Updated successfully","success"),$("#FacilityModal").modal("hide")):($("#FacilityModal").modal("hide"),ErrorMsg("Failed",error,"error"));let t=$("#facilityTable").DataTable();t.destroy();loadFacilityData();clearFacilityData()},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}})}function checkDeduction(){let n=$("#regularTimeValue").val(),t=$("#overTimeValue").val();return $("#hasDeduction").is(":checked")?$("#DefaultTime").is(":checked")?($("#spHasDeduction").empty(),!0):$("#regularTimeValue").val()!==""&&$("#overTimeValue").val()!=""?($("#spHasDeduction").empty(),!0):($("#spHasDeduction").text("Please select default or Enter Deduction time"),!1):!0}function validateFacilityForm(){return!($("#facilityOrganizationName").val()==""||$("#facilityID").val()==""||$("#facilityName").val()==""||$("#facilityAddress1").val()==""||$("#facilityCity").val()==""||$("#facilityState").val()==""||$("#facilityZipCode").val()==""||$("#facilityApplicationName").val()==""||$(".errormsg").text()!="")}function initSelect2ForFacility(){$("#facilityOrganizationName").select2({placeholder:"Select Organization Name",dropdownParent:$("#organizationIdDiv"),width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#facilityState").select2({placeholder:"Select State Name",dropdownParent:$("#stateSelectDiv"),width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#facilityApplicationName").select2({placeholder:"Select Application Name",dropdownParent:$("#applicationIdDiv"),width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#facilityOrgName").select2({placeholder:"Select Organization Name",width:"100%"}).on("select2:close",function(){$(this).val()==null&&($(this).val("").trigger("change"),$(this).next(".select2-container").find(".select2-search__field").attr("placeholder","Select options"))});$("#facilityAppName").select2({placeholder:"Select Application Name",width:"100%"}).on("select2:close",function(){$(this).val()==null&&($(this).val("").trigger("change"),$(this).next(".select2-container").find(".select2-search__field").attr("placeholder","Select options"))})}function loadFacilityData(){let n=$("#facilityOrgName").val(),r=sessionStorage.getItem("organizationName");r!=null?$("#facilityOrgName").val(r.trim()).trigger("change"):$("#facilityOrgName").val(n).trigger("change");n=="Select Organization Name"&&(n=null);let t=$("#facilityAppName").val();t=="Select Application Name"?t=null:$("#facilityAppName").val(t).trigger("change");let f=getLoggedInUser(),e=getLoggedInUserInfo(),u="";e||(u=getOrganizationUserDetails());let i={orgName:n,appName:t,storedValue:r,orgId:u};$("#facilityTable").DataTable({ajax:{url:urls.FacilityManagement.GetFacilitiesList,type:"POST",data:function(n){n.searchValue=$("#facilityTable_filter input").val();n.start=n.start||0;n.length=n.length||10;n.draw=n.draw||1;n.sortColumn=n.columns[n.order[0].column].data;n.sortDirection=n.order[0].dir;n.orgName=i.orgName;n.appName=i.appName;n.storedValue=i.storedValue;n.orgId=i.orgId},error:function(n,t){(t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)&&ErrorMsg("Failed","Unauthorized Access")}},processing:!0,serverSide:!0,filter:!0,pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}},columns:[{data:"facilityID",name:"Facility Id"},{data:"facilityName",name:"Facility Name"},{data:"organizationName",name:"Organization Name"},{data:"appId",name:"Application Name"},{data:"state",name:"State"},{data:"locationId",name:"Location Id"},{data:null,orderable:!1,render:function(n,t,i){return"<a href='#' onclick=editFacility('"+i.id+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Edit'><i class='ri-edit-2-line fs-6 pe-2 text-info'><\/i><\/a> <a href='#' onclick=deleteFacility('"+i.id+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Delete'><i class='ri-delete-bin-line fs-6 text-danger'><\/i><\/a>"}},{orderable:!1,render:function(n,t,i){return f?"<a href='#' onclick=addUser('"+i.organizationId+"','"+i.id+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Add User' ><i class='ri-add-circle-line fs-6 pe-2 text-primary'><\/i><\/a>":"<a href='#' onclick=addUser('"+i.organizationId+"','"+i.id+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Add User' class='pe-none'><i class='ri-add-circle-line fs-6 pe-2 text-muted'><\/i><\/a>"}}]})}function addUser(n,t){sessionStorage.setItem("organizationId",n);sessionStorage.setItem("facilityId",t);window.location.href=urls.UserManagement.GetValues+"?AddUserId=btnAddUser&fromFacility=true"}function clearFilter(){$("#facilityOrgName").val(null).trigger("change");$("#facilityAppName").val(null).trigger("change");sessionStorage.removeItem("organizationName")}function loadModalPopUp(){$("#btnAddFacility").trigger("click");let n=sessionStorage.getItem("organizationId").trim();$("#facilityOrganizationName").val(n).trigger("change")}function getLoggedInUser(){let n;return showLoader(),$.ajax({url:"/Facility/CheckUserRole",type:"GET","async":!1,dataType:"json",success:function(t){hideLoader();n=t?!0:!1},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}}),n}function allowOnlyDigits(n){let t=n.key;/^\d$/.test(t)||t==="Backspace"||t==="Tab"||n.preventDefault()}function isAlphaNumericOnly(n){let t=n.which?n.which:n.keyCode;return!!(t>47&&t<58||t>64&&t<91||t>96&&t<123)}function isAlphaNumeric(n){let t=n.which?n.which:n.keyCode;return!!(t>47&&t<58||t>64&&t<91||t>96&&t<123||t===32)}function validateInputOnBlur(n){let r=n.value;if(r==""){$("#facilityName_Error").text("Please Enter a  Facility Name");return}let t=$("#btnSaveFacility"),i=$("#btnUpdateFacility"),u=document.getElementById("facilityName"),f=/[a-zA-Z]/.test(r);f?$("#facilityName_Error").text()!=""?(u.focus(),t.prop("disabled",!0),i.prop("disabled",!0)):($("#facilityName_Error").text(""),t.prop("disabled",!1),i.prop("disabled",!1)):($("#facilityName_Error").text("Input is invalid. It should contain at least one character"),u.focus(),t.prop("disabled",!0),i.prop("disabled",!0));checkForUniqueFacilityName()}function restrictInput(n){let t=n.key;/^[A-Za-z\-,''\s]+$/.test(t)||t==="Backspace"||n.preventDefault()}function restrictSpecialChars(n){let t=n.key;/^[a-zA-Z0-9\s\-,'.']+$/.test(t)||t==="Backspace"||n.preventDefault()}function handleClick(n){let t=document.getElementById("accordionFlushExample"),i=document.getElementById("flush-collapseOne"),r=n.target;t.contains(r)||i.classList.remove("show")}function checkForUniqueFacilityName(){let r=$("#facilityName").val(),u=$("#facilityID").val(),n=$("#btnSaveFacility"),t=$("#btnUpdateFacility"),i=document.getElementById("facilityName");$.ajax({url:urls.FacilityManagement.CheckForFacilityName,type:"GET",data:{facilityName:r,facilityId:u},success:function(r){r?($("#facilityName_Error").text("Facility Name already exists, please use another Name"),i.focus(),n.prop("disabled",!0),t.prop("disabled",!0)):$("#facilityName_Error").text()!=""?(i.focus(),n.prop("disabled",!0),t.prop("disabled",!0)):($("#facilityName_Error").text(""),n.prop("disabled",!1),t.prop("disabled",!1))},error:function(n,t,i){ErrorMsg("Failed",i,"error")}})}function checkForUniqueId(){let i=$("#facilityID").val();if(i==""){$("#facilityId_Error").text("Please Enter Facility Id");return}let n=$("#btnSaveFacility"),t=$("#btnUpdateFacility"),r=document.getElementById("facilityID");$.ajax({url:urls.FacilityManagement.CheckForFacilityId,type:"GET",data:{facilityId:i},success:function(i){i?($("#facilityId_Error").text("Facility Id already exists, please use another Id"),r.focus(),n.prop("disabled",!0),t.prop("disabled",!0)):$("#facilityId_Error").text()!=""?(r.focus(),n.prop("disabled",!0),t.prop("disabled",!0)):($("#facilityId_Error").text(""),n.prop("disabled",!1),t.prop("disabled",!1))},error:function(n,t,i){ErrorMsg("Failed",i,"error")}})}function openModal(n,t,i){clearFacilityData();let r=n,u=t;$("#facilityOrganizationName").val(u);$("#facilityOrganizationName").trigger("change");$("#facilityApplicationName").val(i);$("#facilityApplicationName").trigger("change");$("#facilityID").val(r);$("#facilityID").prop("disabled",!0);$("#facilityApplicationName").prop("disabled",!0);$("#facilityOrganizationName").prop("disabled",!0)}function getOrgServiceType(){let n=$("#facilityOrganizationName").val();n!=""&&n!=null?$.ajax({url:urls.FacilityManagement.GetOrganizationServiceDetails,type:"GET",data:{organizationId:n},success:function(n){n!=""&&n.organizationId>0?(document.getElementById("LocationInformationDiv").style.display="block",$("#facilityApplicationName").val("3").trigger("change")):(document.getElementById("LocationInformationDiv").style.display="none",$("#facilityLocationId").val(""),$("#facilityLocationDescription").val(""))},error:function(n,t,i){ErrorMsg("Failed",i,"error")}}):(document.getElementById("LocationInformationDiv").style.display="none",$("#facilityLocationId").val(""),$("#facilityLocationDescription").val(""))}function getOrganizationUserDetails(){let n=null;return showLoader(),$.ajax({url:urls.FacilityManagement.GetOrganizationUserInfo,type:"GET","async":!1,success:function(t){hideLoader();t!=null&&(n=t)},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}}),n}function getLoggedInUserInfo(){let n=!1;return showLoader(),$.ajax({url:urls.AgencyManagement.GetLoggedInUserInfo,type:"GET","async":!1,success:function(t){hideLoader();t!=null&&(n=t)},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}}),n}function SuccessMsg(n,t){Swal.fire({title:n,text:t,icon:"success",showCancelButton:!1,confirmButtonClass:"btn btn-primary w-xs me-2 mt-2",buttonsStyling:!1,showCloseButton:!0})}function SuccessMsgWithReload(n,t){Swal.fire({title:n,text:t,icon:"success",showCancelButton:!1,confirmButtonClass:"btn btn-primary w-xs me-2 mt-2",buttonsStyling:!1,showCloseButton:!0}).then(n=>{n.isConfirmed&&window.location.reload()})}function ErrorMsg(n,t){Swal.fire({title:n,text:t,icon:"error",showCancelButton:!1,confirmButtonClass:"btn btn-primary w-xs me-2 mt-2",buttonsStyling:!1,showCloseButton:!0})}function WarningMsg(n,t){Swal.fire({title:n,text:t,icon:"warning",showCancelButton:!1,confirmButtonClass:"btn btn-primary w-xs me-2 mt-2",buttonsStyling:!1,showCloseButton:!0})}function ConfirmMsg(n,t,i,r,u){r.preventDefault();Swal.fire({title:n,text:t,icon:"warning",showCancelButton:!0,confirmButtonColor:"#009ade",cancelButtonColor:"#d33",confirmButtonText:i}).then(n=>{n.isConfirmed&&u()})}function ToastifyMsg(n,t){Toastify({offset:{x:50,y:70},text:n,duration:4e3,newWindow:!0,close:!0,gravity:"top",positionLeft:!1,positionRight:!0,backgroundColor:t}).showToast()}function validEmail(n){return/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/.test(n)?!0:!1}function PasswordCheck(n){let t=n,i=1;jQuery.map([/.{5,}/,/[a-z]+/,/[0-9]+/,/[A-Z]+/],function(n){t.match(n)&&i++})}function PasswordReenterPasswordCHeck(n,t){if(n===t)return!0;!1}function mobileNumber(n){return/^((?:[1-9][0-9 ().-]{5,12}[0-9])|(?:(00|0)( ){0,1}[1-9][0-9 ().-]{3,12}[0-9])|(?:(\\+)( ){0,1}[1-9][0-9 ().-]{4,12}[0-9]))$/gm.test(n)?!0:!1}function Requiredfield(n){let t=n.trim()||"";return t!=""?!0:!1}function numberonly(n){return n.match(/^\d+$/)?!0:!1}function phoneFormat(n){n=n.replace(/\D/g,"");n=n.substring(0,12);let t=n.length;return t==0?n=n:t<4?n=""+n:t<7?n=" "+n.substring(0,2)+" "+n.substring(2,6):t>7&&(n=" "+n.substring(0,2)+" "+n.substring(2,6)+n.substring(6,12)),n}function tel_Format(n){n=n.replace(/\D/g,"");n=n.substring(0,11);let t=n.length;return t==0?n=n:t<4?n=""+n:t<7?n=" "+n.substring(0,3)+" "+n.substring(3,7):t>7&&(n=" "+n.substring(0,3)+" "+n.substring(3,7)+" "+n.substring(7,11)),n}function showLoader(){$(".preloader").css("display","block")}function hideLoader(){$(".preloader").css("display","none")}function draggableModel(n){$(n+" .modal-dialog").draggable({handle:".modal-header"})}function allowAlphaNumericSpace(n){let t=n.key;/^[a-zA-Z0-9\s]+$/.test(t)||t==="Backspace"||n.preventDefault()}function allowAlphaNumericWithoutSpace(n){let t=n.key;/^[a-zA-Z0-9]+$/.test(t)||t==="Backspace"||n.preventDefault()}function updateKronosForm(){let n={KronosHostGLC:$("#KronosHostGLC").val(),KronosPortGLC:$("#KronosPortGLC").val(),KronosUserNameGLC:$("#KronosUserNameGLC").val(),KronosPasswordGLC:$("#KronosPasswordGLC").val(),StorageConnectionString:$("#StorageConnectionString").val(),KronosDecryptionPasswordGLC:$("#KronosDecryptionPasswordGLC").val(),KronosDecryptOrEncryptKeyBlobNameGLC:$("#KronosDecryptOrEncryptKeyBlobNameGLC").val(),KronosPunchExportGLC:$("#KronosPunchExportGLC").val(),OrganizationId:$("#OrganizationId").val()};showLoader();validatecredentials()?$.ajax({url:urls.LabourFileMoverurls.UpdateKronosForm,type:"POST",data:n,success:function(n){hideLoader();n=="Success"?(SuccessMsg("Success","Record Added successfully","success"),window.location.href=urls.LabourFileMoverurls.OrgCredsHome):n=="Data Exists"?WarningMsg("Alert!","Record Added successfully","success"):ErrorMsg("Error","Failed to Update","")},error:function(){hideLoader();ErrorMsg("Error","Something went wrong","")}}):hideLoader()}function checkOrgCreds(){let n=$("#OrganizationId").val();n!==""&&n!==undefined&&$.ajax({url:urls.LabourFileMoverurls.OrgCredsCheck,type:"POST",data:{id:n},success:function(n){n||(WarningMsg("Alert!","Record exists","success"),$("#OrganizationId").val(""),$("#OrganizationId").trigger("change"))},error:function(){}})}function combinedFormSubmit(){let n={KronosHostGLC:$("#KronosHostGLC").val(),KronosPortGLC:$("#KronosPortGLC").val(),KronosUserNameGLC:$("#KronosUserNameGLC").val(),KronosPasswordGLC:$("#KronosPasswordGLC").val(),StorageConnectionString:$("#StorageConnectionString").val(),KronosDecryptionPasswordGLC:$("#KronosDecryptionPasswordGLC").val(),KronosDecryptOrEncryptKeyBlobNameGLC:$("#KronosDecryptOrEncryptKeyBlobNameGLC").val(),KronosPunchExportGLC:$("#KronosPunchExportGLC").val(),OrganizationId:$("#OrganizationId").val()};showLoader();validatecredentials()?$.ajax({url:urls.LabourFileMoverurls.addOrgCreds,type:"POST",data:n,success:function(n){hideLoader();n=="Success"?SuccessMsgWithReload("Success","Record Added successfully","success"):n=="Data Exists"?WarningMsg("Alert!","Record exists","success"):ErrorMsg("Error","Failed to Add Credentials","")},error:function(){hideLoader()}}):hideLoader()}function validatecredentials(){let n=!0;return $("#KronosHostGLC").val()==""&&($("#spKronosHostGLC").text("Please enter KronosHostGLC"),n=!1),$("#KronosPortGLC").val()==""&&($("#spKronosPortGLC").text("Please enter KronosPortGLC"),n=!1),$("#KronosUserNameGLC").val()==""&&($("#spKronosUserNameGLC").text("Please enter KronosUserNameGLC"),n=!1),$("#KronosPasswordGLC").val()==""&&($("#spKronosPasswordGLC").text("Please enter KronosPasswordGLC"),n=!1),$("#StorageConnectionString").val()==""&&($("#spStorageConnectionString").text("Please enter StorageConnectionString"),n=!1),$("#KronosDecryptOrEncryptKeyBlobNameGLC").val()==""&&($("#spKronosDecryptOrEncryptKeyBlobNameGLC").text("Please enter KronosDecryptOrEncryptKeyBlobNameGLC"),n=!1),$("#KronosDecryptionPasswordGLC").val()==""&&($("#spKronosDecryptionPasswordGLC").text("Please enter KronosDecryptionPasswordGLC"),n=!1),$("#KronosPunchExportGLC").val()==""&&($("#spKronosPunchExportGLC").text("Please enter KronosPunchExportGLC"),n=!1),$("#OrganizationId").val()==""&&($("#spOrganizationId").text("Please select Organization"),n=!1),n}function clearCombinedFormValues(){$("#KronosForm")[0].reset();$("#OrganizationId").val("").trigger("change");$(".validation").empty();$("#KronosHostGLC").val("");$("#KronosPortGLC").val("");$("#KronosUserNameGLC").val("");$("#KronosPasswordGLC").val("");$("#StorageConnectionString").val("");$("# KronosDecryptionPasswordGLC").val("");$("#KronosDecryptOrEncryptKeyBlobNameGLC").val("");$("#KronosPunchExportGLC").val("")}function updateKronosStatus(n,t){let i="";i=t=="0"?"Deactivate":"Activate";let r="Are you sure want to "+i+" this Organization?";ConfirmMsg("Kronos",r,"Continue",event,function(){let i={userId:n,status:t};showLoader();$.ajax({type:"Post",data:i,"async":!1,url:urls.LabourFileMoverurls.ChangeKronosStatus,success:function(n){hideLoader();n=="success"?SuccessMsgWithReload("Success","Active status has been changed",""):ErrorMsg("Error","Unable to change status!Try again later","")},failure:function(){hideLoader();ErrorMsg("Error","Something went wrong!Try again Later","")},error:function(){hideLoader();ErrorMsg("Error","Something went wrong!Try again Later","")}})})}function getEmployees(){let n={id:$("#Facility").val()};$.ajax({url:urls.LabourFileMoverurls.GetEmployees,type:"POST",data:n,"async":!1,cache:!1,success:function(n){let t=$("#EmployeeList");t.empty();t.append('<option value="">- Select Employee Name -<\/option>');$.each(n,function(n,i){t.append('<option value="'+i.text+'">'+i.text+"<\/option>")});t.trigger("change")},failure:function(){ErrorMsg("Error","Something went wrong!Try again Later","")},error:function(){ErrorMsg("Error","Something went wrong!Try again Later","")}})}function filterReset(){$("#Orglist").val("").trigger("change");$("#Facility").val("").trigger("change");$("#EmployeeList").val("").trigger("change");$("#QuarterList").val("").trigger("change");$("#UserName").val("");pendingDataFilters()}function getFacilities(){let n={id:$("#Orglist").val()};$.ajax({url:urls.LabourFileMoverurls.GetFacilities,type:"POST",data:n,"async":!1,cache:!1,success:function(n){let t=$("#Facility");t.empty();t.append('<option value="">- Select Facility Name -<\/option>');$.each(n,function(n,i){t.append('<option value="'+i.value+'">'+i.text+"<\/option>")});t.trigger("change")},failure:function(){ErrorMsg("Error","Something went wrong!Try again Later","")},error:function(){ErrorMsg("Error","Something went wrong!Try again Later","")}})}function pendingDataFilters(){let n={orgId:$("#Orglist").val(),facilityId:$("#Facility").val(),empId:$("#EmployeeList").val(),quarter:$("#QuarterList").val(),userName:$("#UserName").val()};showLoader();$.ajax({url:urls.LabourFileMoverurls.Pendingrecords,type:"POST",data:n,"async":!1,cache:!1,success:function(n){hideLoader();$("#KronosPendingList").html($(n).find("#KronosPendingList").html());$("#KronosPendingList").dataTable().fnDestroy();$("#KronosPendingList").dataTable({order:[],pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}},columnDefs:[{orderable:!1,targets:[3]}]})},failure:function(){hideLoader();ErrorMsg("Error","Something went wrong!Try again Later","")},error:function(){hideLoader();ErrorMsg("Error","Something went wrong!Try again Later","")}})}function getComparionPartial(n){showLoader();$.ajax({url:urls.LabourFileMoverurls.GetComparison,type:"POST",data:{rowId:n},"async":!1,cache:!1,success:function(n){hideLoader();$("#ComparisionpartialViewContainer").html(n);$("#ComparisonModal").modal("show")},failure:function(){hideLoader();ErrorMsg("Error","Something went wrong!Try again Later","")},error:function(){ErrorMsg("Error","Something went wrong!Try again Later","")}})}function updatecomp(){gatherSelectedData()}function gatherSelectedData(){var n=[],t=document.querySelectorAll(".checkbox-row.selected");t.forEach(function(t){if(t.checked){var i=t.closest("tr"),r={Id:i.cells[0].querySelector('input[type="hidden"]').value,Source:i.cells[1].innerText.trim(),EmployeeId:i.cells[2].innerText.trim(),facilityId:i.cells[3].querySelector('input[type="hidden"]').value,WorkDay:i.cells[4].innerText.trim(),JobTypeCode:i.cells[5].querySelector('input[type="hidden"]').value,PayTypeCode:i.cells[6].querySelector('input[type="hidden"]').value,Hours:i.cells[7].innerText.trim()};n.push(r)}});showLoader();$.ajax({url:urls.LabourFileMoverurls.UpdateComparison,type:"POST",data:{viewModel:n},"async":!1,cache:!1,success:function(n){hideLoader();n=="Success"?($("#ComparisonModal").modal("hide"),SuccessMsgWithReload("Success","Record Added successfully","success")):(hideLoader(),ErrorMsg("Error","Something went wrong!Try again Later",""))},failure:function(){hideLoader();ErrorMsg("Error","Something went wrong!Try again Later","")},error:function(){hideLoader();ErrorMsg("Error","Something went wrong!Try again Later","")}})}function sendToProcess(n,t){console.log("sendToProcess");showLoader();setTimeout(function(){retrieve(n,t)},1e3)}function retrieve(n,t){$.ajax({url:urls.LabourFileMoverurls.ProcessData,type:"POST",data:{id:n,OrgId:t},"async":!1,cache:!1,success:function(n){n=="Success"?(hideLoader(),SuccessMsgWithReload("Success","Record Added successfully","success")):n=="No Data Exists"?(hideLoader(),ErrorMsg("Error","No Data Exist!Try again Later","")):n=="No Facility"?(hideLoader(),ErrorMsg("Error","No Facility Exist!Try again Later","")):(hideLoader(),ErrorMsg("Error","Something went wrong!Try again Later",""))},failure:function(){hideLoader();ErrorMsg("Error","Something went wrong!Try again Later","")},error:function(){hideLoader();ErrorMsg("Error","Something went wrong!Try again Later","")}})}function togglePasswordVisibility(n){var t=n.parentElement.parentElement.previousElementSibling;t.type==="password"?(t.type="text",n.classList.remove("ri-eye-line"),n.classList.add("ri-eye-off-line")):(t.type="password",n.classList.remove("ri-eye-off-line"),n.classList.add("ri-eye-line"))}function ShowDeduction(){$("#hasDeduction").is(":checked")?($("#regularTimeValue").val(""),$("#overTimeValue").val(""),$("#Duduction").show(),$("#regularTime").show(),$("#overTime").show(),ClearDeductionSpan()):($("#Duduction").hide(),$("#DefaultTime").prop("checked",!1),ClearDeductionSpan())}function HideTimeInputs(){var n=$("#regularTimeValue").val(),t=$("#overTimeValue").val();$("#DefaultTime").is(":checked")?($("#regularTimeValue").val(30),$("#overTimeValue").val(60),$("#regularTime").hide(),$("#overTime").hide(),ClearDeductionSpan()):($("#regularTime").show(),$("#overTime").show(),$("#regularTimeValue").val(""),$("#overTimeValue").val(""),ClearDeductionSpan())}function ClearDeductionSpan(){$("#spHasDeduction").empty()}function checkSessionTimeout(){$.ajax({url:urls.Dashboard.CheckSessionTimeout,method:"GET",success:function(n){window.location.href=n?"/lockscreen":"/Home/Logout"},error:function(){}})}function deleteOrganization(n){let t=$('input[name="__RequestVerificationToken"]').val();ConfirmMsg("Organization Management","Are you sure want to delete this organization?","Continue",event,function(){$.ajax({url:urls.OrganizationManagement.DeleteOrganization,type:"POST",headers:{RequestVerificationToken:t},data:{organizationId:n},"async":!1,success:function(n){n=="success"?SuccessMsg("Success","Record Deleted successfully","success"):($("#OrganizationModal").modal("hide"),ErrorMsg("Failed",error,"error"));let t=$("#orgTable").DataTable();t.destroy();loadOrganizationData()},error:function(n,t,i){t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Oops","Unauthorized Access","error"):ErrorMsg("Failed",i,"error")}})})}function editOrganization(n){clearOrganizationData();showLoader();$.ajax({url:urls.OrganizationManagement.EditOrganization,type:"GET",data:{organizationId:n},success:function(n){hideLoader();$("#OrganizationModal").modal("show");draggableModel("#OrganizationModal");$("#organizationID").val(n.organizationID);$("#organizationName").val(n.organizationName);$("#organizationEmail").val(n.organizationEmail);$("#organizationPrimaryPhone").val(n.primaryPhone);$("#organizationSecondaryPhone").val(n.secondaryPhone);$("#organizationAddress1").val(n.address1);$("#organizationAddress2").val(n.address2);$("#organizationAddress").val(n.address);$("#organizationCity").val(n.city);$("#organizationState").val(n.state).trigger("change");$("#organizationZipCode").val(n.zipCode);let t=[];if(n.serviceDetails!=null){for(const i of n.serviceDetails){t.push(i.serviceType);document.getElementById("ServiceSelectionTypeDiv").style.display="block";let n=document.getElementById("bandwidthAccessChkBox");n.checked=!0;i.serviceType=="0"&&($("#organizationMasterAccountId").val(i.masterAccountId),$("#organizationMasterAccountName").val(i.masterAccountId),$("#organizationSubAccountId").val(i.subAccountId))}$("#ServiceSelectBox").val(t).trigger("change")}$("#OrganizationModalLabel").text("Update Organization");$("#btnSaveOrganization").hide();$("#btnUpdateOrganization").show()},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}})}function saveOrganization(){let r=$('input[name="__RequestVerificationToken"]').val(),t=$("#organizationMasterAccountId").val(),i=$("#organizationSubAccountId").val(),n=$("#ServiceSelectBox").val();n&&n.length!==0||(n="");let u={OrganizationName:$("#organizationName").val(),OrganizationEmail:$("#organizationEmail").val(),PrimaryPhone:$("#organizationPrimaryPhone").val(),SecondaryPhone:$("#organizationSecondaryPhone").val(),Address1:$("#organizationAddress1").val(),Address2:$("#organizationAddress2").val(),Country:"USA",City:$("#organizationCity").val(),State:$("#organizationState").val(),ZipCode:$("#organizationZipCode").val(),ServiceType:n,MasterAccountId:t===""||t===null?"-":t,SubAccountId:i===""||i===null?"-":i};showLoader();$.ajax({url:urls.OrganizationManagement.SaveOrganization,type:"POST",headers:{RequestVerificationToken:r},data:u,"async":!1,success:function(n){hideLoader();n=="success"?(SuccessMsg("Success","Record Added successfully","success"),$("#OrganizationModal").modal("hide")):n=="failed"&&(ErrorMsg("Failed","error","error"),$("#OrganizationModal").modal("hide"));let t=$("#orgTable").DataTable();t.destroy();loadOrganizationData();clearOrganizationData()},error:function(n,t,i){if(hideLoader(),t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)ErrorMsg("Failed","Unauthorized Access");else if(n.status==HTTP_STATUS_TOOMANYREQUESTS||t==HTTP_STATUS_TOOMANYREQUESTS){ErrorMsg("Failed","Too Many Requests, Please try after some time");$("#OrganizationModal").modal("hide");let n=$("#orgTable").DataTable();n.destroy();loadOrganizationData();clearOrganizationData()}else ErrorMsg("Failed",i,"error")}})}function updateOrganization(){let r=$('input[name="__RequestVerificationToken"]').val(),t=$("#organizationMasterAccountId").val(),i=$("#organizationSubAccountId").val(),n=$("#ServiceSelectBox").val();n&&n.length!==0||(n="");let u={OrganizationID:$("#organizationID").val(),OrganizationName:$("#organizationName").val(),OrganizationEmail:$("#organizationEmail").val(),PrimaryPhone:$("#organizationPrimaryPhone").val(),SecondaryPhone:$("#organizationSecondaryPhone").val(),Address1:$("#organizationAddress1").val(),Address2:$("#organizationAddress2").val(),Country:"USA",City:$("#organizationCity").val(),State:$("#organizationState").val(),ZipCode:$("#organizationZipCode").val(),ServiceType:n,MasterAccountId:t===""||t===null?"-":t,SubAccountId:i===""||i===null?"-":i};showLoader();$.ajax({url:urls.OrganizationManagement.UpdateOrganization,type:"POST",headers:{RequestVerificationToken:r},data:u,"async":!1,success:function(n){hideLoader();n=="success"?(SuccessMsg("Success","Record Updated successfully","success"),$("#OrganizationModal").modal("hide")):($("#OrganizationModal").modal("hide"),ErrorMsg("Failed",error,"error"));let t=$("#orgTable").DataTable();t.destroy();loadOrganizationData();clearOrganizationData()},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}})}function clearOrganizationData(){$("#organizationID").val("");$("#organizationName").val("");$("#organizationEmail").val("");$("#organizationPrimaryPhone").val("");$("#organizationSecondaryPhone").val("");$("#organizationAddress1").val("");$("#organizationAddress2").val("");$("#organizationCity").val("");$("#organizationState").val(null).trigger("change");$("#organizationZipCode").val("");let n=document.getElementById("bandwidthAccessChkBox");n.checked=!1;$("#ServiceSelectBox").val(null).trigger("change");document.getElementById("ServiceSelectionTypeDiv").style.display="none";$("#organizationMasterAccountId").val("");$("#organizationMasterAccountName").val("");$("#organizationSubAccountId").val("");$(".errormsg").text("");$("#OrganizationModalLabel").text("Add Organization");$("#btnSaveOrganization").show();$("#btnUpdateOrganization").hide()}function validateOrganizationForm(){let n=document.getElementById("bandwidthAccessChkBox");if(n.checked){let n=$("#ServiceSelectBox").val();return n.length==0?!($("#organizationName").val()==""||$("#organizationEmail").val()==""||$("#organizationPrimaryPhone").val()==""||$("#organizationAddress1").val()==""||$("#organizationCity").val()==""||$("#organizationState").val()==""||$("#organizationZipCode").val()==""||$(".errormsg").text()!=""||$("#ServiceSelectBox").val()==""):n[0]==0?!($("#organizationName").val()==""||$("#organizationEmail").val()==""||$("#organizationPrimaryPhone").val()==""||$("#organizationAddress1").val()==""||$("#organizationCity").val()==""||$("#organizationState").val()==""||$("#organizationZipCode").val()==""||$(".errormsg").text()!=""||$("#organizationSubAccountId").val()==""||$("#organizationMasterAccountId").val()==""||$("#organizationMasterAccountName").val()==""):!($("#organizationName").val()==""||$("#organizationEmail").val()==""||$("#organizationPrimaryPhone").val()==""||$("#organizationAddress1").val()==""||$("#organizationCity").val()==""||$("#organizationState").val()==""||$("#organizationZipCode").val()==""||$(".errormsg").text()!="")}return!($("#organizationName").val()==""||$("#organizationEmail").val()==""||$("#organizationPrimaryPhone").val()==""||$("#organizationAddress1").val()==""||$("#organizationCity").val()==""||$("#organizationState").val()==""||$("#organizationZipCode").val()==""||$(".errormsg").text()!="")}function loadOrganizationData(){let n=$("#ServiceSelectBoxFilter option:selected").text();n=="Select Service Type"&&(n=null);let t={serviceType:n};$("#orgTable").DataTable({ajax:{url:urls.OrganizationManagement.GetOrganizationsList,type:"POST",data:function(n){n.searchValue=$("#orgTable_filter input").val();n.start=n.start||0;n.length=n.length||10;n.draw=n.draw||1;n.sortColumn=n.columns[n.order[0].column].data;n.sortDirection=n.order[0].dir;n.serviceType=t.serviceType},error:function(n,t){(t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)&&ErrorMsg("Failed","Unauthorized Access")}},processing:!0,filter:!0,serverSide:!0,pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}},columns:[{data:"organizationName",name:"Organization Name"},{data:"organizationEmail",name:"Organization Email"},{data:"primaryPhone",name:"Primary Phone"},{data:"state",name:"State"},{data:"serviceTypes",name:"Service Types",orderable:!1},{data:null,orderable:!1,render:function(n,t,i){return"<a href='#' onclick=editOrganization('"+i.organizationID+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Edit' class='tooltip-black'><i class='ri-edit-2-line fs-6 pe-2 text-info'><\/i><\/a> <a href='#' onclick=deleteOrganization('"+i.organizationID+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Delete'><i class='ri-delete-bin-line fs-6 text-danger'><\/i><\/a>"}},{data:null,orderable:!1,render:function(n,t,i){return"<a href='#' onclick=viewFacilities('"+encodeURIComponent(i.organizationName)+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='View Facilities' style='color: black' ><i class='ri-eye-line fs-6 pe-2 text-success'><\/i><\/a> <a href='#' onclick=addNewFacility('"+i.organizationID+"','"+encodeURIComponent(i.organizationName)+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Add Facility' style='color: black' ><i class='ri-add-circle-line fs-6 pe-2 text-primary'><\/i><\/a >"}}]})}function viewFacilities(n){sessionStorage.setItem("organizationName",decodeURIComponent(n));window.location.href=urls.FacilityManagement.GetValues+"?isFromOrganization=true"}function addNewFacility(n,t){sessionStorage.setItem("organizationId",n);sessionStorage.setItem("organizationName",decodeURIComponent(t));window.location.href=urls.FacilityManagement.GetValues+"?buttonId=btnAddFacility&isFromOrganization=true"}function initSelect2ForOrganization(){$("#organizationState").select2({dropdownParent:$("#selectDiv"),placeholder:"Select State Name",width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#ServiceSelectBox").select2({dropdownParent:$("#ServiceTypeDiv"),placeholder:"Select Service Type",width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#ServiceSelectBoxFilter").select2({placeholder:"Select Service Type",width:"100%"})}function allowOnlyDigits(n){let t=n.key;/^\d$/.test(t)||t==="Backspace"||t==="Tab"||n.preventDefault()}function checkForUniqueEmail(){let i=$("#organizationEmail").val(),r=$("#organizationID").val(),n=$("#btnSaveOrganization"),t=$("#btnUpdateOrganization"),u=document.getElementById("organizationEmail");$.ajax({url:urls.OrganizationManagement.CheckForEmailId,type:"GET",data:{emailId:i,organizationId:r},success:function(i){i?($("#organizationEmail_Error").text("Organization Email Id already exists, please use another Email Id"),u.focus(),n.prop("disabled",!0),t.prop("disabled",!0)):($("#organizationEmail_Error").text(""),n.prop("disabled",!1),t.prop("disabled",!1))},error:function(n,t,i){ErrorMsg("Failed",i,"error")}})}function restrictInput(n){let t=n.key;/^[A-Za-z\-,''\s]+$/.test(t)||t==="Backspace"||n.preventDefault()}function restrictSpecialChars(n){let t=n.key;/^[a-zA-Z0-9\s\-,'.']+$/.test(t)||t==="Backspace"||n.preventDefault()}function isAlphaNumeric(n){let t=n.which?n.which:n.keyCode;return!!(t>47&&t<58||t>64&&t<91||t>96&&t<123||t===32)}function validateInputOnBlur(n){let r=n.value,u=document.getElementById("organizationName"),t=$("#btnSaveOrganization"),i=$("#btnUpdateOrganization"),f=/[a-zA-Z]/.test(r);f?($("#organizationName_Error").text(""),t.prop("disabled",!1),i.prop("disabled",!1)):($("#organizationName_Error").text("Input is invalid. It should contain at least one character"),u.focus(),t.prop("disabled",!0),i.prop("disabled",!0));checkForUniqueOrganizationName()}function checkForUniqueOrganizationName(){let i=$("#organizationName").val(),r=$("#organizationID").val(),n=$("#btnSaveOrganization"),t=$("#btnUpdateOrganization"),u=document.getElementById("organizationName");$.ajax({url:urls.OrganizationManagement.CheckForOrganizationName,type:"GET",data:{organizationName:i,organizationId:r},success:function(i){i?($("#organizationName_Error").text("Organization Name already exists, please use another Name"),u.focus(),n.prop("disabled",!0),t.prop("disabled",!0)):($("#organizationName_Error").text(""),n.prop("disabled",!1),t.prop("disabled",!1))},error:function(n,t,i){ErrorMsg("Failed",i,"error")}})}function getMasterAccountId(){let n=$("#ServiceSelectBox").val();n[0]==0?($("#ServiceSelectionDiv").show(),$.ajax({url:urls.OrganizationManagement.GetMasterAccountDetails,type:"GET",success:function(n){n!=""?($("#organizationMasterAccountName").val(n.accountName),$("#organizationMasterAccountId").val(n.accountId)):($("#organizationMasterAccountId").val(""),$("#organizationMasterAccountName").val(""))},error:function(n,t,i){ErrorMsg("Failed",i,"error")}})):(document.getElementById("ServiceSelectionDiv").style.display="none",$("#organizationMasterAccountId").val(""),$("#organizationMasterAccountName").val(""),$("#organizationSubAccountId").val(""))}function showServiceSelectionTypeDiv(){document.getElementById("ServiceSelectionTypeDiv").style.display="block"}function clearFilter(){$("#ServiceSelectBoxFilter").val(null).trigger("change")}function checkForSubAccoutId(){let r=$("#organizationID").val(),n=$("#organizationSubAccountId").val(),t=$("#btnSaveOrganization"),i=$("#btnUpdateOrganization"),u=document.getElementById("organizationSubAccountId");(n!==""||n!==null)&&$.ajax({url:urls.OrganizationManagement.CheckForSubAccountId,type:"GET",data:{organizationId:r,subAccountId:n},success:function(n){n?($("#organizationSubAccountId_Error").text("Sub Account Id already exists, please use another Sub Account Id"),u.focus(),t.prop("disabled",!0),i.prop("disabled",!0)):($("#organizationSubAccountId_Error").text(""),t.prop("disabled",!1),i.prop("disabled",!1))},error:function(n,t,i){ErrorMsg("Failed",i,"error")}})}function getQuaterList(){$("#QuarterList").html();var t=new Date,i=t.getMonth(),r=findQuarter(i+1),n="<option value='-1'>Select<\/option>";ListQuarters.forEach(function(t){n+=t.key==r?"<option value='"+t.key+"' selected>"+t.value+"<\/option>":"<option value='"+t.key+"'>"+t.value+"<\/option>"});$("#QuarterList").html(n)}function findQuarter(n){var t=0;switch(n){case 1:case 2:case 3:t=2;break;case 4:case 5:case 6:t=3;break;case 7:case 8:case 9:t=4;break;case 10:case 11:case 12:t=1}return t}function getMonthList(){$("#MonthList").html();var t="",n=$("#QuarterList").val();n=n-1;$.each(ListMonths[n],function(n,i){t+="<option value='"+n+"'>"+i+"<\/option>"});$("#MonthList").html(t)}function getYear(){var n=2020,r=new Date,i=r.getFullYear(),t;for($("#YearList").html(),t="",t+="<option value='0'>Select<\/option>";n<=i;)t+=i==n?"<option value='"+n+"' selected>"+n+"<\/option>":"<option value='"+n+"'>"+n+"<\/option>",n=n+1;$("#YearList").html(t)}function getAgencies(){if($("#FacilityId").val()!=""&&$("#FacilityId").val()!=null){var n=$("#FacilityId").val();$.ajax({url:"/Agency/GetAgenciesByFacility",type:"POST",data:{FacilityId:n},success:function(n){var t="<option value=''>Select Agency<\/option>";n.forEach(function(n,i){t+="<option value='"+i.id+"'>"+n.agencyName+"<\/option>"});$("#AgenciesId").html("");$("#AgenciesId").html(t)},error:function(){ErrorMsg("Warning","Failed")}})}}function openCencusModal(){$("#CensusModalLabel").html("");$("#CensusModalLabel").html("Add Census");$("#SaveCencus").css("display","block");$("#btnUpdateCencus").css("display","none");clearCencusData();getCencusMonth()}function getCencusMonth(){$("#CencusMonthList").html();var t="",n=$("#QuarterList").val();n=n-1;$.each(ListMonths[n],function(n,i){t+="<option value='"+n+"'>"+i+"<\/option>"});$("#CencusMonthList").html(t)}function saveFunction(){var n,t;let i=$("#CensunFormInReview"),r=i.find('input[name="__RequestVerificationToken"]').val();if(n=0,$("#CencusMonthList").val()=="0")return $("#CencusMonthListError").html("The "+$("#CencusMonthListError").attr("title")+" field is required!"),n=1,!1;if($("#CencusMonthListError").html(""),$(".CencusfieldRequired").each(function(){var i=$(this).val(),t=$(this).attr("id");if(i==0||i=="")return $("#"+t+"Error").html("The "+$("#"+t+"Error").attr("title")+" has invalid count!"),n=1,!1;$("#"+t+"Error").html("")}),n==1)return!1;t={CensusId:$("#CensusId").val().trim(),FacilityId:$("#FacilityId").val(),ReportQuarter:$("#QuarterList").val(),Month:$("#CencusMonthList").val(),Year:$("#YearList").val(),Medicare:$("#RMedicare").val(),Medicad:$("#RMedicad").val(),Other:$("#ROther").val()};showLoader();$.ajax({url:urls.Review.AddCencus,type:"POST",headers:{RequestVerificationToken:r},data:t,"async":!1,cache:!1,success:function(n){if(hideLoader(),n.statusCode==200){SuccessMsg("Success",n.message,"success");$("#CencusModal").modal("hide");clearCencusData();let t=$("#CencusTable").DataTable();t.destroy();loadCencusData()}else ErrorMsg("Failed",n.message)},error:function(n,t,i){if(hideLoader(),t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)ErrorMsg("Failed","Unauthorized Access");else if(n.status==HTTP_STATUS_TOOMANYREQUESTS||t==HTTP_STATUS_TOOMANYREQUESTS){ErrorMsg("Failed","Too Many Requests, Please try after some time");$("#CencusModal").modal("hide");clearCencusData();let n=$("#CencusTable").DataTable();n.destroy();loadCencusData()}else ErrorMsg("Failed",i,"error")}})}function clearCencusData(){$("#RMedicare").val("");$("#RMedicad").val("");$("#ROther").val("")}function deleteCencus(n){let t=$("#CensunFormInReview"),i=t.find('input[name="__RequestVerificationToken"]').val();ConfirmMsg("Cencus","Are you sure want to delete the cencus data?","Continue",event,function(){showLoader();$.ajax({url:urls.Review.DeleteCencus,type:"POST",headers:{RequestVerificationToken:i},data:{CencusId:n},"async":!1,Cache:!1,success:function(n){hideLoader();n.statusCode==200?(SuccessMsg("Success",n.message,"Deleted"),loadCencusData()):ErrorMsg("Failed",n.message)},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Error",i,"")}})})}function GetCencusChange(){LoadCencusData(1)}function loadStaffDeptData(){let n=$("#FacilityId").val(),t={FacilityId:n,Year:$("#YearList").val(),ReportQuarter:$("#QuarterList").val()},i=$("#StaffDeptTable").DataTable();i.destroy();$("#StaffDeptTable").DataTable({ajax:{url:urls.Review.GetStaffingData,type:"POST",data:t,error:function(n,t){(t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)&&ErrorMsg("Failed","Unauthorized Access")}},processing:!0,serverSide:!0,filter:!0,pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}},columns:[{data:"title",name:"Title"},{data:"totalHours",name:"Hours"},{data:"staffCount",name:"StaffCount"},{data:"exempt",name:"Exempt"},{data:"nonExempt",name:"nonExempt"},{data:"contractors",name:"contractors"},]})}function saveEmployeeFunction(){var i,n,t,r;let u=$("#EmployeeDataFormInReview");i=/^[a-zA-Z0-9]+$/;n=/^[a-zA-Z'. ]+$/;let f=u.find('input[name="__RequestVerificationToken"]').val();if(t=0,clearErrorMessage(),$(".fieldRequired").each(function(){var n=$(this).attr("id"),i=$("#"+n).val().trim();if(i=="")return $("#"+n+"Error").html("The "+$("#"+n+"Error").attr("title")+" field is required."),t=1,!1;$("#"+n+"Error").html("")}),t==1)return!1;if($("#Employee_Id").val().length>30)return $("#Employee_IdError").html("Employee Id must be smaller then 30 characters."),!1;if(!i.test($("#Employee_Id").val()))return $("#Employee_IdError").html("No spacial characters are allowed"),!1;if(!n.test($("#FirstName").val()))return $("#FirstNameError").html("First Name allows only alphabatic characters"),!1;if(!n.test($("#LastName").val()))return $("#LastNameError").html("Last Name allows only alphabatic characters"),!1;if($("#HireDate").val()!=""&&$("#TerminationDate").val()!=""&&$("#HireDate").val()>$("#TerminationDate").val())return $("#TerminationDateError").html("The Termination date should be greater than Hire date."),!1;if($("#TerminationDate").val()!=""&&$("#HireDate").val()=="")return $("#HireDateError").html("Select Hire date."),!1;if(clearErrorMessage(),$("#FacilityId").val()==undefined||$("#FacilityId").val()=="")return WarningMsg("Alert!","Please select Facility","Okay"),!1;r={Id:$("#EmployeeId").val(),EmployeeId:$("#Employee_Id").val().trim(),FirstName:$("#FirstName").val().trim(),LastName:$("#LastName").val().trim(),PayType:$("#PayType").val(),JobTitle:$("#JobTitle").val(),HireDate:$("#HireDate").val(),TerminationDate:$("#TerminationDate").val(),FacilityId:$("#FacilityId").val()};showLoader();$.ajax({url:urls.Review.SaveEmployeeeData,type:"POST",headers:{RequestVerificationToken:f},data:r,"async":!1,cache:!1,success:function(n){if(hideLoader(),n=="Success"){SuccessMsg("Success","Record saved successfully","success");$("#AddEmployeeModel").modal("hide");clearEmployeeData();let n=$("#EmployeeListTable").DataTable();n.destroy();loadEmployeeListData()}else if(n=="IdError")$("#Employee_IdError").html("No spacial characters are allowed");else if(n=="FirstNameError")$("#FirstNameError").html("First Name allows only alphabatic characters");else if(n=="LastNameError")$("#LastNameError").html("Last Name allows only alphabatic characters");else return WarningMsg("Alert!",n,"Okay"),!1},error:function(n,t){if(hideLoader(),t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)ErrorMsg("Failed","Unauthorized Access","");else if(n.status==HTTP_STATUS_TOOMANYREQUESTS||t==HTTP_STATUS_TOOMANYREQUESTS){ErrorMsg("Failed","Too Many Requests, Please try after some time","");$("#AddEmployeeModel").modal("hide");let n=$("#EmployeeListTable").DataTable();n.destroy();loadEmployeeListData()}else ErrorMsg("Error","Something went wrong!Try again Later","")}})}function clearErrorMessage(){$("#Employee_IdError").html("");$("#FirstNameError").html("");$("#LastNameError").html("");$("#HireDateError").html("");$("#TerminationDateError").html("")}function openEmployeeMoal(){$("#EmployeeId").val("");$("#EmployeeModalLabel").html("");$("#EmployeeModalLabel").html("Add Staff");$("#Employee_Id").prop("disabled",!1);$("#SaveEmployee").css("display","block");$("#UpdateEmployee").css("display","none");clearEmployeeData()}function clearEmployeeData(){$("#EmployeeId").val("");$("#Employee_Id").val("");$("#FirstName").val("");$("#LastName").val("");$("#HireDate").val("");$("#TerminationDate").val("");$("#Employee_IdError").html("");$("#FirstNameError").html("");$("#LastNameError").html("");$("#HireDateError").html("");$("#TerminationDateError").html("");$("#PayTypeError").html("");$("#JobTitleError").html("")}function loadCencusData(){var n={FacilityID:$("#FacilityId").val(),Year:$("#YearList").val(),ReportQuarter:$("#QuarterList").val()};let t={cencusViewRequest:n},i=$("#CencusTable").DataTable();i.destroy();$("#CencusTable").DataTable({ajax:{url:urls.Review.GetCensus,type:"POST",data:t,error:function(n,t){(t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)&&ErrorMsg("Failed","Unauthorized Access")}},processing:!0,serverSide:!0,filter:!0,searching:!1,pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}},columns:[{data:"facilityName",name:"FacilityName"},{data:"year",name:"Year"},{data:"month",name:"Month"},{data:"medicare",name:"Medicare"},{data:"medicad",name:"Medicad"},{data:"other",name:"Other"},{data:null,orderable:!1,render:function(n,t,i){return"<a href='#' onclick=editCencus('"+i.censusId+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Edit'><i class='ri-edit-2-line fs-6 pe-2 text-info'><\/i><\/a> <a href='#' onclick=deleteCencus('"+i.censusId+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Delete'><i class='ri-delete-bin-line fs-6 text-danger'><\/i><\/a>"}}]})}function initSelect2ForReview(){$("#PayType").select2({placeholder:"Select Pay Type",dropdownParent:$("#selectPayTypeDivState"),width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#JobTitle").select2({placeholder:"Select Job Title",dropdownParent:$("#selectJobTitleDivState"),width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")})}function editCencus(n){let t={CencusId:n};clearCencusData();showLoader();$.ajax({url:urls.Review.EditCencus,type:"POST",data:t,success:function(n){hideLoader();getCencusMonth();$("#RMedicad").val(n.medicad);$("#ROther").val(n.other);$("#RMedicare").val(n.medicare);$("#CencusMonthList").val(n.month);$("#CensusId").val(n.censusId);$("#SaveCencus").css("display","none");$("#btnUpdateCencus").css("display","block");$("#CensusModalLabel").html("");$("#CensusModalLabel").html("Update Census");$("#CencusModal").modal("show");draggableModel("#CencusModal")},error:function(n,t){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Alert!","Failed to load")}})}function loadEmployeeListData(){let n=$("#FacilityId").val(),t={facilityId:n,Year:$("#YearList").val(),ReportQuarter:$("#QuarterList").val(),Month:$("#MonthList").val()},i=$("#EmployeeListTable").DataTable();i.destroy();$("#EmployeeListTable").DataTable({ajax:{url:urls.Review.EmployeeData,type:"POST",data:t,error:function(n,t){(t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)&&ErrorMsg("Failed","Unauthorized Access")}},processing:!0,serverSide:!0,filter:!0,order:[[1,"asc"]],scrollCollapse:!0,fixedHeader:!0,pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}},columns:[{data:null,orderable:!1,render:function(n,t,i){return"<a href='#' onclick=openEmployeeCalender('"+i.employeeId+"','"+i.facilityId+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Edit'><i class='ri-calendar-line fs-6 pe-2 text-info'><\/i><\/a>"}},{data:"employeeId",name:"Id"},{data:"employeeFullName",name:"Name"},{data:"hireDate",name:"Hire Date"},{data:"terminationDate",name:"Termination Date"},{data:"payType",name:"Pay Type"},{data:"jobTitle",name:"Job Title"},{data:null,orderable:!1,render:function(n,t,i){return"<div class='text-center'><a href='#' onclick=editEmployee('"+i.id+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Edit'><i class='ri-edit-2-line fs-6 pe-2 text-info'><\/i><\/a><\/div>"}}]})}function editEmployee(n){clearEmployeeData();let t={Id:n};showLoader();$.ajax({url:urls.Review.EditEmployeeData,type:"POST",data:t,success:function(n){hideLoader();$("#EmployeeModalLabel").html("");$("#EmployeeModalLabel").html("Edit Staff");let t=n.hireDate=="0001-01-01T00:00:00"?n.hireDate:moment(n.hireDate).format("YYYY-MM-DD"),i=n.terminationDate=="0001-01-01T00:00:00"?n.terminationDate:moment(n.terminationDate).format("YYYY-MM-DD");$("#EmployeeId").val(n.id);$("#Employee_Id").val(n.employeeId);$("#Employee_Id").prop("disabled",!0);$("#FirstName").val(n.firstName);$("#LastName").val(n.lastName);$("#HireDate").val(t);$("#TerminationDate").val(i);$("#PayType").val(n.payTypeCode).trigger("change");$("#JobTitle").val(n.jobTitleCode).trigger("change");$("#SaveEmployee").css("display","none");$("#UpdateEmployee").css("display","block");$("#AddEmployeeModel").modal("show");draggableModel("#AddEmployeeModel")},error:function(n,t){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Alert!","Failed to load")}})}function FilterChange(){checkIfValidated();checkIfApproved();loadEmployeeListData();loadStaffDeptData();loadCencusData();$("#dataTableContainer").html("");$("#rowCountId").html("");$("#pageCountId").html("");getAllFileNameByFacility()}function openEmployeeCalender(n,t){events=[];let e=getEmployeeName(n),i=getEmpDetials(n,t),r=moment(new Date).format("YYYY-MM-01"),u=moment(new Date).format("YYYY-MM-dd");var f={EmployeeId:n,FacilityId:$("#FacilityId").val(),ReportQuarter:$("#QuarterList").val(),Year:$("#YearList").val(),Month:$("#MonthList").val(),StartDate:moment(r).format("YYYY-MM-DD"),EndDate:moment(u).format("YYYY-MM-DD")};$.ajax({url:urls.Review.GetEmployeeTimesheet,type:"POST",data:f,success:function(t){$.each(t,function(n,t){events.push({eventID:t.timesheetId,title:t.totalHours,description:t.employeeId,start:moment(t.workday),end:t.end!=null?moment(t.workday):null,color:t.color,editable:t.editable,isButtonEditable:t.isButtonEditable})});$("#ReviewModalLabel").html("Working Details");$("#ReviewModalEmpDetails").html("<strong>Employee Id : <\/strong>"+i.Id);$("#ReviewModalEmpDetails1").html("<strong>Employee Name : <\/strong> "+i.FullName);$("#ReviewModalEmpDetails2").html("<strong>JobTitile : <\/strong>"+i.JobTitle);$("#ReviewModalEmpDetails3").html("<strong>PayType : <\/strong>"+i.PayTypeName);$("#EmployeeIdWorking").val(n);$("#EmployeeDataWorkingHoursCalenderModal").modal("show");draggableModel("#EmployeeDataWorkingHoursCalenderModal");GenerateEmployeeCalender(events)},error:function(){ErrorMsg("Alert!","Failed to load")}})}function getEmpDetials(n,t){let i={Id:"",FullName:"",PayTypeName:"",JobTitle:""};return $.ajax({url:urls.Review.GetEmpDetials,type:"GET",data:{EmployeeId:n,FacilityId:t},"async":!1,success:function(n){n?(i.Id=n.result.id,i.FullName=n.result.fullName,i.PayTypeName=n.result.payTypeName,i.JobTitle=n.result.jobTitle):i=""},error:function(){ErrorMsg("Error","Failed to Get Employee Name","")}}),i}function GenerateEmployeeCalender(n){$("#EmployeeWorkingHoursCalender").fullCalendar("destroy");$("#EmployeeWorkingHoursCalender").fullCalendar({contentHeight:350,defaultDate:new Date,timeFormat:"h(:mm)a",displayEventTime:!1,header:{left:"prev,next today",center:"title",right:"month,basicWeek,basicDay"},eventLimit:!0,eventColor:"#378006",events:n,buttonText:{today:"Today",month:"Month",week:"Week",day:"Day"},eventClick:function(n){var t,i,r;let u=new Date(n.start),f=u.getMonth(),e=findQuarter(f+1);selectedEvent=n;t="";$.each(GetPayCodeList,function(n,i){t+="<option value='"+i.payTypeCode+"'>"+i.payTypeDescription+"<\/option>"});$("#EmpWorkingPayType").html(t);i="";$.each(GetJobTitleList,function(n,t){i+="<option value='"+t.id+"'>"+t.title+"<\/option>"});$("#EmpWorkingJobTitle").html(i);r={TimesheetId:n.eventID,EmployeeId:$("#EmployeeIdWorking").val(),FacilityId:$("#FacilityId").val(),ReportQuarter:$("#QuarterList").val(),Month:$("#MonthList").val(),Year:$("#YearList").val(),Workday:n.start.format("MM/DD/YYYY")};$.ajax({url:urls.Review.GetEmployeeData,type:"POST",data:r,success:function(t){console.log("GenerateEmployeeCalender ~ "+JSON.stringify(t));$("#EmpTimesheetId").val("");$("#EmpWorkingPayType").val(t.payTypeCode).trigger("change");$("#EmpWorkingJobTitle").val(t.jobTitleCode).trigger("change");$("#EmpTimesheetId").val(n.eventID);$("#EmpHoursWorked").val(n.title);$("#EmpWorkDate").val(n.start.format("MM/DD/YYYY"));$("#AddWorkingHoursLabel").html("Update working details");n.isButtonEditable?($("#btnSaveEmployeeWorkingHours").removeClass("hide"),$("#btnDeleteEmployeeWorkingHours").removeClass("hide")):($("#btnSaveEmployeeWorkingHours").addClass("hide"),$("#btnDeleteEmployeeWorkingHours").addClass("hide"));$("#EmpHoursWorkedError").html("");$("#EmpAddUpdateWorkingHours").modal("show");draggableModel("#EmpAddUpdateWorkingHours")},error:function(){ErrorMsg("Alert!","Failed to load")}})},selectable:!0,select:function(n,t,i){selectedEvent={eventID:0,title:"",description:"",start:n,end:t,allDay:!1,color:""};let r=new Date(n),u=new Date(t.subtract(1,"days")),f=r.getMonth(),s=findQuarter(f+1),e=new Date;if(i&&i.shiftKey){let n=moment(new Date(r)).format("YYYY-MM-DD");AddSelectedDates.push(n);let t=[];addSelectedColorDates.find(t=>t.start==n)||(t.push({start:n,backgroundColor:"yellow"}),addSelectedColorDates.push({start:n,backgroundColor:"yellow"}));$("#EmployeeWorkingHoursCalender").fullCalendar("removeEvents",t);$("#EmployeeWorkingHoursCalender").fullCalendar("addEventSource",t)}if(n<e)if(r.toDateString()!=u.toDateString()||i.shiftKey)r.toDateString()!=u.toDateString()&&(addMultipleDaysArray(r,u),$("#EmployeeWorkingHoursCalender").fullCalendar("removeEvents",addSelectedColorDates),$("#EmployeeWorkingHoursCalender").fullCalendar("addEventSource",addSelectedColorDates));else{var o={FacilityId:$("#FacilityId").val(),EmployeeId:$("#EmployeeIdWorking").val()};$.ajax({url:"/PBJSnap/EmployeeMaster/GetEmployeeById",type:"POST",data:o,success:function(t){hideLoader();$("#EmpHoursWorked").val("");$("#EmpTimesheetId").val("");$("#EmpWorkDate").val(n.format("MM/DD/YYYY"));$("#AddWorkingHoursLabel").html("Add working details");$("#EmpHoursWorkedError").html("");$("#EmpWorkingPayType").val(t.payTypeCode);$("#EmpWorkingPayType").trigger("change");$("#EmpWorkingJobTitle").val(t.jobTitleCode);$("#EmpWorkingJobTitle").trigger("change");$("#btnSaveEmployeeWorkingHours").removeClass("hide");$("#btnDeleteEmployeeWorkingHours").addClass("hide");$("#EmpAddUpdateWorkingHours").modal("show");draggableModel("#EmpAddUpdateWorkingHours");$("#EmployeeWorkingHoursCalender").fullCalendar("unselect")},error:function(){hideLoader();ErrorMsg("Alert!","Failed to fetch")}})}else ErrorMsg("Warning!","You have selected the future date!")},editable:!0,eventDrop:function(){},viewRender:function(t){n=[];var i={EmployeeId:$("#EmployeeIdWorking").val(),FacilityId:$("#FacilityId").val(),ReportQuarter:$("#QuarterList").val(),Year:$("#YearList").val(),Month:$("#MonthList").val(),StartDate:moment(t.start).format("YYYY-MM-DD"),EndDate:moment(t.end).format("YYYY-MM-DD")};$.ajax({url:urls.Review.GetEmployeeTimesheet,type:"POST",data:i,success:function(t){$.each(t,function(t,i){n.push({eventID:i.timesheetId,title:i.totalHours,description:i.employeeId,start:moment(i.workday),end:i.end!=null?moment(i.workday):null,color:i.color,editable:i.editable,isButtonEditable:i.isButtonEditable})});$("#EmployeeWorkingHoursCalender").fullCalendar("removeEvents");$("#EmployeeWorkingHoursCalender").fullCalendar("addEventSource",n);$("#EmployeeWorkingHoursCalender").fullCalendar("addEventSource",addSelectedColorDates)},error:function(){ErrorMsg("Alert!","Failed to load")}})}})}function getPayTypeList(){$.ajax({type:"GET",url:urls.PayTypeJobTitle.GetPayCode,success:function(n){$("#EmpWorkingPayType").html();GetPayCodeList=n;var t="";$.each(n,function(n,i){t+="<option value='"+i.payTypeCode+"'>"+i.payTypeDescription+"<\/option>"});$("#EmpWorkingPayType").html(t)},error:function(){ErrorMsg("Alert!","Failed to load")}})}function getJobTitleList(){$.ajax({type:"GET",url:urls.PayTypeJobTitle.GetJobTitle,success:function(n){$("#EmpWorkingJobTitle").html();GetJobTitleList=n;var t="";$.each(n,function(n,i){t+="<option value='"+i.id+"'>"+i.title+"<\/option>"});$("#EmpWorkingJobTitle").html(t)},error:function(){ErrorMsg("Alert!","Failed to load")}})}function SaveEmployeeWorkingHours(){if($("#EmpHoursWorked").val().trim()=="")return $("#EmpHoursWorkedError").html("Please enter work hours!"),!1;let n=parseInt($("#EmpHoursWorked").val().trim());if(n<=0||n>24)return $("#EmpHoursWorkedError").html("Please enter valid work hours!"),!1;var t={TimesheetId:$("#EmpTimesheetId").val(),EmployeeId:$("#EmployeeIdWorking").val(),FacilityId:$("#FacilityId").val(),ReportQuarter:$("#QuarterList").val(),Month:$("#MonthList").val(),Year:$("#YearList").val(),PayCode:$("#EmpWorkingPayType").val(),JobTitle:$("#EmpWorkingJobTitle").val(),UploadType:$("#UploadType").val(),TotalHours:$("#EmpHoursWorked").val(),WorkDate:$("#EmpWorkDate").val()};showLoader();$.ajax({url:urls.Review.SaveEmployeeWorkingDetails,type:"POST",data:t,success:function(n){if(hideLoader(),n=="24hours")return ErrorMsg("Alert!","The total hours is more than 24 hours"),!1;SuccessMsg("Success","Record saved successfully","success");$("#EmpAddUpdateWorkingHours").modal("hide");employeeWorkingDataClear();openEmployeeCalender($("#EmployeeIdWorking").val());loadStaffDeptData()},error:function(){hideLoader();ErrorMsg("Alert!","Failed to load")}})}function employeeWorkingDataClear(){$("#EmpTimesheetId").val("");$("#EmpHoursWorked").val("")}function loadEmployeeCalenderData(){}function multipleAddUpdateWorking(){let t=AddSelectedDates.length;if(t==0)return $("#SelectDateIdError").html("Please select the date."),!1;if($("#Emp_HoursWorked").val().trim()==0)return $("#Emp_HoursWorkedError").html("Please enter the working hours."),!1;let n=parseInt($("#Emp_HoursWorked").val().trim());if(n<=0||n>24)return $("#Emp_HoursWorkedError").html("Please enter valid work hours!"),!1;var i={EmployeeId:$("#EmployeeIdWorking").val(),FacilityId:$("#FacilityId").val(),Year:$("#YearList").val(),ReportQuarter:$("#QuarterList").val(),Month:$("#MonthList").val(),MultipleDates:AddSelectedDates,PayCode:$("#Emp_WorkingPayType").val(),JobTitle:$("#Emp_WorkingJobTitle").val(),WorkingHours:$("#Emp_HoursWorked").val().trim()};showLoader();$.ajax({url:urls.Review.EmployeeMultiDatesSave,type:"POST",data:i,success:function(n){hideLoader();n!=""?WarningMsg("Alert!","These many dates "+n+" are having total hours greater then 24 ","Okay"):SuccessMsg("Success","Record saved successfully","success");addSelectedColorDates=[];AddSelectedDates=[];$("#AddUpdateMultipleEmpWorking").modal("hide");openEmployeeCalender($("#EmployeeIdWorking").val());loadStaffDeptData()},error:function(){hideLoader();ErrorMsg("Alert!","Failed to saved")}})}function OpenMultipleDateRangeModal(){$("#Emp_WorkingPayType").html("");$("#Emp_WorkingJobTitle").html("");var n="",t="",i={FacilityId:$("#FacilityId").val(),EmployeeId:$("#EmployeeIdWorking").val()};$.ajax({url:"/PBJSnap/EmployeeMaster/GetEmployeeById",type:"POST",data:i,success:function(i){hideLoader();$.each(GetPayCodeList,function(t,i){n+="<option value='"+i.payTypeCode+"'>"+i.payTypeDescription+"<\/option>"});$.each(GetJobTitleList,function(n,i){t+="<option value='"+i.id+"'>"+i.title+"<\/option>"});$("#Emp_WorkingPayType").html(n);$("#Emp_WorkingPayType").val(i.payTypeCode);$("#Emp_WorkingPayType").trigger("change");$("#Emp_WorkingJobTitle").html(t);$("#Emp_WorkingJobTitle").val(i.jobTitleCode);$("#Emp_WorkingJobTitle").trigger("change");$("#Emp_HoursWorked").val("");AddSelectedDates.length==0&&(AddSelectedDates=[]);arrDateList();$("#AddUpdateMultipleEmpWorking").modal("show");draggableModel("#AddUpdateMultipleEmpWorking")},complete:{},error:function(){hideLoader();ErrorMsg("Alert!","Failed to fetch")}})}function AddDatesFunction(){var t=0,n=$("#SelectDateId").val();let i=moment(new Date).format("YYYY-MM-DD");n!=""?($.each(AddSelectedDates,function(i,r){r==n&&t++}),t==0?n<i?(AddSelectedDates.push(n),arrDateList()):$("#SelectDateIdError").html("You have selected the future date."):$("#SelectDateIdError").html("You have already selected the date.")):$("#SelectDateIdError").html("Please select the date.")}function removeDates(n){AddSelectedDates.splice($.inArray(n,AddSelectedDates),1);let t=addSelectedColorDates.findIndex(t=>t.start===n);addSelectedColorDates.splice(t,1);arrDateList();GenerateEmployeeCalender()}function arrDateList(){$("#SelectDateIdError").html("");$("#divDateList").html("");AddSelectedDates=AddSelectedDates.filter((n,t,i)=>i.indexOf(n)===t);$.each(AddSelectedDates,function(n,t){$("#divDateList").append("<span class='mb-0 mt-1 me-2 badge font-medium bg-light-primary text-primary' onclick='removeDates((\""+t+"\"))' >"+t+"<\/span>")})}function switchToEmpConsecutiveDate(){AddSelectedDates=[];$("#SwitchEmpConsecutiveDateToBasicDate").is(":checked")?($("#SwitchEmpConsecutiveDateToBasicDate").val(1),$("#EmpWorkDateRangeDiv").css("display","block"),$("#EmpWorkDateNonConsecutiveDiv").css("display","none")):($("#SwitchEmpConsecutiveDateToBasicDate").val(0),$("#EmpWorkDateRangeDiv").css("display","none"),$("#EmpWorkDateNonConsecutiveDiv").css("display","block"))}function OpenMultipleDateRangeDeleteModal(){DeleteSelectedDates=[];arrDeleteDateList();$("#DeleteMultipleEmpWorking").modal("show");draggableModel("#DeleteMultipleEmpWorking")}function DeleteDatesFunction(){var t=0,n=$("#DeleteSelectDateId").val();n!=""?($.each(DeleteSelectedDates,function(i,r){r==n&&t++}),t==0?(DeleteSelectedDates.push(n),arrDeleteDateList()):$("#DeleteSelectDateIdError").html("You have already selected the date.")):$("#DeleteSelectDateIdError").html("Please select the date.")}function arrDeleteDateList(){$("#DeleteSelectDateIdError").html("");$("#divDeleteDateList").html("");$.each(DeleteSelectedDates,function(n,t){$("#divDeleteDateList").append("<span class='mb-0 mt-1 me-2 badge font-medium bg-light-primary text-primary' onclick='removeDeleteDates((\""+t+"\"))' >"+t+"<\/span>")})}function removeDeleteDates(n){DeleteSelectedDates.splice($.inArray(n,DeleteSelectedDates),1);arrDeleteDateList()}function deleteMultipleWorking(){if(DeleteSelectedDates.length==0)return $("#DeleteSelectDateIdError").html("Please select and add the date."),!1;ConfirmMsg("Delete working hours","Are you sure want to delete the data?","Delete",event,function(){var n={EmployeeId:$("#EmployeeIdWorking").val(),FacilityId:$("#FacilityId").val(),Year:$("#YearList").val(),ReportQuarter:$("#QuarterList").val(),Month:$("#MonthList").val(),MultipleDates:DeleteSelectedDates};showLoader();$.ajax({url:urls.Review.DeleteMultipleWorkingHoursDates,type:"POST",data:n,success:function(){hideLoader();SuccessMsg("Success","Record deleted successfully","success");DeleteSelectedDates=[];$("#DeleteMultipleEmpWorking").modal("hide");openEmployeeCalender($("#EmployeeIdWorking").val());loadStaffDeptData()},error:function(){hideLoader();ErrorMsg("Alert!","Failed to delete the data!")}})})}function switchToDeleteEmpConsecutiveDate(){DeleteSelectedDates=[];$("#SwitchDeleteEmpConsecutiveDateToBasicDate").is(":checked")?($("#SwitchDeleteEmpConsecutiveDateToBasicDate").val(1),$("#EmpDeleteWorkDateRangeDiv").css("display","block"),$("#EmpDeleteWorkDateNonConsecutiveDiv").css("display","none")):($("#SwitchDeleteEmpConsecutiveDateToBasicDate").val(0),$("#EmpDeleteWorkDateRangeDiv").css("display","none"),$("#EmpDeleteWorkDateNonConsecutiveDiv").css("display","block"))}function approveData(){ConfirmMsg("Approve","Are you sure want to approve the data?","Approve",event,function(){var n={FacilityId:$("#FacilityId").val(),Year:$("#YearList").val(),ReportQuarter:$("#QuarterList").val(),Month:$("#MonthList").val(),IsApproved:!1};showLoader();$.ajax({type:"POST",url:urls.Review.ApproveUploadData,data:n,success:function(n){hideLoader();n.success?n.message=="NotValidated"?ConfirmMsg("Warning","There are pending data need to validate? Do you want to continue to approve the data.","Approve",event,function(){reApproveData(!0)}):SuccessMsg("Success",n.message,"success"):ErrorMsg("Alert!",n.message)},error:function(){hideLoader();ErrorMsg("Alert!","Failed to approve the data!")}})})}function reApproveData(n){var t={FacilityId:$("#FacilityId").val(),Year:$("#YearList").val(),ReportQuarter:$("#QuarterList").val(),Month:$("#MonthList").val(),IsApproved:n};showLoader();$.ajax({type:"POST",url:urls.Review.ApproveUploadData,data:t,success:function(n){hideLoader();n.success?SuccessMsg("Success",n.message,"success"):ErrorMsg("Alert!",n.message)},error:function(){hideLoader();ErrorMsg("Alert!","Failed to approve the data!")}})}function openNurseGenerateCalenderModalPopup(n){calenderEvents=[];TempJobTitle=n;let i=moment(new Date).format("YYYY-MM-01"),r=moment(new Date).format("YYYY-MM-dd");var t={FacilityId:$("#FacilityId").val(),Year:$("#YearList").val(),ReportQuarter:$("#QuarterList").val(),Month:$("#MonthList").val(),JobTitle:n};$.ajax({type:"POST",url:urls.Review.GetMissingNursesDates,data:t,success:function(t){$.each(t,function(n,t){calenderEvents.push({eventID:"",title:moment(t.missingDate).format("MM-DD-YYYY"),description:"",start:moment(t.missingDate),end:t.end!=null?moment(t.missingDate):null,color:"Red",editable:t.isEditable})});$("#ReviewModal").modal("show");draggableModel("#ReviewModal");GenerateNurseCalender(calenderEvents,n)},error:function(){ErrorMsg("Alert!","Failed to load!")}})}function GenerateNurseCalender(n,t){$("#calender").fullCalendar("destroy");$("#calender").fullCalendar({contentHeight:350,defaultDate:new Date,timeFormat:"h(:mm)a",displayEventTime:!1,header:{left:"prev,next today",center:"title",right:"month,basicWeek,basicDay"},eventLimit:!0,eventColor:"#378006",events:n,buttonText:{today:"Today",month:"Month",week:"Week",day:"Day"},eventClick:function(n){let i=new Date;n.start<i?(selectedEvent=n,$("#NurseEmployeeId").val(""),$("#NurseWorkDay").val(n.start.format("YYYY-MM-DD")),openNurseCalenderPopup(t)):ErrorMsg("Warning!","You have selected the future date!")},selectable:!0,select:function(){},editable:!0,eventDrop:function(n){var t={EventID:n.eventID,Subject:n.title,Start:n.start.format("DD/MM/YYYY HH:mm A"),End:n.end!=null?n.end.format("DD/MM/YYYY HH:mm A"):null,Description:n.description,ThemeColor:n.color,IsFullDay:n.allDay}},viewRender:function(i){n=[];var r={FacilityId:$("#FacilityId").val(),Year:$("#YearList").val(),ReportQuarter:$("#QuarterList").val(),Month:$("#MonthList").val(),JobTitle:t,StartDate:moment(i.start).format("YYYY-MM-DD"),EndDate:moment(i.end).format("YYYY-MM-DD")};$.ajax({url:urls.Review.GetMissingNursesDates,type:"POST",data:r,success:function(t){$.each(t,function(t,i){n.push({eventID:"",title:moment(i.missingDate).format("MM-DD-YYYY"),description:"",start:moment(i.missingDate),end:i.end!=null?moment(i.missingDate):null,color:"Red",editable:i.isEditable})});$("#calender").fullCalendar("removeEvents");$("#calender").fullCalendar("addEventSource",n)},error:function(){ErrorMsg("Alert!","Failed to load")}})}})}function SaveNurseMissingWorkingHoursDates(){if($("#NurseEmployeeId").val().trim()==0)return $("#NurseEmployeeIdError").html("Please enter Employee Id!"),!1;if(AddNurseSelectedDates.length==0)return $("#NurseWorkDayError").html("Please select the date!"),!1;if($("#NurseHoursWorked").val().trim()=="")return $("#NurseHoursWorkedError").html("Please enter work hours!"),!1;let n=parseInt($("#NurseHoursWorked").val().trim());if(n<=0||n>24)return $("#NurseHoursWorkedError").html("Please enter valid work hours!"),!1;var t={EmployeeId:$("#NurseEmployeeId").val(),FacilityId:$("#FacilityId").val(),ReportQuarter:$("#QuarterList").val(),Month:$("#MonthList").val(),Year:$("#YearList").val(),PayCode:$("#NurseWorkingPayType").val(),JobTitle:$("#NurseWorkingJobTitle").val(),UploadType:$("#UploadType").val(),TotalHours:$("#NurseHoursWorked").val(),WorkDateList:AddNurseSelectedDates};showLoader();$.ajax({url:urls.Review.AddMissingNurseHoursData,type:"POST",data:t,success:function(){hideLoader();SuccessMsg("Success","Record saved successfully","success");$("#AddNurseWorkingHours").modal("hide");openNurseGenerateCalenderModalPopup(TempJobTitle);loadStaffDeptData()},error:function(n){if(hideLoader(),n.responseText=="EmployeeNotFound")return ErrorMsg("Error","Invalid Employee Id",""),!1;ErrorMsg("Error",Failed,"")}})}function openNurseCalenderPopup(n){$("#NurseWorkingPayType").html("");$("#NurseWorkingJobTitle").html("");var t="",i="";$.each(GetPayCodeList,function(n,i){t+="<option value='"+i.payTypeCode+"'>"+i.payTypeDescription+"<\/option>"});$.each(GetJobTitleList,function(n,t){i+="<option value='"+t.id+"'>"+t.title+"<\/option>"});AddNurseSelectedDates=[];$("#NurseWorkingPayType").html(t);$("#NurseWorkingJobTitle").html(i);$("#NurseWorkingJobTitle").val(n);$("#NurseWorkingJobTitle").trigger("change");$("#NurseHoursWorked").val("");$("#NurseEmployeeIdError").html("");$("#NurseDateRangeError").html("");$("#NurseWorkDayError").html("");$("#NurseHoursWorkedError").html("");$("#NurseWorkingPayTypeError").html("");$("#NurseWorkingJobTitleError").html("");$("#NurseEmployeeId").val(null).trigger("change");$("#AddNurseWorkingHours").modal("show")}function SwitchToConsecutiveDate(){AddNurseSelectedDates=[];$("#SwitchNurseConsecutiveDateToBasicDate").is(":checked")?($("#SwitchNurseConsecutiveDateToBasicDate").val(1),$("#NurseDateRangeDiv").css("display","block"),$("#NurseWorkDayDiv").css("display","none")):($("#SwitchNurseConsecutiveDateToBasicDate").val(0),$("#NurseDateRangeDiv").css("display","none"),$("#NurseWorkDayDiv").css("display","block"));arrNurseDateList()}function addNurseNonConsecutiveDatesFunction(){var t=0,n=$("#NurseWorkDay").val();let i=moment(new Date).format("YYYY-MM-DD");n!=""?($.each(AddNurseSelectedDates,function(i,r){r==n&&t++}),t==0?n<i?(AddNurseSelectedDates.push(n),arrNurseDateList()):$("#NurseWorkDayError").html("You have already selected the future date."):$("#NurseWorkDayError").html("You have already selected the date.")):$("#NurseWorkDayError").html("Please select the date.")}function removeNurseNonConsectiveDate(n){AddNurseSelectedDates.splice($.inArray(n,AddNurseSelectedDates),1);arrNurseDateList()}function arrNurseDateList(){$("#NurseWorkDayError").html("");$("#divNurseDateList").html("");$.each(AddNurseSelectedDates,function(n,t){$("#divNurseDateList").append("<span class='mb-0 mt-1 me-2 badge font-medium bg-light-primary text-primary' onclick='removeNurseNonConsectiveDate((\""+t+"\"))' >"+t+"<\/span>")})}function DownloadCencusCSV(){let t=new Date,n="Cencus_"+$("#FacilityId :selected").text()+moment(t).format("YYYYMMDDHHMMSS");var i={FacilityId:$("#FacilityId").val(),Year:$("#YearList").val(),ReportQuarter:$("#QuarterList").val(),FileName:n};showLoader();$.ajax({url:urls.Review.ExportCensusToCsv,type:"GET",data:i,xhrFields:{responseType:"blob"},success:function(t){hideLoader();var r=window.URL.createObjectURL(t),i=document.createElement("a");i.href=r;i.download=n+".csv";i.click();window.URL.revokeObjectURL(r)}})}function DownloadStaffingDeptCSV(){let t=new Date,n="StaffingDepartmentDetails_"+$("#FacilityId :selected").text()+moment(t).format("YYYYMMDDHHMMSS");var i={FacilityId:$("#FacilityId").val(),Year:$("#YearList").val(),ReportQuarter:$("#QuarterList").val(),FileName:n};showLoader();$.ajax({url:urls.Review.ExportStaffingDeptToCsv,type:"GET",data:i,xhrFields:{responseType:"blob"},success:function(t){hideLoader();var r=window.URL.createObjectURL(t),i=document.createElement("a");i.href=r;i.download=n+".csv";i.click();window.URL.revokeObjectURL(r)},error:function(){hideLoader();ErrorMsg("Error","Failed to export","")}})}function openStaffExportModal(){showLoader();var n=[],t=[],f=[];let i="",r="",u={facilityId:$("#FacilityId").val(),Year:$("#YearList").val(),ReportQuarter:$("#QuarterList").val(),Month:$("#MonthList").val(),SearchValue:$("#EmployeeListTable_filter input").val()};u.SearchValue!=""&&u.SearchValue!=null?$.ajax({type:"GET",data:u,url:urls.Review.GetSearchedEmployees,success:function(u){for(const u of u)n.includes(u.payTypeCode)||(i+="<option value='"+u.payTypeCode+"'>"+u.payType+"<\/option>",n.push(u.payTypeCode)),t.includes(u.jobTitleCode)||(r+="<option value='"+u.jobTitleCode+"'>"+u.jobTitle+"<\/option>",t.push(u.jobTitleCode)),f.push(u.employeeId);$("#StaffExportPayType").html(i);$("#StaffExportPayType").select2({multiple:!0,placeholder:"Select Pay Type"});$("#StaffExportPayType").val(n).trigger("change");$("#StaffExportJobTitle").html(r);$("#StaffExportJobTitle").select2({multiple:!0,placeholder:"Select Job Title"});$("#StaffExportJobTitle").val(t).trigger("change");let e=JSON.stringify(f);sessionStorage.setItem("empIds",e)},failure:function(){ErrorMsg("Error","Something went wrong!Try again Later","");$("#preloader").addClass("d-none")},error:function(){ErrorMsg("Error","Something went wrong!Try again Later","");$("#preloader").addClass("d-none")}}):(r="",i="",$("#StaffExportPayType").html(),$.each(GetPayCodeList,function(t,r){i+="<option value='"+r.payTypeCode+"'>"+r.payTypeDescription+"<\/option>";n.push(r.payTypeCode)}),$("#StaffExportPayType").html(i),$("#StaffExportPayType").select2({multiple:!0,placeholder:"Select Pay Type"}),$("#StaffExportPayType").val(n).trigger("change"),$("#StaffExportJobTitle").html(),$.each(GetJobTitleList,function(n,i){r+="<option value='"+i.id+"'>"+i.title+"<\/option>";t.push(i.id)}),$("#StaffExportJobTitle").html(r),$("#StaffExportJobTitle").select2({multiple:!0,placeholder:"Select Job Title"}),$("#StaffExportJobTitle").val(t).trigger("change"));hideLoader();$("#ExportEmpolyeeModal").modal("show")}function getEmployeeName(n){let t="";return $.ajax({url:urls.Review.GetEmployeeName,type:"GET",data:{EmployeeId:n},"async":!1,success:function(n){t=n?n:""},error:function(){ErrorMsg("Error","Failed to Get Employee Name","")}}),t}function initSelect2Review(){$("#EmpWorkingPayType").select2({dropdownParent:$("#EmpWorkingPayTypeDiv"),placeholder:"Select Pay Type",width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below");var n=$(this).offset().top-dropdown.outerHeight();dropdown.css({top:n+"px",left:"0",right:"0"})});$("#EmpWorkingJobTitle").select2({dropdownParent:$("#EmpWorkingJobTitleDiv"),placeholder:"Select Pay Type",width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#PayType").select2({dropdownParent:$("#PayTypeDiv"),placeholder:"Select Pay Type",width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#JobTitle").select2({dropdownParent:$("#JobTitleDiv"),placeholder:"Select Pay Type",width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#NurseWorkingPayType").select2({dropdownParent:$("#NurseWorkingPayTypeDiv"),placeholder:"Select Pay Type",width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#NurseWorkingJobTitle").select2({dropdownParent:$("#NurseWorkingJobTitleDiv"),placeholder:"Select Pay Type",width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#Emp_WorkingPayType").select2({dropdownParent:$("#Emp_WorkingPayTypeDiv"),placeholder:"Select Pay Type",width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#Emp_WorkingJobTitle").select2({dropdownParent:$("#Emp_WorkingJobTitleDiv"),placeholder:"Select Pay Type",width:"100%"}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")});$("#NurseEmployeeId").select2({dropdownParent:$("#NurseEmployeeIdDiv"),placeholder:"Search employee id",width:"100%",ajax:{url:"Review/GetEmployeeIdAndName",dataType:"json",type:"POST",delay:250,data:function(n){return{term:n.term,FacilityId:$("#FacilityId").val()}},processResults:function(n){return{results:n.items}},cache:!0}}).next().addClass("form-control").on("select2:open",function(){$(".select2-dropdown--above").attr("id","fix");$("#fix").removeClass("select2-dropdown--above");$("#fix").addClass("select2-dropdown--below")})}function checkIfValidated(){let n=new FormData;n.append("FacilityId",$("#FacilityId").val());n.append("ReportQuarter",$("#QuarterList").val());n.append("Year",$("#YearList").val());$.ajax({url:urls.Review.CheckIfValidated,type:"POST",data:n,contentType:!1,processData:!1,success:function(n){n.success?n.fullName.length>0&&n.validationDate.length>0?($("#validateDiv").show(),$("#validationUserFullName").text(n.fullName),$("#validationUserFullName").css("display","block"),$("#validationValidationDate").text(n.validationDate),$("#validationValidationDate").css("display","block")):($("#validationUserFullName").hide(),$("#validationValidationDate").hide()):($("#validateDiv").hide(),$("#validationUserFullName").hide(),$("#validationValidationDate").hide())},error:function(){}})}function checkIfApproved(){let n=new FormData;n.append("FacilityId",$("#FacilityId").val());n.append("ReportQuarter",$("#QuarterList").val());n.append("Year",$("#YearList").val());$.ajax({url:urls.Review.CheckIfApproved,type:"POST",data:n,contentType:!1,processData:!1,success:function(n){n.success?n.fullName.length>0&&n.approvedDate.length>0?($("#approvedDiv").show(),$("#approvedUserFullName").text(n.fullName),$("#approvedUserFullName").css("display","block"),$("#approvedDate").text(n.approvedDate),$("#approvedDate").css("display","block")):($("#approvedUserFullName").hide(),$("#approvedDate").hide()):($("#approvedDiv").hide(),$("#approvedUserFullName").hide(),$("#approvedDate").hide())},error:function(){}})}function autoselect(n){var t=$("#FacilityId");t.val(n).trigger("change")}function validateData(){ConfirmMsg("Validate","Are you sure want to validate the data?","Validate",event,function(){var n={FacilityId:$("#FacilityId").val(),Year:$("#YearList").val(),ReportQuarter:$("#QuarterList").val(),Month:$("#MonthList").val()};showLoader();$.ajax({type:"POST",url:urls.Review.Validate,data:n,success:function(n){hideLoader();n.success?SuccessMsg("Success",n.message,"success"):ErrorMsg("Alert!",n.message);checkIfValidated()},error:function(){hideLoader();ErrorMsg("Alert!","Failed to approve the data!")}})})}function autoselect(n){var t=$("#FacilityId");t.val(n).trigger("change")}function exportStaff(){let t=$("#StaffExportPayType").val(),i=$("#StaffExportJobTitle").val(),o=$('input[name="radioFormatType"]:checked').attr("id"),s=sessionStorage.getItem("empIds"),h=JSON.parse(s),r=$("#"+o).val();if(t=="")return ErrorMsg("Warning","Please select Pay Type"),!1;if(i=="")return ErrorMsg("Warning","Please select Job Title"),!1;let u="",f="",e="";$.each(t,function(n,t){u+=t+","});$.each(i,function(n,t){f+=t+","});$.each(h,function(n,t){e+=t+","});let c=new Date,n="StaffExport_"+$("#FacilityId :selected").text()+moment(c).format("YYYYMMDDHHMMSS"),l={payType:u,jobTitle:f,FormatType:r,Year:$("#YearList").val(),Quarter:$("#QuarterList").val(),Month:$("#MonthList").val(),FacilityId:$("#FacilityId").val(),Filename:n,EmployeeIds:e};showLoader();$.ajax({url:urls.Review.ExportStaff,type:"GET",data:l,contentType:"application/json",xhrFields:{responseType:"blob"},success:function(t){var i,f;if(hideLoader(),r=="1")i=window.URL.createObjectURL(t),f=document.createElement("a"),f.href=i,f.download=n+".csv",f.click(),window.URL.revokeObjectURL(i);else{var e=new Blob([t],{type:"application/pdf"}),i=window.URL.createObjectURL(e),u=document.createElement("a");u.style.display="none";u.href=i;u.download=n+".pdf";document.body.appendChild(u);u.click();window.URL.revokeObjectURL(i)}},error:function(){hideLoader();ErrorMsg("Error","Failed to export","")}})}function validationErrorsList(n=1){if($("#FileNameList").val()=="0")return ErrorMsg("Alert","Please select the file name"),!1;var t={FileDetailId:$("#FileNameList").val(),PageNo:n,PageSize:$("#PageSizeddl").val()};showLoader();$("#fileDetailsLabel").addClass("hide");$("#FacilityNameLabel").html("");$("#CreateDateLabel").html("");$("#UploadedByLabel").html("");$("#YearByLabel").html("");$("#ReportQuarterLabel").html("");$.ajax({url:urls.Backout.ListValidationErrorByFileId,type:"POST",data:t,dataType:"json",success:function(t){var r,i,f,u,e,o;if(t.dynamicDataTableModel.length>0){for($("#fileDetailsLabel").removeClass("hide"),$("#FacilityNameLabel").html(t.uploadFileDetails.facilityName),$("#CreateDateLabel").html(moment(t.uploadFileDetails.uploadedDate).format("YYYY-MM-DD HH:MM")),$("#UploadedByLabel").html(t.uploadFileDetails.uploadedBy),$("#YearByLabel").html(t.uploadFileDetails.year),$("#ReportQuarterLabel").html(t.uploadFileDetails.reportQuarter),r=Object.keys(t.dynamicDataTableModel[0].dynamicDataTable),i='<table class="table display table-bordered table-striped no-wrap" style="max-height:150px;overflow-y: auto;">',i+="<thead><tr>",f=0;f<r.length;f++)r[f]!="ErrorId"&&(i+="<th>"+r[f]+"<\/th>");for(i+="<th>Action<\/th><\/tr><\/thead><tbody>",u=0;u<t.dynamicDataTableModel.length;u++){for(i+="<tr>",e=0;e<r.length;e++)o=r[e],o!="ErrorId"&&(i+="<td>"+t.dynamicDataTableModel[u].dynamicDataTable[o]+"<\/td>");i+="<td><a href='#' onclick=deleteValidationErrorRecord('"+t.dynamicDataTableModel[u].dynamicDataTable.ErrorId+"'); title='Delete'><i class='ri-delete-bin-line fs-6 text-danger'><\/i><\/a>";i+=" <a href='#' onclick=openErrorDetailListModal('"+t.dynamicDataTableModel[u].dynamicDataTable.ErrorId+"')  data-bs-toggle='tooltip'  data-bs-placement='top' title='View'><i class='ri-eye-line fs-6 text-success ms-2'><\/i><\/a>";i+="<\/td><\/tr>"}i+="<\/tbody><\/table>";let y=t.totalCount,a=$("#PageSizeddl").val(),s=n;i+='<nav aria-label="Page navigation example">';i+='<ul class="pagination">';(s>1||s-1>1)&&(i+='<li class="page-item">',i+='<a class="page-link link" href="#" aria-label="Previous" onclick=validationErrorsList("'+(s-1)+'"); >',i+='<span aria-hidden="true">',i+='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevrons-left feather-sm"><polyline points="11 17 6 12 11 7"><\/polyline><polyline points="18 17 13 12 18 7"><\/polyline><\/svg>',i+="<\/span>",i+="<\/a>",i+="<\/li>");let l=s,h=1,c=3;for(let n=l;n>0&&h<=3;n++)s-c>0&&(i+='<li class="page-item"><a class="page-link" href="#" onclick=validationErrorsList("'+(s-c)+'");>'+(s-c)+"<\/a><\/li>"),h++,c--;l=s;h=1;let v=0;for(let n=l;n>0&&h<=3;n++){let n=parseInt(s)+parseInt(v);s==n?i+='<li class="page-item" ><a class="page-link link" href="#">'+n+"<\/a><\/li>":(parseInt(n)-1)*parseInt(a)<parseInt(t.totalCount)&&(i+='<li class="page-item"><a class="page-link" href="#" onclick=validationErrorsList("'+n+'");>'+n+"<\/a><\/li>");h++;v++}parseInt(a)*parseInt(s)<=parseInt(y)&&(i+='<li class="page-item">',i+='<a class="page-link" href="#" aria-label="Next" onclick=validationErrorsList("'+(s+1)+'");>',i+='<span aria-hidden="true">',i+='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevrons-right feather-sm"><polyline points="13 17 18 12 13 7"><\/polyline><polyline points="6 17 11 12 6 7"><\/polyline><\/svg>',i+="<\/span>",i+="<\/a>",i+="<\/li>");i+="<\/ul>";i+="<\/nav>";$("#dataTableContainer").html("");$("#dataTableContainer").html(i);$("#rowCountId").html("Row count :"+t.rowCount+" of "+t.totalCount);$("#pageCountId").html("Page No. :"+s+" of "+calculateTotalPages(t.totalCount,$("#PageSizeddl").val()));$(".disabled-li").css({color:"gray",cursor:"not-allowed"})}else $("#rowCountId").html(""),$("#pageCountId").html(""),$("#dataTableContainer").html("No data available.");hideLoader()},error:function(){hideLoader();$("#rowCountId").html("");$("#pageCountId").html("");$("#dataTableContainer").html("Error fetching data.")}})}function getAllFileNameByFacility(){let n;n=$("#hdnFacilityId").val()!=""&&$("#hdnFacilityId").val()!=undefined?$("#hdnFacilityId").val():$("#FacilityId").val();let t={FacilityId:n,ReportQuarter:$("#QuarterList").val(),Year:$("#YearList").val()};showLoader();$.ajax({url:urls.Backout.GetAllFileNameByFacility,type:"POST",data:t,success:function(n){$("#FileNameList").html("");var t="";let i=$("#hdnFileId").val();if(t+="<option value='0'> Select filename <\/option>",$.each(n,function(n,r){t+=i==r.fileNameId?"<option value='"+r.fileNameId+"' selected>"+r.fileName+"<\/option>":"<option value='"+r.fileNameId+"'>"+r.fileName+"<\/option>"}),$("#FileNameList").html(t),$("#dataTableContainer").html(""),$("#rowCountId").html(""),$("#pageCountId").html(""),i!=""){$("#ValidationErrorAccordian").click();validationErrorsList(1)}hideLoader()},error:function(){hideLoader();ErrorMsg("Failed","Failed to fetch the data")}})}function deleteValidationErrorRecord(n){ConfirmMsg("Delete","Are you sure want to Delete the record?","Delete",event,function(){let t={Id:n};showLoader();$.ajax({url:urls.Backout.DeleteErrorRowData,type:"POST",data:t,success:function(n){n.statusCode==200?(SuccessMsg("Success",n.message,"success"),validationErrorsList(),hideLoader()):(ErrorMsg("Failed",n.message),hideLoader());hideLoader()},error:function(){hideLoader();ErrorMsg("Failed","Failed to Delete")}})})}function openErrorDetailListModal(n){let t={Id:n};showLoader();$.ajax({url:urls.Backout.GetErrorRowData,type:"POST",data:t,success:function(n){hideLoader();$("#RightErrorTab").html("");$("#TopWorkdayListTabTableBody").html("");$("#lblTotalWorkingHours").html("");let t="";if(n.keyValueList.length>0){let i="";i+="<input type='hidden' id='_errorId' value='"+n.id+"' />";i+="<input type='hidden' id='_facilityId' value='"+n.facilityId+"' />";i+="<input type='hidden' id='_fileDetailId' value='"+n.fileDetailId+"' />";i+="<input type='hidden' id='_reportQuarter' value='"+n.reportQuarter+"' />";i+="<input type='hidden' id='_year' value='"+n.year+"' />";i+="<input type='hidden' id='_month' value='"+n.month+"' />";i+="<input type='hidden' id='_uploadType' value='"+n.uploadType+"' />";n.keyValueList.forEach(function(n){n.key=="Employee Id"&&(t=n.value);i+='<div class="col-sm-6 keyValue">';i+='<span id="_key" style="font-weight: 700;">'+n.key+"<\/span>";i+="<span><input id='_value' class='form-control my-2' type='text'' value='"+n.value+"' /><\/span>";i+="<\/div>"});i+="<input type='hidden' id='_employeeIdValue' value='"+t+"' />";$("#RightErrorTab").html("");$("#RightErrorTab").html(i);let r="";if(n.workdayList.length>0){let t=0;$.each(n.workdayList,function(n,i){r+="<tr>";r+="<td>"+i.employeeId+"<\/td>";r+="<td>"+i.firstName+" "+i.lastName+"<\/td>";r+="<td>"+i.workday+"<\/td>";r+="<td>"+i.payTypeCode+"<\/td>";r+="<td>"+i.jobTitleCode+"<\/td>";r+="<td>"+i.tHours+"<\/td>";r+="<tr>";t+=parseFloat(i.tHours)});$("#TopWorkdayListTabTableBody").html("");$("#TopWorkdayListTabTableBody").html(r);$("#lblTotalWorkingHours").html("");$("#lblTotalWorkingHours").html(t)}$("#ValidationErrorModalData").modal("show");draggableModel("#ValidationErrorModalData")}else SuccessMsg("Success","No record found","success")},error:function(){hideLoader();ErrorMsg("Failed","Failed to fetch the data")}})}function UpdateErrorRowData(){var n=[],t;$(".keyValue").each(function(){let t={Key:$(this).find("#_key").text(),Value:$(this).find("#_value").val()};n.push(t)});t={Id:$("#_errorId").val(),FileDetailId:$("#_fileDetailId").val(),FacilityId:$("#_facilityId").val(),ReportQuarter:$("#_reportQuarter").val(),Year:$("#_year").val(),Month:$("#_month").val(),UploadType:$("#_uploadType").val(),keyValueList:n};showLoader();$.ajax({url:urls.Backout.UpdateErrorRowData,type:"POST",data:t,success:function(n){n.success?(validationErrorsList(),$("#ValidationErrorModalData").modal("hide"),hideLoader(),SuccessMsg("Success",n.errorMessage,"success")):(hideLoader(),ErrorMsg("Failed",n.errorMessage))},error:function(){hideLoader();ErrorMsg("Failed","Failed to Delete")}})}function calculateTotalPages(n,t){return Math.ceil(n/t)}function restrictInput(n){let t=n.key;/^[A-Za-z\s\-'.]+$/.test(t)||t==="Backspace"||n.preventDefault()}function ViewValidatedList(){let n=new FormData;n.append("FacilityId",$("#FacilityId").val());n.append("ReportQuarter",$("#QuarterList").val());n.append("Year",$("#YearList").val());$.ajax({url:urls.Review.GetStatusValidatedList,type:"POST",data:n,contentType:!1,processData:!1,success:function(n){let i="",t=n.filter(function(n){return n.success===!0});t.length>0?(t.forEach(function(n){i+="<p>Validated By: "+n.fullName+", Validated Date & Time: "+n.validationDate+"<\/p>"}),$("#ViewReportVerificationModal .modal-body").html(populateHistoryTable(n)),$("#myModalLabel").text("Validation History"),$("#ViewReportVerificationModal").modal("show"),draggableModel("#ViewReportVerificationModal")):ErrorMsg("Failed","No validation history available for current facility's current report quarter.")},error:function(){ErrorMsg("Failed","Failed to Load Report Validation Status")}})}function populateHistoryTable(n){var t;let i=n[2];t=i.validationDate!=null?[{data:"fullName",title:"Validated By"},{data:"validationDate",title:"Validated Date & Time"}]:[{data:"fullName",title:"Approved By"},{data:"approvedDate",title:"Approved Date & Time"}];$("#historyDataTable").dataTable().fnDestroy();$("#historyDataTable").DataTable({pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}},paging:!0,pageLength:10,columns:t,data:n})}function ViewApprovedList(){let n=new FormData;n.append("FacilityId",$("#FacilityId").val());n.append("ReportQuarter",$("#QuarterList").val());n.append("Year",$("#YearList").val());$.ajax({url:urls.Review.GetStatusApprovedList,type:"POST",data:n,contentType:!1,processData:!1,success:function(n){let i="",t=n.filter(function(n){return n.success===!0});t.length>0?(t.forEach(function(n){i+="<p>Approved By: "+n.fullName+", Approved Date & Time: "+n.approvedDate+"<\/p>"}),$("#ViewReportVerificationModal .modal-body").html(populateHistoryTable(n)),$("#myModalLabel").text("Approved History"),$("#ViewReportVerificationModal").modal("show"),draggableModel("#ViewReportVerificationModal")):ErrorMsg("Failed","No approved history available for current facility's current report quarter.")},error:function(){ErrorMsg("Failed","Failed to Load Report Approved Status")}})}function deleteEmployeeWorkingHours(){ConfirmMsg("Delete working hours","Are you sure want to delete the data?","Delete",event,function(){showLoader();let n={TimesheetId:$("#EmpTimesheetId").val()};$.ajax({url:urls.Review.DeleteTimesheetData,type:"POST",data:n,success:function(){hideLoader();SuccessMsg("Success","Deleted successfully","success");$("#EmpAddUpdateWorkingHours").modal("hide");openEmployeeCalender($("#EmployeeIdWorking").val());loadStaffDeptData()},error:function(){hideLoader();ErrorMsg("Failed","Failed to delete")}})})}function addMultipleDaysArray(n,t){for(var r,i=n;i<=t;i.setDate(i.getDate()+1))r=moment(new Date(i)).format("YYYY-MM-DD"),AddSelectedDates.push(r),addSelectedColorDates.find(n=>n.start==r)||addSelectedColorDates.push({start:r,backgroundColor:"yellow"})}function clearSessionVariables(){sessionStorage.removeItem("empIds")}function GetRole(n){$("#Edit_roleId").val(n);$("#updatememberModal").modal("show");draggableModel("#updatememberModal");let t={Id:n};$.ajax({type:"Post",data:t,"async":!1,url:urls.Role.GetRole,success:function(n){$("#Edit_role").val(n.roleName);$("#Edit_departmentId").val(n.departmentName)},failure:function(n){ErrorMsg("Error",n,"")}});$("#error_Edit_role").text("");$("#error_Edit_departmentId").text("")}function EditRole(){let n=$("#Edit_role").val()||"",i=$("#Edit_departmentId :selected").val()||"";if(n=="")return $("#error_Edit_role").text("Please enter the rolename"),$("#error_Edit_role").focus(),!1;if(/^[A-Za-z0-9 ]+$/.test($("#Edit_role").val())==!1)return $("#error_Edit_role").text("Please enter valid Role Name!"),$("#error_Edit_role").focus(),!1;$("#error_Edit_role").text("");let t={roleName:n,Id:$("#Edit_roleId").val()};$.ajax({type:"Post",data:t,"async":!1,url:urls.Role.UpdateRole,success:function(n){n=="Record Saved !"?window.location.reload():n=="RoleName is already exists!please try different role name."?window.location.reload():(ErrorMsg("Error",n,""),window.location.reload())},failure:function(n){ErrorMsg("Error",n,"")}})}function DeleteRole(n){ConfirmMsg("Role Management","Are you sure want to delete this Role?","Continue",event,function(){let t={Id:n};$.ajax({type:"Post",data:t,"async":!1,url:urls.Role.DeleteRole,success:function(n){n=="Record has been deleted successfully"&&window.location.reload()},failure:function(n){ErrorMsg("Error",n,"")}})})}function getappRole(){let n={OrgId:$("#appName").val()};$.ajax({type:"Post",data:n,"async":!1,url:urls.UserManagement.GetroleList,success:function(n){let t=$("#roleName");t.empty();t.append('<option value=""> Select Role <\/option>');$.each(n,function(n,i){t.append('<option value="'+i.value+'">'+i.text+"<\/option>")});t.trigger("change")},failure:function(){ErrorMsg("Error","Something went wrong!Try again Later","");$("#preloader").addClass("d-none")},error:function(){ErrorMsg("Error","Something went wrong!Try again Later","");$("#preloader").addClass("d-none")}})}function searchRole(){let n={userType:$("#userTypes").val(),appId:$("#appName").val(),roleId:$("#roleName").val()};$.ajax({type:"Post",data:n,"async":!1,url:urls.Role.index,success:function(n){$("#RoleList").html($(n).find("#RoleList").html());$("#RoleList").dataTable().fnDestroy();$("#RoleList").DataTable({language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i> First',previous:'<i class="fa fa-angle-left"><\/i><i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i><i class="fa fa-angle-right"><\/i>',last:'Last <i class="fa fa-angle-double-right"><\/i>'}},columnDefs:[{orderable:!1,targets:2}]})}})}function resetRoleFilter(){$("#userTypes").val(null).trigger("change");$("#appName").val("");$("#roleName").empty();let n={appId:$("#appName").val(),roleId:$("#roleName").val()};$.ajax({type:"Post",data:n,"async":!1,url:urls.Role.index,success:function(n){$("#roleName").html($(n).find("#roleName").html());$("#RoleList").html($(n).find("#RoleList").html());$("#RoleList").dataTable().fnDestroy();$("#RoleList").DataTable({language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i> First',previous:'<i class="fa fa-angle-left"><\/i><i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i><i class="fa fa-angle-right"><\/i>',last:'Last <i class="fa fa-angle-double-right"><\/i>'}},columnDefs:[{orderable:!1,targets:2}]})}})}function validateInputOnBlur(n){let i=n.value,t=$("#addNewMember"),r=/[a-zA-Z]/.test(i);r?($("#roleName_Error").text(""),t.prop("disabled",!1)):($("#roleName_Error").text("Input is invalid. It should contain at least one character"),t.prop("disabled",!0))}function validateInputOnBlurForUpdateRole(n){let i=n.value,t=$("#updateRole"),r=/[a-zA-Z]/.test(i);r?($("#error_Edit_role").text(""),t.prop("disabled",!1)):($("#error_Edit_role").text("Input is invalid. It should contain at least one character"),t.prop("disabled",!0))}function getuserTypeRoles(){let n=$("#userTypes").val();if(n==1)$("#appNameFilter").hide(),$.ajax({type:"Post","async":!1,url:urls.Role.GetTANRoleList,success:function(n){let t=$("#roleName");t.empty();t.append('<option value=""> Select Role <\/option>');$.each(n,function(n,i){t.append('<option value="'+i.value+'">'+i.text+"<\/option>")});t.trigger("change")}});else{$("#appNameFilter").show();let n=$("#roleName");n.empty();n.append('<option value=""> Select Role <\/option>');n.trigger("change");$("#appName").val(null).trigger("change")}}function clearForm(){$("#appNameSelect").val("");$("#roleNameSelect").val("");$(".errormsg").text("")}function loadStorageData(){$("#storageTable").DataTable({ajax:{url:urls.StorageManagement.GetAllFiles,type:"POST",data:function(n){n.searchValue=$("#storageTable_filter input").val();n.start=n.start||0;n.length=n.length||10;n.draw=n.draw||1;n.sortColumn=n.columns[n.order[0].column].data;n.sortDirection=n.order[0].dir},error:function(n,t){(t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)&&ErrorMsg("Failed","Unauthorized Access")}},processing:!0,filter:!0,serverSide:!0,pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}},columns:[{data:"name",name:"File Name"},{data:"size",name:"Size",render:function(n){return formatFileSize(n)}},{data:null,orderable:!1,render:function(n,t,i){return"<a href='#' onclick=downloadFile('"+encodeURIComponent(i.name)+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Download'><i class='ri-download-line fs-6 pe-2 text-info'><\/i><\/a> <a href='#' onclick=deleteFile('"+encodeURIComponent(i.name)+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Delete'><i class='ri-delete-bin-line fs-6 text-danger'><\/i><\/a>"}}]})}function formatFileSize(n){return n>=1073741824?(n/1073741824).toFixed(2)+" GB":n>=1048576?(n/1048576).toFixed(2)+" MB":n>=1024?(n/1024).toFixed(2)+" KB":n+" Bytes"}function fileUpload(n){let t=n.target.files;if(t.length>0){let n=new FormData;n.append("file",t[0]);$.ajax({url:urls.StorageManagement.UploadFile,type:"POST",data:n,processData:!1,contentType:!1,success:function(n){n=="success"?SuccessMsg("Success","File Uploaded successfully","success"):n=="exists"?ErrorMsg("Failed","The file you are trying to upload already exists on the cloud.","error"):n=="sizeexceeds"?ErrorMsg("Failed","File size exceeds the maximum allowed size (100 MB).","error"):n=="invalidextension"?ErrorMsg("Failed","Invalid file extension. Only XML, CSV, ZIP, XLS, XLSX files are allowed.","error"):n=="error"&&ErrorMsg("Failed","An error occurred while uploading the file to the cloud.","error");let t=$("#storageTable").DataTable();t.destroy();loadStorageData();$(".input-file__delete").click()},error:function(n,t){hideLoader();(t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)&&ErrorMsg("Failed","Unauthorized Access")}})}}function downloadFile(n){window.location=urls.StorageManagement.DownLoadFile+"?fileName="+decodeURIComponent(n)}function deleteFile(n){ConfirmMsg("Storage Management","Are you sure want to delete the file from cloud?","Continue",event,function(){$.ajax({url:urls.StorageManagement.DeleteFile,type:"POST",data:{fileName:decodeURIComponent(n)},"async":!1,success:function(n){n?SuccessMsg("Success","Record Deleted successfully","success"):ErrorMsg("Failed",error,"error");let t=$("#storageTable").DataTable();t.destroy();loadStorageData()},error:function(n,t,i){t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Oops","Unauthorized Access","error"):ErrorMsg("Failed",i,"error")}})})}function processOneDriveInStorage(){let n={clientId:"3c39b444-9cde-4ddc-9878-a9c8b69197d2",action:"download",multiSelect:!1,openInNewWindow:!0,success:function(n){$.each(n.value,function(n,t){oneDriveUploadInStorage(t["@microsoft.graph.downloadUrl"],t.name)})},cancel:function(){ErrorMsg("warning","You cancelled your upload.","warning");let n=document.getElementById("onedrive");n.checked=!1},error:function(){hideLoader();ErrorMsg("Error","Something went wrong.","error")}};OneDrive.open(n)}function oneDriveUploadInStorage(n,t){let i=new FormData;i.append("Filename",t);i.append("FileURL",n);i.append("IsOneDrive",!0);$.ajax({url:urls.StorageManagement.UploadFile,type:"POST",data:i,processData:!1,contentType:!1,success:function(n){n=="success"?SuccessMsg("Success","File Uploaded successfully","success"):n=="exists"?ErrorMsg("Failed","The file you are trying to upload already exists on the cloud.","error"):n=="sizeexceeds"?ErrorMsg("Failed","File size exceeds the maximum allowed size (100 MB).","error"):n=="invalidextension"?ErrorMsg("Failed","Invalid file extension. Only XML, CSV, ZIP, XLS, XLSX files are allowed.","error"):n=="error"&&ErrorMsg("Failed","An error occurred while uploading the file to the cloud.","error");let t=document.getElementById("onedrive");t.checked=!1;let i=$("#storageTable").DataTable();i.destroy();loadStorageData()},error:function(n,t){(t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)&&ErrorMsg("Failed","Unauthorized Access")}})}function getFacilities(){showLoader();let n=$("#organizationName").val();$("#organizationName").val()!=""&&$.ajax({type:"Post",data:{organizationName:n},"async":!1,cache:!1,url:urls.SubmissionHistoryManagement.GetFacilities,success:function(n){hideLoader();let t=$("#facilityName");t.empty();t.append('<option value="">- Select Facility Name -<\/option>');$.each(n,function(n,i){t.append('<option value="'+i.facilityName+'">'+i.facilityName+"<\/option>")});t.trigger("change")},failure:function(){hideLoader();ErrorMsg("Error","Something went wrong!Try again Later","");$("#preloader").addClass("d-none")},error:function(){hideLoader();ErrorMsg("Error","Something went wrong!Try again Later","");$("#preloader").addClass("d-none")}})}function clearFilter(){$("#organizationName").val(null).trigger("change");$("#facilityName").val(null).trigger("change")}function initSelect2ForSubmissionHistory(){$("#organizationName").select2({placeholder:"Select Organization Name",width:"100%"}).on("select2:close",function(){$(this).val()==null&&($(this).val("").trigger("change"),$(this).next(".select2-container").find(".select2-search__field").attr("placeholder","Select Organization Name"))});$("#facilityName").select2({placeholder:"Select Facility Name",width:"100%"}).on("select2:close",function(){$(this).val()==null&&($(this).val("").trigger("change"),$(this).next(".select2-container").find(".select2-search__field").attr("placeholder","Select Facility Name"))})}function LoadSubmissionData(){let n=$("#organizationName").val();n=="Select Organization Name"&&(n=null);let t=$("#facilityName").val();t=="Select Facility Name"&&(t=null);let i={orgName:n,facilityName:t};$("#historyTable").DataTable({ajax:{url:urls.SubmissionHistoryManagement.GetSubmissions,type:"POST",data:function(n){n.searchValue=$("#historyTable_filter input").val();n.start=n.start||0;n.length=n.length||10;n.draw=n.draw||1;n.sortColumn=n.columns[n.order[0].column].data;n.sortDirection=n.order[0].dir;n.orgName=i.orgName;n.facilityName=i.facilityName},error:function(n,t){(t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN)&&ErrorMsg("Failed","Unauthorized Access")}},processing:!0,filter:!0,serverSide:!0,pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}},columns:[{data:"submissionDate",name:"Date"},{data:"fileName",name:"File Name",render:function(n){return'<a href="'+n+'" target="_blank" onclick="downloadFile(\''+n+"')\">"+n+"<\/a>"}},{data:"organizationName",name:"Organization Name"},{data:"facilityName",name:"Facility Name"},{data:"status",name:"Status",render:function(n){return n===0?"Pending":n===1?"Accepted":n===2?"Rejected":void 0}},{data:null,orderable:!1,render:function(n,t,i){return"<a href='#' onclick=editStatus('"+i.fileName+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Edit'><i class='ri-edit-2-line fs-6 pe-2 text-info'><\/i><\/a> <a href='#' onclick=deleteSubmissionFileHistory('"+i.fileName+"'); data-bs-toggle='tooltip' data-bs-placement='top' title='Delete'><i class='ri-delete-bin-line fs-6 text-danger'><\/i><\/a>"}}]})}function downloadFile(n){window.location=urls.SubmissionHistoryManagement.DownloadFile+"?fileName="+n}function deleteSubmissionFileHistory(n){let t=$('input[name="__RequestVerificationToken"]').val();ConfirmMsg("Submission History Management","Are you sure want to delete the history of submitted file?","Continue",event,function(){$.ajax({url:urls.SubmissionHistoryManagement.DeleteSubmision,type:"POST",headers:{RequestVerificationToken:t},data:{fileName:n},"async":!1,success:function(n){n=="success"?SuccessMsg("Success","Record Deleted successfully","success"):ErrorMsg("Failed",error,"error");let t=$("#historyTable").DataTable();t.destroy();LoadSubmissionData()},error:function(n,t,i){t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Oops","Unauthorized Access","error"):ErrorMsg("Failed",i,"error")}})})}function editStatus(n){showLoader();$.ajax({url:urls.SubmissionHistoryManagement.EditStatus,type:"GET",data:{fileName:n},success:function(n){hideLoader();$("#btnChangeStatus").trigger("click");$("#FileEditDate").val(n.createDate);$("#FileEditName").val(n.fileName);$("#StatusSelectBox").val(n.status).trigger("change");$("#FileID").val(n.id)},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}})}function clearEditStatusData(){$("#FileEditDate").val("");$("#FileEditName").val("");$("#StatusSelectBox").val(null).trigger("change");$("#SubmissionStatusModal").hide();window.location.reload();let n=$("#historyTable").DataTable();n.destroy();LoadSubmissionData()}function updateSubmissionData(){let n=$('input[name="__RequestVerificationToken"]').val(),t=$("#FileID").val(),i=$("#FileEditDate").val(),r=$("#FileEditName").val(),u=$("#StatusSelectBox").val(),f={fileId:t,fileDate:i,fileName:r,fileStatus:u};showLoader();$.ajax({url:urls.SubmissionHistoryManagement.UpdateSubmissionData,type:"POST",headers:{RequestVerificationToken:n},data:f,"async":!1,success:function(n){hideLoader();n=="success"?(SuccessMsg("Success","Record Added successfully","success"),$("#SubmissionStatusModal").modal("hide")):($("#SubmissionStatusModal").modal("hide"),ErrorMsg("Failed",error,"error"));let t=$("#historyTable").DataTable();t.destroy();LoadSubmissionData()},error:function(n,t,i){hideLoader();t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):ErrorMsg("Failed",i,"error")}})}function getQuaterList(){$("#QuarterList").html();var t=new Date,i=t.getMonth(),r=findQuarter(i+1),n="<option value='-1'>Select<\/option>";ListQuarters.forEach(function(t){n+=t.key==r?"<option value='"+t.key+"' selected>"+t.value+"<\/option>":"<option value='"+t.key+"'>"+t.value+"<\/option>"});$("#QuarterList").html(n)}function findQuarter(n){var t=0;switch(n){case 1:case 2:case 3:t=2;break;case 4:case 5:case 6:t=3;break;case 7:case 8:case 9:t=4;break;case 10:case 11:case 12:t=1}return t}function getMonthList(){$("#MonthList").html();var t="",n=$("#QuarterList").val();n=n-1;$.each(ListMonths[n],function(n,i){t+="<option value='"+n+"'>"+i+"<\/option>"});$("#MonthList").html(t)}function getYear(){var n=2020,r=new Date,i=r.getFullYear(),t;for($("#YearList").html(),t="",t+="<option value='0'>Select<\/option>";n<=i;)t+=i==n?"<option value='"+n+"' selected>"+n+"<\/option>":"<option value='"+n+"'>"+n+"<\/option>",n=n+1;$("#YearList").html(t)}function GenerateSubmitData(){if($("#FacilityId").val()==""||$("#FacilityId").val()==undefined)return WarningMsg("Warning!","Please select Facility","Okay"),!1;ConfirmMsg("Generate","Are you sure want to Generate the data?","Generate",event,function(){let t=new Date,n=$("#FacilityId :selected").text()+moment(t).format("YYYYMMDDHHMMSS");var i={FacilityId:$("#FacilityId").val(),Year:$("#YearList").val(),ReportQuarter:$("#QuarterList").val(),FileName:n};showLoader();$.ajax({url:urls.Submit.GenerateXMLFile,type:"GET",data:i,xhrFields:{responseType:"blob"},success:function(t){hideLoader();let r=window.URL.createObjectURL(t),i=document.createElement("a");i.href=r;i.download=n+".zip";i.click();window.URL.revokeObjectURL(r)}})})}function getMonthList(){$("#MonthList").html();var n="",t=$("#QuarterList").val();$.each(ListMonths[t-1],function(t,i){n+="<option value='"+t+"'>"+i+"<\/option>"});$("#MonthList").html(n)}function findQuarter(n){var t=0;switch(n){case 1:case 2:case 3:t=2;break;case 4:case 5:case 6:t=3;break;case 7:case 8:case 9:t=4;break;case 10:case 11:case 12:t=1}return t}function getQuaterList(){$("#QuarterList").html();var t=new Date,i=t.getMonth(),r=findQuarter(i+1),n="<option value='-1'>Select<\/option>";ListQuarters.forEach(function(t){n+=t.key==r?"<option value='"+t.key+"' selected>"+t.value+"<\/option>":"<option value='"+t.key+"'>"+t.value+"<\/option>"});$("#QuarterList").html(n)}function getMonthList(){$("#MonthList").html();var t="",n=$("#QuarterList").val();n=n-1;$.each(ListMonths[n],function(n,i){t+="<option value='"+n+"'>"+i+"<\/option>"});$("#MonthList").html(t)}function getYear(){var n=2020,r=new Date,i=r.getFullYear(),t;for($("#YearList").html(),t="",t+="<option value='0'>Select<\/option>";n<=i;)t+=i==n?"<option value='"+n+"' selected>"+n+"<\/option>":"<option value='"+n+"'>"+n+"<\/option>",n=n+1;$("#YearList").html(t)}function getAgencies(){if($("#FacilityId").val()!=""&&$("#FacilityId").val()!=null){var n=$("#FacilityId").val();$.ajax({url:"/Agency/GetAgenciesByFacility",type:"POST",data:{FacilityId:n},success:function(n){var t="<option value=''>Select Agency<\/option>";n.forEach(function(n,i){t+="<option value='"+i.id+"'>"+n.agencyName+"<\/option>"});$("#AgenciesId").html("");$("#AgenciesId").html(t)},error:function(n){alert("error "+JSON.stringify(n))}})}}function fileUpload(n){var i,t;if($("#FacilityId").val()==""||$("#FacilityId").val()==undefined)return clearFileInputField(),WarningMsg("Warning!","Please select Facility","Okay"),$("#fileUpload").val(""),!1;if($("#YearList").val()=="0")return clearFileInputField(),WarningMsg("Warning!","Please select Year","Okay"),$("#fileUpload").val(""),!1;if($("#QuarterList").val()=="-1")return clearFileInputField(),WarningMsg("Warning!","Please select Quarter","Okay"),$("#fileUpload").val(""),!1;if($("#UploadType").val()=="0")return clearFileInputField(),WarningMsg("Warning!","Please select Upload Type","Okay"),$("#fileUpload").val(null),!1;i=n.target.files;i.length>0&&(t=new FormData,t.append("FacilityId",$("#FacilityId").val()),t.append("year",$("#YearList").val()),t.append("Quarter",$("#QuarterList").val()),t.append("Month",$("#MonthList").val()),t.append("UploadType",$("#UploadType").val()),t.append("AgencyId",$("#AgenciesId").val()),t.append("file",i[0]),showLoader(),$.ajax({url:urls.Upload.UploadFile,type:"POST",data:t,contentType:!1,processData:!1,success:function(n){hideLoader();$("#filterDiv").css("pointer-events","none");$("#MapData").html("");$("#MapData").html(n)},error:function(n){hideLoader();ErrorMsg("Failed",n.responseJSON.message);clearFileInputField()}}))}function clearFileInputField(){let n=$(".input-file__delete"),t=n.parents(".input-file").find(".input-file__input"),i=t[0].placeholder||"Drop files here";t.val(null);n.css("display","none").prev(".input-file__msg").text(i)}function mapFunction(){var n=[],t,i;$("#MapTable tbody tr").each(function(){var t=$(this).find(".selectddl").val(),i=$(this).find(".excelcol").text(),r=$(this).find(".selectddl option:selected").text(),u={CmsMappingID:t,ColumnName:i,CmsFieldName:r};n.push(u)});t={FacilityId:parseInt($("#FacilityId").val()),year:parseInt($("#YearList").val()),Quarter:parseInt($("#QuarterList").val()),Month:parseInt($("#MonthList").val()),UploadType:$("#UploadType").val(),AgencyId:$("#AgenciesId").val()};i={MappingDatas:n,RememberMe:$("#RememberMe").val(),RequestModel:t};showLoader();$.ajax({url:urls.Upload.MappingData,type:"POST",data:i,dataType:"json",success:function(n){hideLoader();n.statusCode==MappingDataStatus.SUCCESS_CODE?(SuccessMsg("Success","The file has been successfully uploaded.","success"),clearFileInputField(),$("#filterDiv").css("pointer-events",""),$("#MapData").html("")):n.statusCode==MappingDataStatus.INCOMPATIBLE_QUARTER_CODE?($("#MapData").html(""),$("#filterDiv").css("pointer-events",""),ConfirmMsg("Continue uploading prior quarter record(s)",n.message,"Confirm",event,function(){$("#filterDiv").css("pointer-events","none");$("#MapData").html("");$("#DifferentQurterDataDiv").removeClass("hide");populateTable(n.diffQuarterTimesheet)})):n.statusCode==MappingDataStatus.INVALID_RECORD_CODE?ConfirmMsg("Invalid Record(s)",n.message,"Confirm",event,function(){window.location.href=n.url}):WarningMsg("Warning",n.message)},error:function(){hideLoader();ErrorMsg("Error","Failed to upload","")}})}function rememberMyMapping(){$("#RememberMe").is(":checked")?$("#RememberMe").val(1):$("#RememberMe").val(0)}function processOneDrive(){let n={clientId:"3c39b444-9cde-4ddc-9878-a9c8b69197d2",action:"download",multiSelect:!1,openInNewWindow:!0,success:function(n){$.each(n.value,function(n,t){oneDriveUpload(t["@microsoft.graph.downloadUrl"],t.name)})},cancel:function(){ErrorMsg("warning","You cancelled your upload.","warning");let n=document.getElementById("onedrive");n.checked=!1},error:function(){ErrorMsg("Error","Something went wrong.","error")}};OneDrive.open(n)}function oneDriveUpload(n,t){if($("#FacilityId").val()==""||$("#FacilityId").val()==undefined)return WarningMsg("Warning!","Please select Facility","Okay"),$("#fileUpload").val(""),!1;if($("#YearList").val()=="0")return WarningMsg("Warning!","Please select Year","Okay"),$("#fileUpload").val(""),!1;if($("#QuarterList").val()=="-1")return WarningMsg("Warning!","Please select Quarter","Okay"),$("#fileUpload").val(""),!1;if($("#UploadType").val()=="0")return WarningMsg("Warning!","Please select Upload Type","Okay"),$("#fileUpload").val(""),!1;let i=new FormData;i.append("FacilityId",$("#FacilityId").val());i.append("year",$("#YearList").val());i.append("Quarter",$("#QuarterList").val());i.append("Month",$("#MonthList").val());i.append("UploadType",$("#UploadType").val());i.append("AgencyId",$("#AgenciesId").val());i.append("fileURL",n);i.append("fileName",t);i.append("IsOneDrive",!0);showLoader();$.ajax({url:urls.Upload.UploadFile,type:"POST",data:i,contentType:!1,processData:!1,success:function(n){hideLoader();$("#filterDiv").css("pointer-events","none");$("#MapData").html("");$("#MapData").html(n)},error:function(n){hideLoader();ErrorMsg("Failed",n.responseJSON.message)}})}function populateTable(n){$("#DifferentQurterDataTable").dataTable().fnDestroy();$("#DifferentQurterDataTable").DataTable({pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}},paging:!0,pageLength:10,columns:[{data:"employeeId",title:"Employee ID"},{data:"firstName",title:"First Name"},{data:"lastName",title:"Last Name"},{data:"workday",title:"Workday"},{data:"tHours",title:"Total Hours"}],data:n})}function uploadDifferentQuarterData(){showLoader();$.ajax({url:urls.Upload.InsertDifferntQuarterData,type:"GET",success:function(n){hideLoader();n.statusCode==MappingDataStatus.SUCCESS_CODE?(clearFileInputField(),SuccessMsg("Success",n.message,"success"),$("#filterDiv").css("pointer-events",""),$("#DifferentQurterDataTable tbody").html(""),$("#DifferentQurterDataDiv").addClass("hide")):n.statusCode==MappingDataStatus.INVALID_RECORD_CODE?ConfirmMsg("Invalid Record(s)",n.message,"Confirm",event,function(){$("#DifferentQurterDataTable tbody").html("");$("#DifferentQurterDataDiv").addClass("hide");window.location.href=n.url}):WarningMsg("Warning",n.message)},error:function(){hideLoader();ErrorMsg("Error","Failed to upload","")}})}function GetFacility(){let n={OrgId:$("#organizationName").val()};$("#organizationName").val()!=""&&$.ajax({type:"Post",data:n,"async":!1,cache:!1,url:urls.UserManagement.FaciltyList,success:function(n){let t=$("#facilityName");t.empty();t.append('<option value="">- Select Facility Name -<\/option>');$.each(n,function(n,i){t.append('<option value="'+i.value+'">'+i.text+"<\/option>")});t.trigger("change")},failure:function(){ErrorMsg("Error","Something went wrong!Try again Later","");$("#preloader").addClass("d-none")},error:function(){ErrorMsg("Error","Something went wrong!Try again Later","");$("#preloader").addClass("d-none")}})}function ClearSpan(){$(".validation").empty()}function getRole(){let n={OrgId:$("#drpAppList").val()};$.ajax({type:"Post",data:n,"async":!1,url:urls.UserManagement.GetroleList,success:function(n){let t=$("#drproleList");t.empty();t.append('<option value=""> Select Role <\/option>');$.each(n,function(n,i){t.append('<option value="'+i.value+'">'+i.text+"<\/option>")});t.trigger("change");$("#permissionTable").empty();$("#permissionTable").dataTable().fnDestroy();$("#permissionTable").DataTable({pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'},emptyTable:"No data available, kindly ensure the module is selected"},pageLength:50,columnDefs:[{orderable:!1,targets:[2]}]});$("#drpModuleList").empty()},failure:function(){ErrorMsg("Error","Something went wrong!Try again Later","");$("#preloader").addClass("d-none")},error:function(){ErrorMsg("Error","Something went wrong!Try again Later","");$("#preloader").addClass("d-none")}})}function FixType(){let n=$("#userType").val();n==1?($("#TypeFilter").hide(),$("#organizationName").val(""),$("#organizationName").trigger("change"),$("#facilityName").val(""),$("#facilityName").trigger("change"),$("#facilityName").find("option").remove().end().trigger("change"),$("#defApp").find("option").remove().end().trigger("change"),$("#ThinkAnewTypeFilter").show()):($("#TypeFilter").show(),$("#ThinkAnewTypeFilter").hide(),$("#roleName").val(""),$("#roleName").trigger("change"),$("#appName").val(""),$("#appName").trigger("change"),$("#defApp").find("option").remove().end().trigger("change"));setTimeout(function(){GetApps()},0)}function GetFacilityApplication(){let n=$("#facilityName").val();n.length>0&&n[0]!=""&&$.ajax({url:urls.UserManagement.FaciltyAppList,type:"GET",dataType:"json",cache:!1,traditional:!0,data:{apps:n},contentType:"application/json",success:function(n){let t=$("#defApp");t.empty();t.append('<option value="">- Select Application Name -<\/option>');$.each(n,function(n,i){t.append('<option value="'+i.value+'">'+i.text+"<\/option>")});t.trigger("change")},error:function(){}})}function GetEditFacilityApplication(){let n=$("#facility").val();n.length>0&&n[0]!=""&&$.ajax({url:urls.UserManagement.FaciltyAppList,type:"GET",dataType:"json",cache:!1,traditional:!0,data:{apps:n},contentType:"application/json",success:function(n){let t=$("#defApp");t.empty();t.append('<option value="">- Select Application Name -<\/option>');$.each(n,function(n,i){t.append('<option value="'+i.value+'">'+i.text+"<\/option>")});t.trigger("change")},error:function(){}})}function searchUser(){$("#preloader").removeClass("d-none");let n="";$("#RoleName :selected").val()!=""&&(n=$("#RoleName :selected").text());let t={userName:$("#UserName").val(),role:n,fOrgId:$("#OrgName").val(),fFacilityId:$("#FacilityNameFilter").val()};$.ajax({type:"Post",data:t,"async":!1,url:urls.UserManagement.SearchUserData,success:function(n){$("#PBJEmployeeList").html($(n).find("#PBJEmployeeList").html());$("#PBJEmployeeList").dataTable().fnDestroy();$("#PBJEmployeeList").dataTable({order:[],columnDefs:[{orderable:!1,targets:4}]});$("#preloader").addClass("d-none")},failure:function(){ErrorMsg("Error","Something went wrong!Try again Later","");$("#preloader").addClass("d-none")},error:function(){ErrorMsg("Error","Something went wrong!Try again Later","");$("#preloader").addClass("d-none")}})}function resetUserFilter(){$("#UserName").val("");$("#RoleName").val(null).trigger("change");$("#OrgName").val(null).trigger("change");$("#FacilityNameFilter").val(null).trigger("change");searchUser()}function editUser(){let n=document.getElementById("EditUser"),t=new FormData(n);$.ajax({type:"Post",data:t,"async":!1,url:urls.UserManagement.UpdateUser,success:function(){}})}function updateActiveStatus(n,t){let i="";i=t=="0"?"Deactivate":"Activate";let r="Are you sure want to "+i+" this Employee?";ConfirmMsg("User Management",r,"Continue",event,function(){let i={userId:n,status:t};$.ajax({type:"Post",data:i,"async":!1,url:urls.UserManagement.UpdateActiveStatus,success:function(n){n=="success"?(SuccessMsg("Success","Active status has been changed",""),window.location.reload()):ErrorMsg("Error","Unable to change status!Try again later","")},failure:function(){ErrorMsg("Error","Something went wrong!Try again Later","")},error:function(){ErrorMsg("Error","Something went wrong!Try again Later","")}})})}function searchUserFromAd(){if($("#preloader").removeClass("d-none"),$("#AdMsg").val(""),$("#txtUser").val()=="")return $("#txtUser").focus(),!1;let n={userName:$("#txtUser").val()};$.ajax({type:"Post",data:n,"async":!1,url:urls.UserManagement.SearchADUserData,success:function(n){n!=null&&n.isAdAuthenticated==!0?($("#txtName").val(n.name),$("#txtEmail").val(n.email),$("#hdIsAdEnabled").val("true")):$("#AdMsg").text("This UserName is not authenticated from AD. ");$("#preloader").addClass("d-none")},failure:function(){$("#preloader").addClass("d-none");$("#AdMsg").text("This UserName is not authenticated from AD. ")},error:function(){$("#preloader").addClass("d-none");$("#AdMsg").text("This UserName is not authenticated from AD. ")}})}function isValidEmail(n){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)}function addUser(){const f={Thinkanew:1,Other:2};let s=$("#currentType").val(),e=$("#currentOrg").val(),n=$("#txtfName").val(),t=$("#txtlName").val(),i=$("#txtEmail").val(),r=$("#userType").val(),h=$("#organizationName").val(),o=$("#facilityName").val(),u=$("#defApp").val(),c=$("#roleName").val();s==f.Thinkanew?r!=f.Thinkanew?validateOtherUser(n,t,i,r,h,o,u)&&addUserInfo():validateTANUser(n,t,i,r,c,u)&&addUserInfo():validateOtherUser(n,t,i,"2",e,o,u)&&($("#userType").val("2"),addUserInfo(),$("#userType").trigger("change"),$("#organizationName").val(e),$("#organizationName").trigger("change"))}function CheckEdit(n){let t=$("#edtxtfName").val();if($("#edtxtfName").val()=="")$("#spedtxtfName").text("Enter First Name!"),n.preventDefault();else{if(/\d/.test(t))return $("#spedtxtfName").text("First Name should not contain numbers"),!1;/[^A-Za-z\s\-']/.test(t)&&($("#spedtxtlName").text("First Name should not contain symbols other than hyphen (-)"),n.preventDefault())}let i=$("#edtxtlName").val();$("#edtxtlName").val()==""?($("#spedtxtlName").text("Enter Last Name!"),n.preventDefault()):/\d/.test(i)?($("#spedtxtlName").text("First Name should not contain numbers"),n.preventDefault()):/[^A-Za-z\s\-']/.test(i)&&($("#spedtxtlName").text("Last Name should not contain symbols other than hyphen (-)"),n.preventDefault());let u=$("#txtEmail").val();$("#txtEmail").val()==""?($("#spemailtxt").text("Enter Email!"),n.preventDefault()):isValidEmail(u)||($("#spemailtxt").text("Invalid email format"),n.preventDefault());let r=$("#facility").val(),f=$("#userType").val();f!={Thinkanew:1,Other:2}.Thinkanew&&(r.length==0?($("#spapplication").text("Select Facility"),n.preventDefault()):r[0]==""&&($("#spapplication").text("Select Facility"),n.preventDefault()));let e=$("#defApp").val();e==""&&($("#spdefaultApplication").text("Select Default Application!"),n.preventDefault())}function refreshUserModel(){$("#AddADUserInform")[0].reset();$("#organizationName").val("").trigger("change");$(".validation").empty();$("#userType").val("");$("#userType").trigger("change");$("#organizationName").val("");$("#organizationName").trigger("change");$("#facilityName").val("");$("#facilityName").trigger("change");$("#facilityName").find("option").remove().end().trigger("change");$("#defApp").find("option").remove().end().trigger("change");$(".validation").empty()}function GetApps(){$.ajax({type:"Post","async":!1,cache:!1,url:urls.UserManagement.GetAppList,success:function(n){let t=$("#defApp");t.empty();t.append('<option value="">- Select Application Name -<\/option>');$.each(n,function(n,i){t.append('<option value="'+i.value+'">'+i.text+"<\/option>")});t.trigger("change")}})}function loadAddUserModalPopUp(){$("#btnAddUser").trigger("click");let n=sessionStorage.getItem("organizationId").trim(),t=sessionStorage.getItem("facilityId").trim();$("#organizationName").val(n).trigger("change");$("#facilityName").val(t).trigger("change");$("#userType").val("2");setTimeout(function(){$("#userType").trigger("change");$("#facilityName").trigger("change")},100)}function restrictInput(n){let t=n.key;/^[A-Za-z\s\-']+$/.test(t)||t==="Backspace"||n.preventDefault()}function checkForUniqueEmail(){let n=$("#txtEmail").val(),t=$("#userId").val();$.ajax({url:urls.UserManagement.CheckForUniqueEmail,type:"GET",data:{emailId:n,userId:t},"async":!1,success:function(n){n?$("#sptxtEmail").text("Email Id already exists, please use another Email Id"):$("#sptxtEmail").text("")},error:function(n,t,i){console.log("Error: "+i)}});let i=isValidEmail(n);i||$("#sptxtEmail").text("please enter valid Email Id")}function addUserInfo(){let n=document.getElementById("AddADUserInform"),t=new FormData(n);$.ajax({type:"Post",data:t,cache:!1,contentType:!1,processData:!1,url:urls.UserManagement.AddTANUserData,success:function(n){n=="success"?window.location.href=urls.UserManagement.SearchUserData:n=="exist"?($("#addmemberModal").modal("hide"),WarningMsg("Warning","This User has been already added","")):($("#addmemberModal").modal("hide"),refreshUserModel(),ErrorMsg("Error","Unable to add user!Try again Later",""))},failure:function(){ErrorMsg("Error","Something went wrong!Try again Later","")},error:function(n,t){t==HTTP_STATUS_FORBIDDEN||n.status==HTTP_STATUS_FORBIDDEN?ErrorMsg("Failed","Unauthorized Access"):n.status==HTTP_STATUS_TOOMANYREQUESTS||t==HTTP_STATUS_TOOMANYREQUESTS?(ErrorMsg("Failed","Too Many Requests, Please try after some time"),$("#addmemberModal").modal("hide"),refreshUserModel()):ErrorMsg("Error","Something went wrong!Try again Later","")}})}function validateTANUser(n,t,i,r,u,f){let e=!0;return n==""&&($("#sptxtfName").text("Please enter first name"),e=!1),t==""&&($("#sptxtlName").text("Please enter first name"),e=!1),i==""&&($("#sptxtEmail").text("Please enter email id"),e=!1),isValidEmail(i)||($("#sptxtEmail").text("Please enter valid email id"),e=!1),r==""&&($("#spuserType").text("Please select user type"),e=!1),u==""&&($("#sproleName").text("Please select role"),e=!1),f==""&&($("#spdefapplication").text("Please select default application name"),e=!1),e}function validateOtherUser(n,t,i,r,u,f,e){let o=!0;return n==""&&($("#sptxtfName").text("Please enter first name"),o=!1),t==""&&($("#sptxtlName").text("Please enter last name"),o=!1),i==""&&($("#sptxtEmail").text("Please enter email id"),o=!1),isValidEmail(i)||($("#sptxtEmail").text("Please enter valid email id"),o=!1),r==""&&($("#spuserType").text("Please select user type"),o=!1),u==""&&($("#sporanizationName").text("Please select organization name"),o=!1),f==""&&($("#spfacilityName").text("Please select facility name"),o=!1),e==""&&($("#spdefapplication").text("Please select default application name"),o=!1),o}function ResendMail(n){let t={UserId:n};$.ajax({url:urls.UserManagement.ResendUrl,type:"POST",data:t,"async":!1,success:function(n){n!=""?SuccessMsg("Success",n,""):ErrorMsg("Failed","Something Went wrong","")},error:function(n,t,i){console.log("Error: "+i)}})}function GetOrgFacilities(){let n={OrgId:$("#OrgName").val()};$("#OrgName").val()!=""&&$.ajax({type:"Post",data:n,"async":!1,cache:!1,url:urls.UserManagement.FaciltyList,success:function(n){let t=$("#FacilityNameFilter");t.empty();t.append('<option value="">- Select Facility Name -<\/option>');$.each(n,function(n,i){t.append('<option value="'+i.value+'">'+i.text+"<\/option>")});t.trigger("change")},failure:function(){ErrorMsg("Error","Something went wrong!Try again Later","");$("#preloader").addClass("d-none")},error:function(){ErrorMsg("Error","Something went wrong!Try again Later","");$("#preloader").addClass("d-none")}})}function searchUserRoles(){let n={userId:$("#Uid").val(),appId:$("#usAppName").val(),roleId:$("#usRoleName").val(),userType:$("#userTypes").val()};$.ajax({type:"Post",data:n,"async":!1,url:urls.UsrRoles.SearchUserData,success:function(n){$("#userRolesTable").html($(n).find("#userRolesTable").html());$("#userRolesTable").dataTable().fnDestroy();$("#userRolesTable").DataTable()}})}function GetusRoles(){let n={OrgId:$("#usAppName").val()};$("#usAppName").val()!=""&&$.ajax({type:"Post",data:n,"async":!1,url:urls.UserManagement.GetroleList,success:function(n){let t=$("#usRoleName");t.empty();t.append('<option value=""> Select Role <\/option>');$.each(n,function(n,i){t.append('<option value="'+i.value+'">'+i.text+"<\/option>")});t.trigger("change")}})}function getuserRoles(){let n=$("#userTypes").val();n==1?($("#appFilter").hide(),$.ajax({type:"Post","async":!1,url:urls.UsrRoles.GetTANRoleList,success:function(n){let t=$("#usRoleName");t.empty();t.append('<option value=""> Select Role <\/option>');$.each(n,function(n,i){t.append('<option value="'+i.value+'">'+i.text+"<\/option>")});t.trigger("change")}})):($("#appFilter").show(),$("#usRoleName").val(null).trigger("change"))}function resetUserRoleFilter(){$("#usAppName").val("");$("#usRoleName").val("");$("#userTypes").val("");$("#usAppName").trigger("change");$("#usRoleName").trigger("change");$("#userTypes").trigger("change");let n={userId:$("#Uid").val(),appId:$("#usAppName").val(),roleId:$("#usRoleName").val()};$.ajax({type:"Post",data:n,"async":!1,url:urls.UsrRoles.SearchUserData,success:function(n){$("#usRoleName").html($(n).find("#usRoleName").html());$("#usRoleName").trigger("change");$("#userRolesTable").html($(n).find("#userRolesTable").html());$("#userRolesTable").dataTable().fnDestroy();$("#userRolesTable").DataTable()}})}var events,selectedEvent,DeleteSelectedDates,AddNurseSelectedDates,ListQuarters,ListMonths;$("document").ready(function(){getYear();getQuaterList();loadBackoutData();$("#ErrorListModalId").modal({backdrop:"static",keyboard:!1})});let ListQuarters=[{key:"1",value:"1st Quarter (October 1 - December 31)"},{key:"2",value:"2nd Quarter (January 1 - March 31)"},{key:"3",value:"3rd Quarter (April 1 - June 30)"},{key:"4",value:"4th Quarter (July 1 - September 30)"}];$("document").ready(function(){getPayTypeList();getJobTitleList();loadEmployeeList();initSelect2EmployeeMaster();$("#AddEmployeeModel").modal({backdrop:"static",keyboard:!1});$("#FacilityNameId").on("select2:select",function(){let t=$(this).data("error-id"),n=$("#"+this.id).nextAll("span.text-danger:first");n.text("")})});$(document).ready(function(){(function(n){var t=function(t){n(t).addClass("input-file__input");var t=n(t).wrap(`<div class="input-file"><div class="input-file__drop-area"><span class='input-file__choose-file ${t.attributes.data_btn_text?""===t.attributes.data_btn_text.textContent?"":"input-file_btn-text":""}'>${t.attributes.data_btn_text?""===t.attributes.data_btn_text.textContent?`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor"><path d="M67.508 468.467c-58.005-58.013-58.016-151.92 0-209.943l225.011-225.04c44.643-44.645 117.279-44.645 161.92 0 44.743 44.749 44.753 117.186 0 161.944l-189.465 189.49c-31.41 31.413-82.518 31.412-113.926.001-31.479-31.482-31.49-82.453 0-113.944L311.51 110.491c4.687-4.687 12.286-4.687 16.972 0l16.967 16.971c4.685 4.686 4.685 12.283 0 16.969L184.983 304.917c-12.724 12.724-12.73 33.328 0 46.058 12.696 12.697 33.356 12.699 46.054-.001l189.465-189.489c25.987-25.989 25.994-68.06.001-94.056-25.931-25.934-68.119-25.932-94.049 0l-225.01 225.039c-39.249 39.252-39.258 102.795-.001 142.057 39.285 39.29 102.885 39.287 142.162-.028A739446.174 739446.174 0 0 1 439.497 238.49c4.686-4.687 12.282-4.684 16.969.004l16.967 16.971c4.685 4.686 4.689 12.279.004 16.965a755654.128 755654.128 0 0 0-195.881 195.996c-58.034 58.092-152.004 58.093-210.048.041z" /></svg>`:`${t.attributes.data_btn_text.textContent}`:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor"><path d="M67.508 468.467c-58.005-58.013-58.016-151.92 0-209.943l225.011-225.04c44.643-44.645 117.279-44.645 161.92 0 44.743 44.749 44.753 117.186 0 161.944l-189.465 189.49c-31.41 31.413-82.518 31.412-113.926.001-31.479-31.482-31.49-82.453 0-113.944L311.51 110.491c4.687-4.687 12.286-4.687 16.972 0l16.967 16.971c4.685 4.686 4.685 12.283 0 16.969L184.983 304.917c-12.724 12.724-12.73 33.328 0 46.058 12.696 12.697 33.356 12.699 46.054-.001l189.465-189.489c25.987-25.989 25.994-68.06.001-94.056-25.931-25.934-68.119-25.932-94.049 0l-225.01 225.039c-39.249 39.252-39.258 102.795-.001 142.057 39.285 39.29 102.885 39.287 142.162-.028A739446.174 739446.174 0 0 1 439.497 238.49c4.686-4.687 12.282-4.684 16.969.004l16.967 16.971c4.685 4.686 4.689 12.279.004 16.965a755654.128 755654.128 0 0 0-195.881 195.996c-58.034 58.092-152.004 58.093-210.048.041z" /></svg>`}</span>${t.outerHTML}</span><span class="input-file__msg">${""===t.placeholder?"Drop files here":`${t.placeholder}`}</span><div class="input-file__delete"></div></div></div>`),t=t.parents(".input-file");t.on("dragenter focus click",".input-file__input",function(){n(this).parents(".input-file__drop-area").addClass("is-active")});t.on("dragleave blur drop",".input-file__input",function(){n(this).parents(".input-file__drop-area").removeClass("is-active")});t.on("change",".input-file__input",function(t){let i=n(this)[0].files.length,r=n(this).next(".input-file__msg");if(1===i){let t=n(this).val().split("\\").pop();r.text(t).next(".input-file__delete").css("display","block")}else i>1?r.text(i+" files selected").next(".input-file__delete").css("display","inline-block"):(r.text(`${""===this[0].placeholder?"or drop files here":`${this[0].placeholder}`}`),n(this).parents(".input-file").find(".input-file__delete").css("display","none"));fileUpload(t)});t.on("click",".input-file__delete",function(){let t=n(this);t.parents(".input-file").find(`.input-file__input`).val(null);t.css("display","none").prev(`.input-file__msg`).text(`${""===n(this).parents(".input-file").find(".input-file__input")[0].placeholder?"Drop files here":`${n(this).parents(".input-file").find(".input-file__input")[0].placeholder}`}`)})};n.fn.kwtFileUpload=function(){var i=n(this);return n.each(i,function(n,i){t(i)}),this}})(jQuery);jQuery(document).ready(function(n){n(".fileUpload").kwtFileUpload()})});const HTTP_STATUS_FORBIDDEN=403,HTTP_STATUS_TOOMANYREQUESTS=429;$(".AllowNumbers").keyup(function(){this.value=this.value.replace(/[^0-9]/g,"")});$(".AllowCharacters").keyup(function(){this.value=this.value.replace(/[^A-z]/g,"")});$(".allowCharactersAndNumbers").keyup(function(n){let t=n.key;/^[a-zA-Z0-9]+$/.test(t)||t==="Backspace"||n.preventDefault()});$(".maxInputNumberLength").keyup(function(){this.value=this.value.replace(/[^0-9]/g,"");this.value.length>10&&(this.value=this.value.substr(0,10),$(this).val(this.value))});$(function(){$('[data-bs-toggle="tooltip"]').tooltip()});var ListQuarters=[{key:"1",value:"1st Quarter (October 1 - December 31)"},{key:"2",value:"2nd Quarter (January 1 - March 31)"},{key:"3",value:"3rd Quarter (April 1 - June 30)"},{key:"4",value:"4th Quarter (July 1 - September 30)"}],ListMonths=[{0:"Select All",10:"October",11:"November",12:"December"},{0:"Select All",1:"January",2:"February",3:"March"},{0:"Select All",4:"April",5:"May",6:"June"},{0:"Select All",7:"July",8:"August",9:"September"}],GetPayCodeList=[],GetJobTitleList=[],AddSelectedDates=[],addSelectedColorDates=[];$("document").ready(function(){getYear();getQuaterList();getMonthList();getAgencies();loadEmployeeListData();loadStaffDeptData();loadCencusData();getPayTypeList();getJobTitleList();initSelect2Review();checkIfValidated();checkIfApproved();getAllFileNameByFacility();$("#AddNurseWorkingHours").modal({backdrop:"static",keyboard:!1});$("#ReviewModal").modal({backdrop:"static",keyboard:!1});$("#AddEmployeeModel").modal({backdrop:"static",keyboard:!1});$("#EmployeeDataWorkingHoursCalenderModal").modal({backdrop:"static",keyboard:!1});$("#EmpAddUpdateWorkingHours").modal({backdrop:"static",keyboard:!1});$("#CencusModal").modal({backdrop:"static",keyboard:!1})});$(".edit-cencus").click(function(){getCencusMonth();clearCencusData();$("#RMedicare").val($(this).closest("tr").find("td").eq(3).text().trim());$("#RMedicad").val($(this).closest("tr").find("td").eq(4).text().trim());$("#ROther").val($(this).closest("tr").find("td").eq(5).text().trim());$("#RMedicare").val($(this).closest("tr").find("td").eq(3).text().trim());$("#CencusMonthList").val($(this).closest("tr").find("td").eq(7).text().trim());$("#CensusId").val($(this).closest("tr").find("td").eq(6).text().trim());$("#SaveCencus").css("display","none");$("#btnUpdateCencus").css("display","block");$("#CencusModal").modal("show");draggableModel("#CencusModal")});events=[];selectedEvent=null;$(function(){$("#EmpDateRange").daterangepicker()});$(function(){$("#EmpDateRange").daterangepicker({opens:"left"},function(){})});$(function(){$("#EmpDateRangeCalender").daterangepicker()});$(function(){$("#EmpDateRangeCalender").daterangepicker({opens:"left",maxDate:new Date},function(n,t){var r;AddSelectedDates=[];let u=new Date;for(var f=new Date(n.format("YYYY-MM-DD")),e=new Date(t.format("YYYY-MM-DD")),i=new Date(f);i<=e;)r=i.toISOString().slice(0,10),i<u&&AddSelectedDates.push(r),i.setDate(i.getDate()+1)})});DeleteSelectedDates=[];$(function(){$("#EmpDeleteDateRangeCalender").daterangepicker()});$(function(){$("#EmpDeleteDateRangeCalender").daterangepicker({opens:"left",maxDate:new Date},function(n,t){var r;DeleteSelectedDates=[];for(var u=new Date(n.format("YYYY-MM-DD")),f=new Date(t.format("YYYY-MM-DD")),i=new Date(u);i<=f;)r=i.toISOString().slice(0,10),DeleteSelectedDates.push(r),i.setDate(i.getDate()+1)})});var calenderEvents=[],calenderSelectedEvent=null,TempJobTitle="";AddNurseSelectedDates=[];$(function(){$("#NurseDateRange").daterangepicker()});$(function(){$("#NurseDateRange").daterangepicker({opens:"left",maxDate:new Date},function(n,t){var r;AddNurseSelectedDates=[];let u=new Date;for(var f=new Date(n.format("YYYY-MM-DD")),e=new Date(t.format("YYYY-MM-DD")),i=new Date(f);i<=e;)r=i.toISOString().slice(0,10),i<=u&&AddNurseSelectedDates.push(r),i.setDate(i.getDate()+1)})});const SessionTimeout={init:function(n){const t=window.sessionTimeoutConfig||{},i={title:"Session Timeout Notification",message:"Your session is expiring soon.",redirUrl:"/lockscreen",logoutUrl:"/Home/Logout",warnAfter:t.warnAfter,redirAfter:t.redirAfter,ignoreUserActivity:t.ignoreUserActivity,countdownMessage:"Redirecting in {timer} seconds.",countdownBar:!0,keepAliveUrl:window.location.href},r=$.extend(i,n);$.sessionTimeout(r)}};jQuery(function(){SessionTimeout.init({})});$("#fileUpload").change(function(n){$("#fileUpload").val().trim()!=""&&(fileUpload(n),$("#fileUpload").val(""))});ListQuarters=[{key:"1",value:"1st Quarter (October 1 - December 31)"},{key:"2",value:"2nd Quarter (January 1 - March 31)"},{key:"3",value:"3rd Quarter (April 1 - June 30)"},{key:"4",value:"4th Quarter (July 1 - September 30)"}];ListMonths=[{0:"Select All",10:"October",11:"November",12:"December"},{0:"Select All",1:"January",2:"February",3:"March"},{0:"Select All",4:"April",5:"May",6:"June"},{0:"Select All",7:"July",8:"August",9:"September"}];$("document").ready(function(){getYear();getQuaterList();getMonthList()});var ListQuarters=[{key:"1",value:"1st Quarter (October 1 - December 31)"},{key:"2",value:"2nd Quarter (January 1 - March 31)"},{key:"3",value:"3rd Quarter (April 1 - June 30)"},{key:"4",value:"4th Quarter (July 1 - September 30)"}],ListMonths=[{0:"Select All",10:"October",11:"November",12:"December"},{0:"Select All",1:"January",2:"February",3:"March"},{0:"Select All",4:"April",5:"May",6:"June"},{0:"Select All",7:"July",8:"August",9:"September"}],MappingDataStatus={SUCCESS_CODE:200,MULTIPLE_CMS_CODE:201,FILE_UPLOAD_FAILED_CODE:202,SERVER_FAILED_CODE:400,MAP_PROPERLY_FAILED_CODE:203,CMS_VALIDATION_FAILED_CODE:204,INCOMPATIBLE_QUARTER_CODE:205,INVALID_RECORD_CODE:206};$("document").ready(function(){getYear();getQuaterList();getMonthList();getAgencies();let n=document.getElementById("onedrive");n.addEventListener("click",function(){n.checked&&processOneDrive()});$("#DifferentQurterDataTable").dataTable().fnDestroy();$("#DifferentQurterDataTable").DataTable({pagingType:"full_numbers",language:{paginate:{first:'<i class="fa fa-angle-double-left"><\/i>',previous:'<i class="fa fa-angle-left"><\/i>',next:'<i class="fa fa-angle-right"><\/i>',last:'<i class="fa fa-angle-double-right"><\/i>'}}})});$("#fileUpload").change(function(n){if($("#FacilityId").val()=="")return alert("Please select Facility"),$("#fileUpload").val(""),!1;if($("#YearList").val()=="0")return alert("Please select Year"),$("#fileUpload").val(""),!1;if($("#QuarterList").val()=="-1")return alert("Please select Quarter"),$("#fileUpload").val(""),!1;if($("#UploadType").val()=="0")return $("#fileUpload").val(null),alert("Please select Upload Type"),!1;$("#fileUpload").val().trim()!=""&&(fileUpload(n),$("#fileUpload").val(""))});$("#userType").on("change",function(){let n=$(this).val();n==="2"?$("#TypeFilter").show():$("#TypeFilter").hide()});